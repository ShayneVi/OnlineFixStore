<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Fix Store</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        details summary { list-style: none; }
        details summary::-webkit-details-marker { display: none; }
        details summary::after { content: '‚ñº'; float: right; transition: transform 0.2s; }
        details[open] summary::after { transform: rotate(-180deg); }

        /* Notification animation */
        @keyframes slideIn {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .animate-slideIn {
            animation: slideIn 0.3s ease-out;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #374151; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #6b7280; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        
        /* Theme System - Dynamic color palettes */

        /* Dark Theme (default) */
        body {
            --bg-primary: #111827;
            --bg-secondary: #1f2937;
            --bg-tertiary: #374151;
            --bg-card: #1f2937;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --text-tertiary: #9ca3af;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --border-color: #374151;
        }

        /* Ocean Theme */
        .theme-ocean {
            --bg-primary: #0c1821;
            --bg-secondary: #1b2a3a;
            --bg-tertiary: #2d4356;
            --bg-card: #1e3447;
            --text-primary: #e0f2fe;
            --text-secondary: #bae6fd;
            --text-tertiary: #7dd3fc;
            --accent-primary: #06b6d4;
            --accent-secondary: #0891b2;
            --border-color: #155e75;
        }

        /* Forest Theme */
        .theme-forest {
            --bg-primary: #0f1810;
            --bg-secondary: #1a2820;
            --bg-tertiary: #2d4233;
            --bg-card: #1e3126;
            --text-primary: #ecfdf5;
            --text-secondary: #d1fae5;
            --text-tertiary: #a7f3d0;
            --accent-primary: #10b981;
            --accent-secondary: #059669;
            --border-color: #065f46;
        }

        /* Sunset Theme */
        .theme-sunset {
            --bg-primary: #1c0f0a;
            --bg-secondary: #2d1b15;
            --bg-tertiary: #422b21;
            --bg-card: #321f18;
            --text-primary: #fef3c7;
            --text-secondary: #fde68a;
            --text-tertiary: #fcd34d;
            --accent-primary: #f59e0b;
            --accent-secondary: #dc2626;
            --border-color: #92400e;
        }

        /* Purple Dream Theme */
        .theme-purple {
            --bg-primary: #1a0d24;
            --bg-secondary: #2b1a3d;
            --bg-tertiary: #3f2a5a;
            --bg-card: #2d1e3f;
            --text-primary: #faf5ff;
            --text-secondary: #e9d5ff;
            --text-tertiary: #d8b4fe;
            --accent-primary: #a855f7;
            --accent-secondary: #c026d3;
            --border-color: #6b21a8;
        }

        /* Cyberpunk Theme */
        .theme-cyberpunk {
            --bg-primary: #0a0e1a;
            --bg-secondary: #141829;
            --bg-tertiary: #1e2538;
            --bg-card: #16192b;
            --text-primary: #00ff9f;
            --text-secondary: #00d9ff;
            --text-tertiary: #bd00ff;
            --accent-primary: #ff006e;
            --accent-secondary: #ffbe0b;
            --border-color: #00ff9f;
        }

        /* Retro Gaming Theme */
        .theme-retro {
            --bg-primary: #1a0d00;
            --bg-secondary: #2d1a0f;
            --bg-tertiary: #4a2e1f;
            --bg-card: #3a2218;
            --text-primary: #ffe4b5;
            --text-secondary: #ffd9a3;
            --text-tertiary: #ffb366;
            --accent-primary: #ff6b35;
            --accent-secondary: #f7931e;
            --border-color: #8b4513;
        }

        /* Midnight Blue Theme */
        .theme-midnight {
            --bg-primary: #0a0e27;
            --bg-secondary: #141937;
            --bg-tertiary: #1e2847;
            --bg-card: #161d3a;
            --text-primary: #e0e7ff;
            --text-secondary: #c7d2fe;
            --text-tertiary: #a5b4fc;
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --border-color: #4338ca;
        }

        /* Minimal Light Theme */
        .theme-light {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-tertiary: #f3f4f6;
            --bg-card: #faf9ff;
            --text-primary: #111827;
            --text-secondary: #4b5563;
            --text-tertiary: #6b7280;
            --accent-primary: #3b82f6;
            --accent-secondary: #8b5cf6;
            --border-color: #e5e7eb;
        }

        /* High Contrast Theme */
        .theme-contrast {
            --bg-primary: #000000;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2d2d2d;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #f0f0f0;
            --text-tertiary: #cccccc;
            --accent-primary: #ffff00;
            --accent-secondary: #00ffff;
            --border-color: #ffffff;
        }

        /* Nord Theme */
        .theme-nord {
            --bg-primary: #2e3440;
            --bg-secondary: #3b4252;
            --bg-tertiary: #434c5e;
            --bg-card: #3b4252;
            --text-primary: #eceff4;
            --text-secondary: #e5e9f0;
            --text-tertiary: #d8dee9;
            --accent-primary: #88c0d0;
            --accent-secondary: #81a1c1;
            --border-color: #4c566a;
        }

        /* Apply theme variables */
        body {
            background-color: var(--bg-primary) !important;
            color: var(--text-primary) !important;
        }

        /* Override Tailwind classes with theme variables */
        .bg-gray-900 { background-color: var(--bg-primary) !important; }
        .bg-gray-800 { background-color: var(--bg-secondary) !important; }
        .bg-gray-700 { background-color: var(--bg-tertiary) !important; }
        .bg-gray-50, .bg-gray-100, .bg-gray-200 { background-color: var(--bg-tertiary) !important; }

        .text-white { color: var(--text-primary) !important; }
        .text-gray-300 { color: var(--text-secondary) !important; }
        .text-gray-400, .text-gray-500, .text-gray-600, .text-gray-700, .text-gray-900 { color: var(--text-tertiary) !important; }

        .border-gray-700, .border-gray-300, .border-gray-200 { border-color: var(--border-color) !important; }

        /* Game cards with theme card background */
        .game-card {
            background-color: var(--bg-card) !important;
            border: 1px solid var(--border-color) !important;
        }

        /* Accent colors for buttons and highlights */
        .bg-blue-600, .bg-blue-500 {
            background-color: var(--accent-primary) !important;
        }

        .bg-purple-600, .bg-purple-500 {
            background-color: var(--accent-secondary) !important;
        }

        /* Hover states */
        .hover\:bg-gray-600:hover, .hover\:bg-gray-300:hover {
            background-color: var(--bg-tertiary) !important;
            opacity: 0.8;
        }

        .hover\:bg-gray-700:hover, .hover\:bg-gray-200:hover {
            background-color: var(--bg-tertiary) !important;
            opacity: 0.9;
        }

        /* Input fields */
        input[type="text"], input[type="number"], textarea, select {
            background-color: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
            border-color: var(--border-color) !important;
        }

        /* Scrollbar theming */
        .custom-scrollbar::-webkit-scrollbar-track {
            background: var(--bg-tertiary) !important;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--border-color) !important;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--accent-primary) !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const ChevronLeft = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"></polyline></svg>;
        const ChevronRight = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"></polyline></svg>;
        const Download = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const Loader = () => <svg className="animate-spin" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>;
        const Home = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>;
        const Store = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>;
        const Mail = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>;
        const X = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
        const Play = () => <svg width="48" height="48" viewBox="0 0 24 24" fill="white" stroke="white" strokeWidth="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>;
        const Heart = ({ filled }) => filled ? 
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg> : 
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>;
        const Star = ({ filled }) => filled ? 
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg> : 
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>;
        const Sun = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>;
        const Moon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>;
        const History = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
        const BarChart = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>;
        const Book = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>;
        const Bell = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>;
        const Palette = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="13.5" cy="6.5" r=".5"></circle><circle cx="17.5" cy="10.5" r=".5"></circle><circle cx="8.5" cy="7.5" r=".5"></circle><circle cx="6.5" cy="12.5" r=".5"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"></path></svg>;
        const Settings = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m9.66-10L16 12l5.66 3M2.34 9L8 12l-5.66 3m14.24-10.24L12 9.88l4.58 4.58m-9.16 0L12 9.88 7.42 14.46"></path></svg>;

        const GameFixStore = () => {
            const [games, setGames] = useState([]);
            const [currentPage, setCurrentPage] = useState(1);
            const [selectedGame, setSelectedGame] = useState(null);
            const [steamData, setSteamData] = useState(null);
            const [loading, setLoading] = useState(true);
            const [steamLoading, setSteamLoading] = useState(false);
            const [onlineFixData, setOnlineFixData] = useState(null); // Playing Through + How to Run
            const [showHowToRunModal, setShowHowToRunModal] = useState(false);
            const [searchQuery, setSearchQuery] = useState('');
            const [currentView, setCurrentView] = useState('home');
            const [homeContent, setHomeContent] = useState('');
            const [selectedTag, setSelectedTag] = useState(null);
            const [selectedTags, setSelectedTags] = useState([]); // Multi-select tags
            const [allTags, setAllTags] = useState([]);
            const [allGenres, setAllGenres] = useState([]);
            const [selectedGenre, setSelectedGenre] = useState(null);
            const [selectedGenres, setSelectedGenres] = useState([]); // Multi-select genres
            const [lightboxImage, setLightboxImage] = useState(null);
            const [videoPlaying, setVideoPlaying] = useState(false);
            const [leftSidebarOpen, setLeftSidebarOpen] = useState(true);
            const [rightSidebarOpen, setRightSidebarOpen] = useState(true);
            
            // New features
            const [favorites, setFavorites] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_favorites');
                    return saved ? JSON.parse(saved) : [];
                } catch { return []; }
            });
            const [downloadHistory, setDownloadHistory] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_downloads');
                    return saved ? JSON.parse(saved) : [];
                } catch { return []; }
            });
            const [ratings, setRatings] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_ratings');
                    return saved ? JSON.parse(saved) : {};
                } catch { return {}; }
            });

            // Game Bypasses data - dynamically fetched from GitHub releases
            const [bypassGames, setBypassGames] = useState([]);
            const [bypassGamesLoading, setBypassGamesLoading] = useState(true);
            const [selectedBypassGame, setSelectedBypassGame] = useState(null);

            // Useful Apps & Plugins
            const [selectedPlugin, setSelectedPlugin] = useState(null);
            const usefulApps = [
                {
                    id: 'onlinefix-plugin',
                    name: 'OnlineFix Plugin',
                    type: 'plugin',
                    repo: 'ShayneVi/OnlineFix-Plugin',
                    description: 'A Steam Millennium plugin that enables one-click installation of online multiplayer fixes for over 1,000 games. Automates downloading, extracting, and installing fixes directly into game directories with Windows notifications.',
                    installPath: 'C:\\Program Files (x86)\\Steam\\plugins'
                },
                {
                    id: 'ludusavi-restore',
                    name: 'LudusaviRestore Plugin',
                    type: 'plugin',
                    repo: 'ShayneVi/LudusaviRestore-Plugin',
                    description: 'Millennium plugin that adds a "RESTORE" button to Steam game pages for one-click game save restoration. Integrates Ludusavi to automatically restore backed-up saves to their proper locations with status notifications.',
                    installPath: 'C:\\Program Files (x86)\\Steam\\plugins'
                },
                {
                    id: 'steam-save-monitor',
                    name: 'Steam Save Monitor',
                    type: 'app',
                    repo: 'ShayneVi/Steam-Save-Monitor',
                    description: 'Desktop application that automatically backs up game saves using Ludusavi. Features dual monitoring through Steam API and process detection, triggering backups when gaming sessions end.',
                    installPath: null // User selects where to save
                }
            ];

            // Fetch bypass games from GitHub releases
            useEffect(() => {
                const fetchBypassGames = async () => {
                    try {
                        setBypassGamesLoading(true);

                        // Fetch with pagination support (100 items per page)
                        const response = await fetch('https://api.github.com/repos/ShayneVi/Bypasses/releases/latest?per_page=100');
                        const data = await response.json();

                        console.log('GitHub API response:', data);
                        console.log('Total assets:', data.assets?.length);

                        if (data.assets && Array.isArray(data.assets)) {
                            const games = data.assets
                                .filter(asset => asset.name.endsWith('.zip'))
                                .map((asset, index) => {
                                    // Convert filename to readable name
                                    // Example: "A.Plague.Tale.Innocence.zip" -> "A Plague Tale: Innocence"
                                    let name = asset.name.replace('.zip', '').replace(/\./g, ' ');

                                    // Handle special cases for better formatting
                                    name = name
                                        .replace(/\bII\b/g, 'II')
                                        .replace(/\bIII\b/g, 'III')
                                        .replace(/\bIV\b/g, 'IV')
                                        .replace(/\bV\b/g, 'V')
                                        .replace(/\bVI\b/g, 'VI')
                                        .replace(/Assassin s Creed/g, "Assassin's Creed")
                                        .replace(/Tom Clancy s/g, "Tom Clancy's")
                                        .replace(/Watch Dogs/g, "Watch Dogs")
                                        .replace(/Far Cry/g, "Far Cry")
                                        .replace(/Rainbow Six/g, "Rainbow Six")
                                        .replace(/Ghost Recon/g, "Ghost Recon")
                                        .replace(/The Division/g, "The Division")
                                        .replace(/The Crew/g, "The Crew")
                                        .replace(/Star Wars/g, "Star Wars")
                                        .replace(/Plague Tale/g, "Plague Tale")
                                        .replace(/Bypass$/gi, '')
                                        .replace(/\s+/g, ' ')
                                        .trim();

                                    return {
                                        // Use filename as unique ID to avoid collisions
                                        id: asset.name.replace('.zip', ''),
                                        name: name,
                                        filename: asset.name,
                                        size: asset.size,
                                        downloadCount: asset.download_count || 0
                                    };
                                })
                                .sort((a, b) => a.name.localeCompare(b.name));

                            setBypassGames(games);
                            console.log(`‚úÖ Loaded ${games.length} bypass games from GitHub`);
                            console.log('First 3 games:', games.slice(0, 3).map(g => g.name));
                        }
                    } catch (error) {
                        console.error('‚ùå Error fetching bypass games from GitHub:', error);
                        // Fallback to empty array
                        setBypassGames([]);
                    } finally {
                        setBypassGamesLoading(false);
                    }
                };

                fetchBypassGames();
            }, []);

            // Theme system
            const themes = {
                dark: { name: 'Dark', icon: 'üåô', class: '' },
                ocean: { name: 'Ocean', icon: 'üåä', class: 'theme-ocean' },
                forest: { name: 'Forest', icon: 'üå≤', class: 'theme-forest' },
                sunset: { name: 'Sunset', icon: 'üåÖ', class: 'theme-sunset' },
                purple: { name: 'Purple Dream', icon: 'üíú', class: 'theme-purple' },
                cyberpunk: { name: 'Cyberpunk', icon: 'ü§ñ', class: 'theme-cyberpunk' },
                retro: { name: 'Retro Gaming', icon: 'üïπÔ∏è', class: 'theme-retro' },
                midnight: { name: 'Midnight Blue', icon: '‚ú®', class: 'theme-midnight' },
                light: { name: 'Light', icon: '‚òÄÔ∏è', class: 'theme-light' },
                contrast: { name: 'High Contrast', icon: '‚ö°', class: 'theme-contrast' },
                nord: { name: 'Nord', icon: '‚ùÑÔ∏è', class: 'theme-nord' }
            };

            const [currentTheme, setCurrentTheme] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_theme');
                    return saved || 'dark';
                } catch { return 'dark'; }
            });

            const [showThemeSelector, setShowThemeSelector] = useState(false);

            // Wallpaper Background Toggle
            const [showWallpaper, setShowWallpaper] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_showWallpaper');
                    return saved ? JSON.parse(saved) : true;
                } catch { return true; }
            });

            useEffect(() => {
                localStorage.setItem('onlineFixStore_showWallpaper', JSON.stringify(showWallpaper));
            }, [showWallpaper]);

            // Background Music Toggle
            const [backgroundMusicEnabled, setBackgroundMusicEnabled] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_backgroundMusic');
                    return saved ? JSON.parse(saved) : false; // Default OFF
                } catch { return false; }
            });

            useEffect(() => {
                localStorage.setItem('onlineFixStore_backgroundMusic', JSON.stringify(backgroundMusicEnabled));
            }, [backgroundMusicEnabled]);

            // Audio element ref for background music
            const audioRef = React.useRef(null);

            useEffect(() => {
                if (!loading && games.length > 0 && backgroundMusicEnabled) {
                    // Start music after loading is complete
                    if (!audioRef.current) {
                        audioRef.current = new Audio('online fix store menu song.mp3');
                        audioRef.current.loop = true;
                        audioRef.current.volume = 0.3; // Set to 30% volume
                    }
                    audioRef.current.play().catch(err => {
                        console.log('Audio autoplay prevented:', err);
                    });
                } else if (audioRef.current && !backgroundMusicEnabled) {
                    audioRef.current.pause();
                }

                return () => {
                    if (audioRef.current) {
                        audioRef.current.pause();
                    }
                };
            }, [loading, games.length, backgroundMusicEnabled]);

            // Window Mode Settings
            const [windowMode, setWindowMode] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_windowMode');
                    return saved || 'window';
                } catch { return 'window'; }
            });

            useEffect(() => {
                localStorage.setItem('onlineFixStore_windowMode', windowMode);
                // Try to apply window mode immediately if electronAPI is available
                if (window.electronAPI) {
                    if (window.electronAPI.setWindowMode) {
                        window.electronAPI.setWindowMode(windowMode);
                    }
                    // Also try alternate method names
                    if (window.electronAPI.setFullscreen && windowMode === 'fullscreen') {
                        window.electronAPI.setFullscreen(true);
                    } else if (window.electronAPI.setFullscreen && windowMode !== 'fullscreen') {
                        window.electronAPI.setFullscreen(false);
                    }
                }
            }, [windowMode]);

            // Language System
            const [language, setLanguage] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_language');
                    return saved || 'en';
                } catch { return 'en'; }
            });

            const translations = {
                en: {
                    // Navigation
                    home: 'Home',
                    store: 'Store',
                    gameBypasses: 'Game Bypasses',
                    downloads: 'Downloads',
                    favorites: 'Favorites',
                    backToStore: 'Back to Store',
                    statistics: 'Statistics',
                    installationGuide: 'Installation Guide',

                    // Actions
                    search: 'Search games...',
                    searchOnline: 'Search on online-fix.me',
                    howToRun: 'How to Run',
                    openSteam: 'Open in Steam',
                    downloadFix: 'Download Fix',
                    rateGame: 'Rate this game:',
                    clickToRemove: 'Click same star to remove',

                    // Filters
                    browseByTag: 'Browse by Tags',
                    browseByGenre: 'Browse by Genres',
                    loadingTags: 'Loading tags...',
                    loadingGenres: 'Loading genres...',
                    clearAll: 'Clear All',
                    selected: 'selected',
                    advancedFilters: 'Advanced Filters',
                    hideFilters: 'Hide Filters',
                    activeFilters: 'Active Filters:',

                    // View Mode
                    viewMode: 'View Mode:',
                    gridView: 'Grid',
                    listView: 'List',

                    // Pagination
                    first: 'First',
                    previous: 'Previous',
                    next: 'Next',
                    last: 'Last',
                    page: 'Page',
                    pageOf: 'of',

                    // Sorting
                    sortGames: 'Sort Games',
                    sortByNameAZ: 'A ‚Üí Z',
                    sortByNameZA: 'Z ‚Üí A',
                    sortByRatingHigh: 'Rating (High)',
                    sortByRatingLow: 'Rating (Low)',
                    sortByRecentDownload: 'Recent Downloads',
                    sortByFavorites: 'Favorites First',
                    sortByIdAsc: 'ID (Low ‚Üí High)',
                    sortByIdDesc: 'ID (High ‚Üí Low)',

                    // Game info
                    appId: 'App ID:',
                    metacritic: 'Metacritic:',
                    steamReviews: 'Steam Reviews:',
                    playingThrough: 'Playing Through:',
                    filesForGame: 'Files for the game:',
                    howToRunInstructions: 'How to Run Instructions',
                    close: 'Close',
                    instructionsNotAvailable: 'Instructions not available for this game.',
                    screenshots: 'Screenshots',
                    aboutGame: 'ABOUT THIS GAME',
                    coopFeatures: 'Co-Op Features',
                    loadingCoop: 'Loading co-op information...',
                    coopNotAvailable: 'Co-Op information not available for this game.',
                    tags: 'Tags',
                    genres: 'Genres',
                    developers: 'Developers',

                    // Stats
                    noGamesFound: 'No games found',
                    showing: 'Showing',
                    of: 'of',
                    games: 'games',
                    statisticsDashboard: 'Statistics Dashboard',
                    totalGames: 'Total Games',
                    totalDownloads: 'Total Downloads',
                    totalFavorites: 'Favorites',
                    averageRating: 'Average Rating',

                    // Installation Guide
                    installationGuideTitle: 'Installation Guide',
                    step1Title: 'üì• Step 1: Download the Fix',
                    step1Desc: 'Click the "Download Fix" button on any game page.',
                    step2Title: 'üìÇ Step 2: Extract the Archive',
                    step2Desc: 'Right-click the downloaded .zip file and select "Extract All".',
                    step3Title: 'üéÆ Step 3: Install the Game',
                    step3Desc: 'Make sure you have the base game installed first.',
                    step4Title: 'üìã Step 4: Follow the README',
                    step4Desc: 'The unzipped file will have a folder of the appID. Inside that folder is all you need. Copy all the content of that folder and paste it inside the folder of your game.',

                    // Home page
                    loadingStore: 'Loading Online Fix Store',
                    loadingMessage: 'This may take a few minutes for all games...',

                    // Notifications
                    downloading: 'Downloading',
                    downloaded: 'Downloaded',
                    downloadError: 'Download failed. Please try again.',
                    cached: 'Cached',

                    // Themes
                    themes: 'Themes',

                    // Language
                    language: 'Language',

                    // Settings & Contact
                    settings: 'Settings',
                    contact: 'Contact',
                    contactUs: 'Contact Us',
                    theme: 'Theme',
                    backgroundWallpaper: 'Background Wallpaper',
                    showWallpaper: 'Show Background Wallpaper',
                    hideWallpaper: 'Hide Background Wallpaper',
                    backgroundMusic: 'Background Music',
                    playBackgroundMusic: 'Play Background Music',
                    stopBackgroundMusic: 'Stop Background Music',
                    windowMode: 'Window Mode',
                    fullscreen: 'Fullscreen',
                    borderless: 'Borderless',
                    windowed: 'Windowed',
                    restartRequired: 'Restart required to apply changes',
                    keyboardShortcuts: 'Keyboard Shortcuts:',
                    navigatePages: 'Navigate pages',
                    backClose: 'Back/Close',
                    getInTouch: 'Get in touch with us for support, questions, or feedback.',
                    email: 'Email',
                    activeTheme: 'Active',
                    autoSwitchesTheme: 'Auto-switches based on theme',
                    startsAfterLoading: 'Starts after loading completes',

                    // Player Count Filter
                    playerCount: 'Player Count',
                    anyPlayerCount: 'Any Player Count',
                    twoPlayers: '2 Players',
                    fourPlayers: '4 Players',
                    sixPlusPlayers: '6+ Players',
                    hasCoopCampaign: 'Has Co-Op Campaign',
                    hasOnlineCoop: 'Has Online Co-Op',
                    hasLocalCoop: 'Has Local Co-Op / Split Screen'
                },
                fr: {
                    // Navigation
                    home: 'Accueil',
                    store: 'Magasin',
                    gameBypasses: 'Contournements de Jeux',
                    downloads: 'T√©l√©chargements',
                    favorites: 'Favoris',
                    backToStore: 'Retour au Magasin',
                    statistics: 'Statistiques',
                    installationGuide: 'Guide d\'Installation',

                    // Actions
                    search: 'Rechercher des jeux...',
                    searchOnline: 'Rechercher sur online-fix.me',
                    howToRun: 'Comment Ex√©cuter',
                    openSteam: 'Ouvrir dans Steam',
                    downloadFix: 'T√©l√©charger le Fix',
                    rateGame: 'Notez ce jeu:',
                    clickToRemove: 'Cliquez sur la m√™me √©toile pour supprimer',

                    // Filters
                    browseByTag: 'Parcourir par Tags',
                    browseByGenre: 'Parcourir par Genres',
                    loadingTags: 'Chargement des tags...',
                    loadingGenres: 'Chargement des genres...',
                    clearAll: 'Tout Effacer',
                    selected: 's√©lectionn√©(s)',
                    advancedFilters: 'Filtres Avanc√©s',
                    hideFilters: 'Masquer les Filtres',
                    activeFilters: 'Filtres Actifs:',

                    // View Mode
                    viewMode: 'Mode d\'Affichage:',
                    gridView: 'Grille',
                    listView: 'Liste',

                    // Pagination
                    first: 'Premier',
                    previous: 'Pr√©c√©dent',
                    next: 'Suivant',
                    last: 'Dernier',
                    page: 'Page',
                    pageOf: 'sur',

                    // Sorting
                    sortGames: 'Trier les Jeux',
                    sortByNameAZ: 'A ‚Üí Z',
                    sortByNameZA: 'Z ‚Üí A',
                    sortByRatingHigh: 'Note (√âlev√©e)',
                    sortByRatingLow: 'Note (Basse)',
                    sortByRecentDownload: 'T√©l√©chargements R√©cents',
                    sortByFavorites: 'Favoris en Premier',
                    sortByIdAsc: 'ID (Bas ‚Üí Haut)',
                    sortByIdDesc: 'ID (Haut ‚Üí Bas)',

                    // Game info
                    appId: 'ID de l\'App:',
                    metacritic: 'Metacritic:',
                    steamReviews: 'Avis Steam:',
                    playingThrough: 'Jouer Via:',
                    filesForGame: 'Fichiers pour le jeu:',
                    howToRunInstructions: 'Instructions d\'Ex√©cution',
                    close: 'Fermer',
                    instructionsNotAvailable: 'Instructions non disponibles pour ce jeu.',
                    screenshots: 'Captures d\'√©cran',
                    aboutGame: '√Ä PROPOS DE CE JEU',
                    coopFeatures: 'Fonctionnalit√©s Co-Op',
                    loadingCoop: 'Chargement des informations co-op...',
                    coopNotAvailable: 'Informations Co-Op non disponibles pour ce jeu.',
                    tags: 'Tags',
                    genres: 'Genres',
                    developers: 'D√©veloppeurs',

                    // Stats
                    noGamesFound: 'Aucun jeu trouv√©',
                    showing: 'Affichage',
                    of: 'sur',
                    games: 'jeux',
                    statisticsDashboard: 'Tableau de Bord des Statistiques',
                    totalGames: 'Total de Jeux',
                    totalDownloads: 'Total de T√©l√©chargements',
                    totalFavorites: 'Favoris',
                    averageRating: 'Note Moyenne',

                    // Installation Guide
                    installationGuideTitle: 'Guide d\'Installation',
                    step1Title: 'üì• √âtape 1: T√©l√©charger le Fix',
                    step1Desc: 'Cliquez sur le bouton "T√©l√©charger le Fix" sur n\'importe quelle page de jeu.',
                    step2Title: 'üìÇ √âtape 2: Extraire l\'Archive',
                    step2Desc: 'Faites un clic droit sur le fichier .zip t√©l√©charg√© et s√©lectionnez "Extraire tout".',
                    step3Title: 'üéÆ √âtape 3: Installer le Jeu',
                    step3Desc: 'Assurez-vous d\'avoir d\'abord install√© le jeu de base.',
                    step4Title: 'üìã √âtape 4: Suivre le README',
                    step4Desc: 'Le fichier d√©compress√© contiendra un dossier avec l\'appID. √Ä l\'int√©rieur de ce dossier se trouve tout ce dont vous avez besoin. Copiez tout le contenu de ce dossier et collez-le dans le dossier de votre jeu.',

                    // Home page
                    loadingStore: 'Chargement d\'Online Fix Store',
                    loadingMessage: 'Cela peut prendre quelques minutes pour tous les jeux...',

                    // Notifications
                    downloading: 'T√©l√©chargement',
                    downloaded: 'T√©l√©charg√©',
                    downloadError: '√âchec du t√©l√©chargement. Veuillez r√©essayer.',
                    cached: 'En cache',

                    // Themes
                    themes: 'Th√®mes',

                    // Language
                    language: 'Langue',

                    // Settings & Contact
                    settings: 'Param√®tres',
                    contact: 'Contact',
                    contactUs: 'Nous Contacter',
                    theme: 'Th√®me',
                    backgroundWallpaper: 'Fond d\'√âcran',
                    showWallpaper: 'Afficher le Fond d\'√âcran',
                    hideWallpaper: 'Masquer le Fond d\'√âcran',
                    backgroundMusic: 'Musique de Fond',
                    playBackgroundMusic: 'Jouer la Musique de Fond',
                    stopBackgroundMusic: 'Arr√™ter la Musique de Fond',
                    windowMode: 'Mode Fen√™tre',
                    fullscreen: 'Plein √âcran',
                    borderless: 'Sans Bordure',
                    windowed: 'Fen√™tr√©',
                    restartRequired: 'Red√©marrage requis pour appliquer les modifications',
                    keyboardShortcuts: 'Raccourcis Clavier:',
                    navigatePages: 'Naviguer entre les pages',
                    backClose: 'Retour/Fermer',
                    getInTouch: 'Contactez-nous pour le support, les questions ou les commentaires.',
                    email: 'Email',
                    activeTheme: 'Actif',
                    autoSwitchesTheme: 'Bascule automatiquement selon le th√®me',
                    startsAfterLoading: 'D√©marre apr√®s le chargement',

                    // Player Count Filter
                    playerCount: 'Nombre de Joueurs',
                    anyPlayerCount: 'Tout Nombre de Joueurs',
                    twoPlayers: '2 Joueurs',
                    fourPlayers: '4 Joueurs',
                    sixPlusPlayers: '6+ Joueurs',
                    hasCoopCampaign: 'A une Campagne Co-Op',
                    hasOnlineCoop: 'A du Co-Op en Ligne',
                    hasLocalCoop: 'A du Co-Op Local / √âcran Partag√©'
                },
                es: {
                    // Navigation
                    home: 'Inicio',
                    store: 'Tienda',
                    gameBypasses: 'Bypasses de Juegos',
                    downloads: 'Descargas',
                    favorites: 'Favoritos',
                    backToStore: 'Volver a la Tienda',
                    statistics: 'Estad√≠sticas',
                    installationGuide: 'Gu√≠a de Instalaci√≥n',

                    // Actions
                    search: 'Buscar juegos...',
                    searchOnline: 'Buscar en online-fix.me',
                    howToRun: 'C√≥mo Ejecutar',
                    openSteam: 'Abrir en Steam',
                    downloadFix: 'Descargar Fix',
                    rateGame: 'Califica este juego:',
                    clickToRemove: 'Haz clic en la misma estrella para eliminar',

                    // Filters
                    browseByTag: 'Navegar por Etiquetas',
                    browseByGenre: 'Navegar por G√©neros',
                    loadingTags: 'Cargando etiquetas...',
                    loadingGenres: 'Cargando g√©neros...',
                    clearAll: 'Limpiar Todo',
                    selected: 'seleccionado(s)',
                    advancedFilters: 'Filtros Avanzados',
                    hideFilters: 'Ocultar Filtros',
                    activeFilters: 'Filtros Activos:',

                    // View Mode
                    viewMode: 'Modo de Vista:',
                    gridView: 'Cuadr√≠cula',
                    listView: 'Lista',

                    // Pagination
                    first: 'Primero',
                    previous: 'Anterior',
                    next: 'Siguiente',
                    last: '√öltimo',
                    page: 'P√°gina',
                    pageOf: 'de',

                    // Sorting
                    sortGames: 'Ordenar Juegos',
                    sortByNameAZ: 'A ‚Üí Z',
                    sortByNameZA: 'Z ‚Üí A',
                    sortByRatingHigh: 'Calificaci√≥n (Alta)',
                    sortByRatingLow: 'Calificaci√≥n (Baja)',
                    sortByRecentDownload: 'Descargas Recientes',
                    sortByFavorites: 'Favoritos Primero',
                    sortByIdAsc: 'ID (Bajo ‚Üí Alto)',
                    sortByIdDesc: 'ID (Alto ‚Üí Bajo)',

                    // Game info
                    appId: 'ID de la App:',
                    metacritic: 'Metacritic:',
                    steamReviews: 'Rese√±as de Steam:',
                    playingThrough: 'Jugando a trav√©s de:',
                    filesForGame: 'Archivos para el juego:',
                    howToRunInstructions: 'Instrucciones de Ejecuci√≥n',
                    close: 'Cerrar',
                    instructionsNotAvailable: 'Instrucciones no disponibles para este juego.',
                    screenshots: 'Capturas de Pantalla',
                    aboutGame: 'ACERCA DE ESTE JUEGO',
                    coopFeatures: 'Caracter√≠sticas Co-Op',
                    loadingCoop: 'Cargando informaci√≥n co-op...',
                    coopNotAvailable: 'Informaci√≥n Co-Op no disponible para este juego.',
                    tags: 'Etiquetas',
                    genres: 'G√©neros',
                    developers: 'Desarrolladores',

                    // Stats
                    noGamesFound: 'No se encontraron juegos',
                    showing: 'Mostrando',
                    of: 'de',
                    games: 'juegos',
                    statisticsDashboard: 'Panel de Estad√≠sticas',
                    totalGames: 'Total de Juegos',
                    totalDownloads: 'Total de Descargas',
                    totalFavorites: 'Favoritos',
                    averageRating: 'Calificaci√≥n Promedio',

                    // Installation Guide
                    installationGuideTitle: 'Gu√≠a de Instalaci√≥n',
                    step1Title: 'üì• Paso 1: Descargar el Fix',
                    step1Desc: 'Haz clic en el bot√≥n "Descargar Fix" en cualquier p√°gina de juego.',
                    step2Title: 'üìÇ Paso 2: Extraer el Archivo',
                    step2Desc: 'Haz clic derecho en el archivo .zip descargado y selecciona "Extraer todo".',
                    step3Title: 'üéÆ Paso 3: Instalar el Juego',
                    step3Desc: 'Aseg√∫rate de tener el juego base instalado primero.',
                    step4Title: 'üìã Paso 4: Seguir el README',
                    step4Desc: 'El archivo descomprimido tendr√° una carpeta con el appID. Dentro de esa carpeta est√° todo lo que necesitas. Copia todo el contenido de esa carpeta y p√©galo dentro de la carpeta de tu juego.',

                    // Home page
                    loadingStore: 'Cargando Online Fix Store',
                    loadingMessage: 'Esto puede tardar unos minutos para todos los juegos...',

                    // Notifications
                    downloading: 'Descargando',
                    downloaded: 'Descargado',
                    downloadError: 'Error al descargar. Por favor, int√©ntalo de nuevo.',
                    cached: 'En cach√©',

                    // Themes
                    themes: 'Temas',

                    // Language
                    language: 'Idioma',

                    // Settings & Contact
                    settings: 'Configuraci√≥n',
                    contact: 'Contacto',
                    contactUs: 'Cont√°ctanos',
                    theme: 'Tema',
                    backgroundWallpaper: 'Fondo de Pantalla',
                    showWallpaper: 'Mostrar Fondo de Pantalla',
                    hideWallpaper: 'Ocultar Fondo de Pantalla',
                    backgroundMusic: 'M√∫sica de Fondo',
                    playBackgroundMusic: 'Reproducir M√∫sica de Fondo',
                    stopBackgroundMusic: 'Detener M√∫sica de Fondo',
                    windowMode: 'Modo de Ventana',
                    fullscreen: 'Pantalla Completa',
                    borderless: 'Sin Bordes',
                    windowed: 'Ventana',
                    restartRequired: 'Requiere reinicio para aplicar cambios',
                    keyboardShortcuts: 'Atajos de Teclado:',
                    navigatePages: 'Navegar p√°ginas',
                    backClose: 'Atr√°s/Cerrar',
                    getInTouch: 'Cont√°ctanos para soporte, preguntas o comentarios.',
                    email: 'Correo',
                    activeTheme: 'Activo',
                    autoSwitchesTheme: 'Cambia autom√°ticamente seg√∫n el tema',
                    startsAfterLoading: 'Comienza despu√©s de cargar',

                    // Player Count Filter
                    playerCount: 'Cantidad de Jugadores',
                    anyPlayerCount: 'Cualquier Cantidad',
                    twoPlayers: '2 Jugadores',
                    fourPlayers: '4 Jugadores',
                    sixPlusPlayers: '6+ Jugadores',
                    hasCoopCampaign: 'Tiene Campa√±a Co-Op',
                    hasOnlineCoop: 'Tiene Co-Op en L√≠nea',
                    hasLocalCoop: 'Tiene Co-Op Local / Pantalla Dividida'
                },
                zh: {
                    // Navigation
                    home: '‰∏ªÈ°µ',
                    store: 'ÂïÜÂ∫ó',
                    gameBypasses: 'Ê∏∏Êàè‰øÆÂ§ç',
                    downloads: '‰∏ãËΩΩ',
                    favorites: 'Êî∂Ëóè',
                    backToStore: 'ËøîÂõûÂïÜÂ∫ó',
                    statistics: 'ÁªüËÆ°',
                    installationGuide: 'ÂÆâË£ÖÊåáÂçó',

                    // Actions
                    search: 'ÊêúÁ¥¢Ê∏∏Êàè...',
                    searchOnline: 'Âú® online-fix.me ÊêúÁ¥¢',
                    howToRun: 'Â¶Ç‰ΩïËøêË°å',
                    openSteam: 'Âú® Steam ‰∏≠ÊâìÂºÄ',
                    downloadFix: '‰∏ãËΩΩ‰øÆÂ§ç',
                    rateGame: '‰∏∫Ê≠§Ê∏∏ÊàèËØÑÂàÜÔºö',
                    clickToRemove: 'ÁÇπÂáªÁõ∏ÂêåÊòüÊòü‰ª•ÁßªÈô§',

                    // Filters
                    browseByTag: 'ÊåâÊ†áÁ≠æÊµèËßà',
                    browseByGenre: 'ÊåâÁ±ªÂûãÊµèËßà',
                    loadingTags: 'Âä†ËΩΩÊ†áÁ≠æ‰∏≠...',
                    loadingGenres: 'Âä†ËΩΩÁ±ªÂûã‰∏≠...',
                    clearAll: 'Ê∏ÖÈô§ÂÖ®ÈÉ®',
                    selected: 'Â∑≤ÈÄâÊã©',
                    advancedFilters: 'È´òÁ∫ßÁ≠õÈÄâ',
                    hideFilters: 'ÈöêËóèÁ≠õÈÄâ',
                    activeFilters: 'Ê¥ªÂä®Á≠õÈÄâÔºö',

                    // View Mode
                    viewMode: 'Êü•ÁúãÊ®°ÂºèÔºö',
                    gridView: 'ÁΩëÊ†º',
                    listView: 'ÂàóË°®',

                    // Pagination
                    first: 'Á¨¨‰∏ÄÈ°µ',
                    previous: '‰∏ä‰∏ÄÈ°µ',
                    next: '‰∏ã‰∏ÄÈ°µ',
                    last: 'ÊúÄÂêéÈ°µ',
                    page: 'È°µ',
                    pageOf: 'ÂÖ±',

                    // Sorting
                    sortGames: 'ÊéíÂ∫èÊ∏∏Êàè',
                    sortByNameAZ: 'A ‚Üí Z',
                    sortByNameZA: 'Z ‚Üí A',
                    sortByRatingHigh: 'ËØÑÂàÜÔºàÈ´òÔºâ',
                    sortByRatingLow: 'ËØÑÂàÜÔºà‰ΩéÔºâ',
                    sortByRecentDownload: 'ÊúÄËøë‰∏ãËΩΩ',
                    sortByFavorites: 'Êî∂Ëóè‰ºòÂÖà',
                    sortByIdAsc: 'IDÔºà‰Ωé ‚Üí È´òÔºâ',
                    sortByIdDesc: 'IDÔºàÈ´ò ‚Üí ‰ΩéÔºâ',

                    // Game info
                    appId: 'Â∫îÁî® IDÔºö',
                    metacritic: 'MetacriticÔºö',
                    steamReviews: 'Steam ËØÑ‰ª∑Ôºö',
                    playingThrough: 'Ê∏∏Áé©ÊñπÂºèÔºö',
                    filesForGame: 'Ê∏∏ÊàèÊñá‰ª∂Ôºö',
                    howToRunInstructions: 'ËøêË°åËØ¥Êòé',
                    close: 'ÂÖ≥Èó≠',
                    instructionsNotAvailable: 'Ê≠§Ê∏∏ÊàèÊöÇÊó†ËØ¥Êòé„ÄÇ',
                    screenshots: 'Êà™Âõæ',
                    aboutGame: 'ÂÖ≥‰∫éÊ≠§Ê∏∏Êàè',
                    coopFeatures: 'Âêà‰ΩúÁâπÊÄß',
                    loadingCoop: 'Âä†ËΩΩÂêà‰Ωú‰ø°ÊÅØ‰∏≠...',
                    coopNotAvailable: 'Ê≠§Ê∏∏ÊàèÊöÇÊó†Âêà‰Ωú‰ø°ÊÅØ„ÄÇ',
                    tags: 'Ê†áÁ≠æ',
                    genres: 'Á±ªÂûã',
                    developers: 'ÂºÄÂèëËÄÖ',

                    // Stats
                    noGamesFound: 'Êú™ÊâæÂà∞Ê∏∏Êàè',
                    showing: 'ÊòæÁ§∫',
                    of: 'ÂÖ±',
                    games: 'Ê¨æÊ∏∏Êàè',
                    statisticsDashboard: 'ÁªüËÆ°Èù¢Êùø',
                    totalGames: 'Ê∏∏ÊàèÊÄªÊï∞',
                    totalDownloads: '‰∏ãËΩΩÊÄªÊï∞',
                    totalFavorites: 'Êî∂Ëóè',
                    averageRating: 'Âπ≥ÂùáËØÑÂàÜ',

                    // Installation Guide
                    installationGuideTitle: 'ÂÆâË£ÖÊåáÂçó',
                    step1Title: 'üì• Á¨¨‰∏ÄÊ≠•Ôºö‰∏ãËΩΩ‰øÆÂ§ç',
                    step1Desc: 'ÁÇπÂáª‰ªª‰ΩïÊ∏∏ÊàèÈ°µÈù¢‰∏äÁöÑ"‰∏ãËΩΩ‰øÆÂ§ç"ÊåâÈíÆ„ÄÇ',
                    step2Title: 'üìÇ Á¨¨‰∫åÊ≠•ÔºöËß£ÂéãÊñá‰ª∂',
                    step2Desc: 'Âè≥ÈîÆÁÇπÂáª‰∏ãËΩΩÁöÑ .zip Êñá‰ª∂Âπ∂ÈÄâÊã©"ÂÖ®ÈÉ®Ëß£Âéã"„ÄÇ',
                    step3Title: 'üéÆ Á¨¨‰∏âÊ≠•ÔºöÂÆâË£ÖÊ∏∏Êàè',
                    step3Desc: 'Á°Æ‰øùÊÇ®Â∑≤ÂÖàÂÆâË£ÖÂü∫Á°ÄÊ∏∏Êàè„ÄÇ',
                    step4Title: 'üìã Á¨¨ÂõõÊ≠•ÔºöÊü•Áúã README',
                    step4Desc: 'Ëß£ÂéãÂêéÁöÑÊñá‰ª∂Â∞ÜÂåÖÂê´‰∏Ä‰∏™Â∏¶Êúâ appID ÁöÑÊñá‰ª∂Â§π„ÄÇËØ•Êñá‰ª∂Â§πÂÜÖÂåÖÂê´ÊÇ®ÊâÄÈúÄÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπ„ÄÇÂ§çÂà∂ËØ•Êñá‰ª∂Â§πÁöÑÊâÄÊúâÂÜÖÂÆπÂπ∂Á≤òË¥¥Âà∞ÊÇ®ÁöÑÊ∏∏ÊàèÊñá‰ª∂Â§π‰∏≠„ÄÇ',

                    // Home page
                    loadingStore: 'Âä†ËΩΩ Online Fix Store',
                    loadingMessage: 'ÊâÄÊúâÊ∏∏ÊàèÂèØËÉΩÈúÄË¶ÅÂá†ÂàÜÈíü...',

                    // Notifications
                    downloading: '‰∏ãËΩΩ‰∏≠',
                    downloaded: 'Â∑≤‰∏ãËΩΩ',
                    downloadError: '‰∏ãËΩΩÂ§±Ë¥•„ÄÇËØ∑ÈáçËØï„ÄÇ',
                    cached: 'Â∑≤ÁºìÂ≠ò',

                    // Themes
                    themes: '‰∏ªÈ¢ò',

                    // Language
                    language: 'ËØ≠Ë®Ä',

                    // Settings & Contact
                    settings: 'ËÆæÁΩÆ',
                    contact: 'ËÅîÁ≥ª',
                    contactUs: 'ËÅîÁ≥ªÊàë‰ª¨',
                    theme: '‰∏ªÈ¢ò',
                    backgroundWallpaper: 'ËÉåÊôØÂ£ÅÁ∫∏',
                    showWallpaper: 'ÊòæÁ§∫ËÉåÊôØÂ£ÅÁ∫∏',
                    hideWallpaper: 'ÈöêËóèËÉåÊôØÂ£ÅÁ∫∏',
                    backgroundMusic: 'ËÉåÊôØÈü≥‰πê',
                    playBackgroundMusic: 'Êí≠ÊîæËÉåÊôØÈü≥‰πê',
                    stopBackgroundMusic: 'ÂÅúÊ≠¢ËÉåÊôØÈü≥‰πê',
                    windowMode: 'Á™óÂè£Ê®°Âºè',
                    fullscreen: 'ÂÖ®Â±è',
                    borderless: 'Êó†ËæπÊ°Ü',
                    windowed: 'Á™óÂè£',
                    restartRequired: 'ÈúÄË¶ÅÈáçÂêØ‰ª•Â∫îÁî®Êõ¥Êîπ',
                    keyboardShortcuts: 'ÈîÆÁõòÂø´Êç∑ÈîÆÔºö',
                    navigatePages: 'ÂØºËà™È°µÈù¢',
                    backClose: 'ËøîÂõû/ÂÖ≥Èó≠',
                    getInTouch: 'ËÅîÁ≥ªÊàë‰ª¨Ëé∑ÂèñÊîØÊåÅ„ÄÅÊèêÈóÆÊàñÂèçÈ¶à„ÄÇ',
                    email: 'ÈÇÆÁÆ±',
                    activeTheme: 'Ê¥ªÂä®',
                    autoSwitchesTheme: 'Ê†πÊçÆ‰∏ªÈ¢òËá™Âä®ÂàáÊç¢',
                    startsAfterLoading: 'Âä†ËΩΩÂÆåÊàêÂêéÂºÄÂßã',

                    // Player Count Filter
                    playerCount: 'Áé©ÂÆ∂Êï∞Èáè',
                    anyPlayerCount: '‰ªªÊÑèÊï∞Èáè',
                    twoPlayers: '2 ÂêçÁé©ÂÆ∂',
                    fourPlayers: '4 ÂêçÁé©ÂÆ∂',
                    sixPlusPlayers: '6+ ÂêçÁé©ÂÆ∂',
                    hasCoopCampaign: 'ÊúâÂêà‰ΩúÊàòÂΩπ',
                    hasOnlineCoop: 'ÊúâÂú®Á∫øÂêà‰Ωú',
                    hasLocalCoop: 'ÊúâÊú¨Âú∞Âêà‰Ωú/ÂàÜÂ±è'
                }
            };

            const t = (key) => translations[language][key] || translations.en[key] || key;

            // Function to get Steam rating description based on review percentage
            const getSteamRatingDescription = (recommendations, reviewScoreDesc = null) => {
                if (!recommendations || !recommendations.total || recommendations.total === 0) {
                    console.log('‚ùå No recommendations data or total is 0:', recommendations);
                    return null;
                }

                console.log('üìä Steam recommendations:', recommendations);

                // PRIORITY 1: Use review_score_desc from Steam API if available
                if (reviewScoreDesc) {
                    console.log('‚úÖ Using Steam review_score_desc:', reviewScoreDesc);

                    // Map Steam's review_score_desc to colors
                    const ratingMap = {
                        'Overwhelmingly Positive': { text: 'Overwhelmingly Positive', color: 'bg-blue-600' },
                        'Very Positive': { text: 'Very Positive', color: 'bg-blue-500' },
                        'Positive': { text: 'Positive', color: 'bg-green-600' },
                        'Mostly Positive': { text: 'Mostly Positive', color: 'bg-green-500' },
                        'Mixed': { text: 'Mixed', color: 'bg-yellow-600' },
                        'Mostly Negative': { text: 'Mostly Negative', color: 'bg-orange-500' },
                        'Negative': { text: 'Negative', color: 'bg-orange-600' },
                        'Very Negative': { text: 'Very Negative', color: 'bg-red-500' },
                        'Overwhelmingly Negative': { text: 'Overwhelmingly Negative', color: 'bg-red-600' }
                    };

                    return ratingMap[reviewScoreDesc] || { text: reviewScoreDesc, color: 'bg-gray-600' };
                }

                // FALLBACK: Calculate from positive/negative ratio if available
                const positiveCount = recommendations.positive ?? recommendations.up ?? 0;

                // If positive count is 0 or undefined, we can't calculate
                if (positiveCount === 0 || positiveCount === undefined) {
                    console.log('‚ö†Ô∏è Steam API does not provide positive/negative breakdown and no review_score_desc. Hiding rating description.');
                    return null;
                }

                // Ensure we have valid numbers
                if (typeof positiveCount !== 'number' || typeof recommendations.total !== 'number') {
                    console.log('‚ùå Invalid number types');
                    return null;
                }

                const percentage = (positiveCount / recommendations.total) * 100;
                console.log('üìà Calculated percentage:', percentage.toFixed(2) + '%');

                if (percentage >= 95) return { text: 'Overwhelmingly Positive', color: 'bg-blue-600' };
                if (percentage >= 80) return { text: 'Very Positive', color: 'bg-blue-500' };
                if (percentage >= 70) return { text: 'Positive', color: 'bg-green-600' };
                if (percentage >= 40) return { text: 'Mixed', color: 'bg-yellow-600' };
                if (percentage >= 20) return { text: 'Negative', color: 'bg-orange-600' };
                return { text: 'Overwhelmingly Negative', color: 'bg-red-600' };
            };

            useEffect(() => {
                localStorage.setItem('onlineFixStore_language', language);
            }, [language]);

            // Update Notifications System
            const [notifications, setNotifications] = useState([]);
            const [lastKnownGameCount, setLastKnownGameCount] = useState(() => {
                try {
                    const saved = localStorage.getItem('onlineFixStore_lastKnownGameCount');
                    return saved ? parseInt(saved) : 0;
                } catch { return 0; }
            });

            // Legacy darkMode for backward compatibility
            const darkMode = currentTheme !== 'light';
            const [showStats, setShowStats] = useState(false);
            const [newGamesCount, setNewGamesCount] = useState(0);
            const [coopData, setCoopData] = useState(null);
            const [coopLoading, setCoopLoading] = useState(false);
            const [showAdvancedSearch, setShowAdvancedSearch] = useState(false);
            const [advancedFilters, setAdvancedFilters] = useState({
                minRating: 0,
                maxRating: 5,
                playerCount: '',
                hasCoopCampaign: false,
                onlineOnly: false,
                localOnly: false
            });
            const [sortBy, setSortBy] = useState('default');
            const [viewMode, setViewMode] = useState('grid');
            const [initialLoading, setInitialLoading] = useState(true);
            const [loadingProgress, setLoadingProgress] = useState(0);
            const [loadingMessage, setLoadingMessage] = useState('Initializing...');
            const [allGamesData, setAllGamesData] = useState({});

            const GITHUB_USERNAME = 'ShayneVi';
            const GITHUB_REPO = 'OnlineFix';
            const GAMES_PER_PAGE = 30;
            const VERCEL_BASE_URL = 'https://online-fix-store.vercel.app';
            const steamCache = {};
            const CACHE_VERSION = 'v2'; // Bumped to force refresh of Steam recommendations data
            const CACHE_EXPIRY = 7 * 24 * 60 * 60 * 1000; // 7 days in milliseconds

            // Local caching system for game data
            const getCachedGameData = (appID) => {
                try {
                    const cached = localStorage.getItem(`gameCache_${CACHE_VERSION}_${appID}`);
                    if (cached) {
                        const data = JSON.parse(cached);
                        if (Date.now() - data.timestamp < CACHE_EXPIRY) {
                            return data.gameData;
                        }
                    }
                } catch (e) {
                    console.error('Cache read error:', e);
                }
                return null;
            };

            const setCachedGameData = (appID, gameData) => {
                try {
                    const cacheData = {
                        timestamp: Date.now(),
                        gameData: gameData
                    };
                    localStorage.setItem(`gameCache_${CACHE_VERSION}_${appID}`, JSON.stringify(cacheData));
                } catch (e) {
                    console.error('Cache write error:', e);
                }
            };

            const getCachedSteamData = (appID) => {
                try {
                    const cached = localStorage.getItem(`steamCache_${CACHE_VERSION}_${appID}`);
                    if (cached) {
                        const data = JSON.parse(cached);
                        if (Date.now() - data.timestamp < CACHE_EXPIRY) {
                            return data.steamData;
                        }
                    }
                } catch (e) {
                    console.error('Cache read error:', e);
                }
                return null;
            };

            const setCachedSteamData = (appID, steamData) => {
                try {
                    const cacheData = {
                        timestamp: Date.now(),
                        steamData: steamData
                    };
                    localStorage.setItem(`steamCache_${CACHE_VERSION}_${appID}`, JSON.stringify(cacheData));
                } catch (e) {
                    console.error('Cache write error:', e);
                }
            };

            const isGameCached = (appID) => {
                return getCachedGameData(appID) !== null && getCachedSteamData(appID) !== null;
            };

            // Notification system functions
            const addNotification = (message, type = 'info', gameAppID = null) => {
                const notification = {
                    id: Date.now() + Math.random(),
                    message,
                    type, // 'info', 'success', 'update'
                    gameAppID,
                    timestamp: Date.now()
                };

                setNotifications(prev => [notification, ...prev].slice(0, 10)); // Keep last 10 notifications

                // Desktop notification via Electron
                if (window.electronAPI && window.electronAPI.showNotification) {
                    window.electronAPI.showNotification({
                        title: type === 'update' ? 'Update Available' : 'Online Fix Store',
                        body: message
                    });
                }

                // Auto-dismiss after 10 seconds
                setTimeout(() => {
                    setNotifications(prev => prev.filter(n => n.id !== notification.id));
                }, 10000);
            };

            const dismissNotification = (id) => {
                setNotifications(prev => prev.filter(n => n.id !== id));
            };

            // Check for new games and updates
            const checkForUpdates = (currentGames) => {
                if (lastKnownGameCount > 0 && currentGames.length > lastKnownGameCount) {
                    const newGamesAdded = currentGames.length - lastKnownGameCount;
                    addNotification(
                        `${newGamesAdded} new game${newGamesAdded > 1 ? 's' : ''} added to database`,
                        'update'
                    );
                }

                setLastKnownGameCount(currentGames.length);
                localStorage.setItem('onlineFixStore_lastKnownGameCount', currentGames.length.toString());
            };

            // Save to localStorage
            useEffect(() => {
                localStorage.setItem('onlineFixStore_favorites', JSON.stringify(favorites));
            }, [favorites]);

            useEffect(() => {
                localStorage.setItem('onlineFixStore_downloads', JSON.stringify(downloadHistory));
            }, [downloadHistory]);

            useEffect(() => {
                localStorage.setItem('onlineFixStore_ratings', JSON.stringify(ratings));
            }, [ratings]);

            useEffect(() => {
                localStorage.setItem('onlineFixStore_theme', currentTheme);
                document.body.className = themes[currentTheme].class;
            }, [currentTheme]);

            // Keyboard shortcuts
            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

                    switch(e.key) {
                        case 'Escape':
                            if (selectedGame) {
                                setSelectedGame(null);
                                setCurrentView('store');
                            }
                            if (lightboxImage) setLightboxImage(null);
                            break;
                        case 'ArrowLeft':
                            if (currentView === 'store' && !selectedGame && currentPage > 1) {
                                setCurrentPage(p => p - 1);
                            }
                            break;
                        case 'ArrowRight':
                            if (currentView === 'store' && !selectedGame) {
                                const totalPages = Math.ceil(filteredGames.length / GAMES_PER_PAGE);
                                if (currentPage < totalPages) {
                                    setCurrentPage(p => p + 1);
                                }
                            }
                            break;
                    }
                };

                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, [currentView, selectedGame, currentPage, lightboxImage]);

            // Check for new games
            useEffect(() => {
                const checkForNewGames = () => {
                    try {
                        const lastCheck = localStorage.getItem('onlineFixStore_lastGameCount');
                        if (lastCheck && games.length > 0) {
                            const lastCount = parseInt(lastCheck);
                            if (games.length > lastCount) {
                                setNewGamesCount(games.length - lastCount);
                            }
                        }
                        if (games.length > 0) {
                            localStorage.setItem('onlineFixStore_lastGameCount', games.length.toString());
                        }
                    } catch (e) {}
                };

                checkForNewGames();
            }, [games.length]);

            const fetchFromVercel = async (filename) => {
                try {
                    if (window.electronAPI) {
                        return await window.electronAPI.fetchRemoteFile(`${VERCEL_BASE_URL}/${filename}`);
                    } else {
                        const response = await fetch(`/${filename}`);
                        if (!response.ok) throw new Error(`Could not load ${filename}`);
                        return await response.text();
                    }
                } catch (error) {
                    console.error(`Error fetching ${filename}:`, error);
                    throw error;
                }
            };

            useEffect(() => {
                const loadGames = async () => {
                    try {
                        setLoadingMessage('Loading game list...');
                        const text = await fetchFromVercel('appIDs.txt');
                        const appIDsFromFile = text.split(/[\n,]/).map(id => id.trim()).filter(id => id.length > 0);
                        
                        if (appIDsFromFile.length === 0) throw new Error('No App IDs found');

                        const gameList = appIDsFromFile.map(appID => ({
                            id: appID,
                            appID: appID,
                            filename: appID + '.zip',
                            downloadUrl: `https://raw.githubusercontent.com/${GITHUB_USERNAME}/${GITHUB_REPO}/main/${appID}.zip`,
                            name: `Game ${appID}`,
                            headerImage: '',
                            loading: true,
                            tags: [],
                            genres: [],
                            coopData: null
                        }));

                        setGames(gameList);
                        setLoading(false);

                        // Check for new games
                        checkForUpdates(gameList);

                        // Now fetch all Steam and Co-Op data
                        await fetchAllGameData(gameList);
                        
                    } catch (error) {
                        console.error('Error loading App IDs:', error);
                        setGames([]);
                        setLoading(false);
                        setInitialLoading(false);
                    }
                };

                loadGames();

                // Load README.md content for home page
                window.electronAPI.readReadme()
                    .then(text => setHomeContent(text))
                    .catch(() => setHomeContent('# Welcome to OnlineFix Store\n\nYour one-stop destination for game fixes and updates.\n\n**All credits go to [online-fix.me](https://online-fix.me) and their team!**'));
            }, []);

            const fetchAllGameData = async (gameList) => {
                const total = gameList.length;
                let completed = 0;
                const gameDataMap = {};

                setLoadingMessage(`Fetching data for ${total} games...`);

                // Fetch in batches to avoid overwhelming the servers
                const batchSize = 10;
                for (let i = 0; i < gameList.length; i += batchSize) {
                    const batch = gameList.slice(i, i + batchSize);
                    
                    await Promise.all(batch.map(async (game) => {
                        try {
                            // Fetch Steam data
                            const steamInfo = await fetchGameData(game.appID);
                            
                            // Fetch Co-Op data
                            let coopInfo = null;
                            if (steamInfo && steamInfo.name) {
                                coopInfo = await fetchCoopDataForGame(steamInfo.name);
                            }
                            
                            gameDataMap[game.appID] = {
                                ...steamInfo,
                                coopData: coopInfo
                            };
                            
                            completed++;
                            setLoadingProgress(Math.round((completed / total) * 100));
                            setLoadingMessage(`Loading game data... ${completed}/${total}`);
                            
                        } catch (error) {
                            console.error(`Error fetching data for ${game.appID}:`, error);
                            completed++;
                            setLoadingProgress(Math.round((completed / total) * 100));
                        }
                    }));
                    
                    // Small delay between batches
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                // Update all games with fetched data
                setGames(prevGames => prevGames.map(game => ({
                    ...game,
                    name: gameDataMap[game.appID]?.name || game.name,
                    headerImage: gameDataMap[game.appID]?.headerImage || '',
                    backgroundImage: gameDataMap[game.appID]?.backgroundImage || '',
                    tags: gameDataMap[game.appID]?.tags || [],
                    genres: gameDataMap[game.appID]?.genres || [],
                    hasSplitScreen: gameDataMap[game.appID]?.hasSplitScreen || false,
                    coopData: gameDataMap[game.appID]?.coopData || null,
                    metacritic: gameDataMap[game.appID]?.metacritic || null,
                    recommendations: gameDataMap[game.appID]?.recommendations || null
                })));
                
                setAllGamesData(gameDataMap);
                setLoadingMessage('All data loaded!');
                
                // Close loading screen after a short delay
                setTimeout(() => {
                    setInitialLoading(false);
                }, 500);
            };

            const fetchCoopDataForGame = async (gameName) => {
                try {
                    // Try manual database first
                    try {
                        const dbUrl = window.electronAPI 
                            ? `${VERCEL_BASE_URL}/coopData.json`
                            : '/coopData.json';
                        
                        const manualResponse = await fetch(dbUrl);
                        if (manualResponse.ok) {
                            const manualData = await manualResponse.json();
                            if (manualData.games && manualData.games[gameName]) {
                                return manualData.games[gameName];
                            }
                        }
                    } catch (e) {
                        // Continue to API
                    }
                    
                    // Try API
                    const searchQuery = encodeURIComponent(gameName);
                    const apiUrl = window.electronAPI 
                        ? `${VERCEL_BASE_URL}/api/coop?name=${searchQuery}`
                        : `/api/coop?name=${searchQuery}`;
                    
                    const response = await fetch(apiUrl);
                    
                    if (response.ok) {
                        const data = await response.json();
                        return data;
                    }
                    
                    return null;
                } catch (error) {
                    return null;
                }
            };

            const fetchGameData = async (appID) => {
                if (steamCache[appID]) return steamCache[appID];

                // Try to get from cache first
                const cachedData = getCachedGameData(appID);
                if (cachedData) {
                    steamCache[appID] = cachedData;

                    // Still need to populate tags and genres for the UI
                    if (cachedData.tags && cachedData.tags.length > 0) {
                        setAllTags(prev => {
                            const newTags = [...prev];
                            cachedData.tags.forEach(tag => {
                                if (!newTags.find(t => t.name === tag.name)) {
                                    newTags.push(tag);
                                }
                            });
                            return newTags.sort((a, b) => a.name.localeCompare(b.name));
                        });
                    }

                    if (cachedData.genres && cachedData.genres.length > 0) {
                        setAllGenres(prev => {
                            const newGenres = [...prev];
                            cachedData.genres.forEach(genre => {
                                if (!newGenres.find(g => g.description === genre.description)) {
                                    newGenres.push(genre);
                                }
                            });
                            return newGenres.sort((a, b) => a.description.localeCompare(b.description));
                        });
                    }

                    return cachedData;
                }

                try {
                    const apiUrl = window.electronAPI
                        ? `${VERCEL_BASE_URL}/api/steam?appid=${appID}`
                        : `/api/steam?appid=${appID}`;

                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 5000);

                    const response = await fetch(apiUrl, { signal: controller.signal });
                    clearTimeout(timeoutId);

                    const data = await response.json();
                    
                    if (data[appID] && data[appID].success) {
                        const gameData = data[appID].data;
                        
                        // Check for split-screen/local co-op in Steam categories
                        const hasSplitScreen = gameData.categories?.some(cat => 
                            cat.description?.toLowerCase().includes('local co-op') ||
                            cat.description?.toLowerCase().includes('shared/split screen') ||
                            cat.description?.toLowerCase().includes('split screen')
                        ) || false;
                        
                        const gameInfo = {
                            name: gameData.name || `Game ${appID}`,
                            headerImage: gameData.header_image || '',
                            backgroundImage: gameData.background || gameData.background_raw || '',
                            tags: gameData.user_tags || [],
                            genres: gameData.genres || [],
                            hasSplitScreen: hasSplitScreen,
                            metacritic: gameData.metacritic || null,
                            recommendations: gameData.recommendations || null
                        };
                        steamCache[appID] = gameInfo;

                        // Metacritic fallback now handled by Vercel API - no need for client-side fetch

                        // Cache the game data locally
                        setCachedGameData(appID, gameInfo);
                        
                        if (gameInfo.tags.length > 0) {
                            setAllTags(prev => {
                                const newTags = [...prev];
                                gameInfo.tags.forEach(tag => {
                                    if (!newTags.find(t => t.name === tag.name)) {
                                        newTags.push(tag);
                                    }
                                });
                                return newTags.sort((a, b) => a.name.localeCompare(b.name));
                            });
                        }
                        
                        if (gameInfo.genres.length > 0) {
                            setAllGenres(prev => {
                                const newGenres = [...prev];
                                gameInfo.genres.forEach(genre => {
                                    if (!newGenres.find(g => g.description === genre.description)) {
                                        newGenres.push(genre);
                                    }
                                });
                                return newGenres.sort((a, b) => a.description.localeCompare(b.description));
                            });
                        }
                        
                        return gameInfo;
                    }
                } catch (error) {
                    const fallbackInfo = {
                        name: `Game ${appID}`,
                        headerImage: '',
                        backgroundImage: '',
                        tags: [],
                        genres: [],
                        hasSplitScreen: false,
                        metacritic: null,
                        recommendations: null
                    };
                    steamCache[appID] = fallbackInfo;
                    return fallbackInfo;
                }
                
                return null;
            };

            useEffect(() => {
                const fetchAllGames = async () => {
                    const gamesToFetch = games.filter(game => game.name.startsWith('Game ') && !steamCache[game.appID]);
                    if (gamesToFetch.length === 0) return;
                    
                    const visibleGames = currentGames.filter(game => game.name.startsWith('Game ') && !steamCache[game.appID]);
                    
                    if (visibleGames.length > 0) {
                        const visibleResults = await Promise.allSettled(visibleGames.map(game => fetchGameData(game.appID)));
                        
                        visibleResults.forEach((result, idx) => {
                            if (result.status === 'fulfilled' && result.value) {
                                const game = visibleGames[idx];
                                setGames(prevGames =>
                                    prevGames.map(g =>
                                        g.appID === game.appID
                                            ? { ...g, name: result.value.name, headerImage: result.value.headerImage, backgroundImage: result.value.backgroundImage, tags: result.value.tags, genres: result.value.genres, hasSplitScreen: result.value.hasSplitScreen, metacritic: result.value.metacritic, recommendations: result.value.recommendations }
                                            : g
                                    )
                                );
                            }
                        });
                    }
                    
                    const remainingGames = gamesToFetch.filter(game => !visibleGames.some(vg => vg.appID === game.appID));
                    if (remainingGames.length === 0) return;
                    
                    const batchSize = 15;
                    for (let i = 0; i < remainingGames.length; i += batchSize) {
                        const batch = remainingGames.slice(i, i + batchSize);
                        const results = await Promise.allSettled(batch.map(game => fetchGameData(game.appID)));
                        
                        results.forEach((result, idx) => {
                            if (result.status === 'fulfilled' && result.value) {
                                const game = batch[idx];
                                setGames(prevGames =>
                                    prevGames.map(g =>
                                        g.appID === game.appID
                                            ? { ...g, name: result.value.name, headerImage: result.value.headerImage, backgroundImage: result.value.backgroundImage, tags: result.value.tags, genres: result.value.genres, hasSplitScreen: result.value.hasSplitScreen, metacritic: result.value.metacritic, recommendations: result.value.recommendations }
                                            : g
                                    )
                                );
                            }
                        });
                        
                        if (i + batchSize < remainingGames.length) {
                            await new Promise(resolve => setTimeout(resolve, 100));
                        }
                    }
                };

                if (!loading && games.length > 0 && currentView === 'store') {
                    fetchAllGames();
                }
            }, [games.length, currentView, loading, currentPage]);

            const fetchSteamData = async (appID) => {
                try {
                    setSteamLoading(true);
                    setSteamData(null);
                    setCoopData(null);

                    // Try to get from cache first - but verify it has the full data structure
                    const cachedSteam = getCachedSteamData(appID);
                    if (cachedSteam && cachedSteam.recommendations !== undefined && cachedSteam.metacritic !== undefined) {
                        console.log('Using cached Steam data for', appID);
                        setSteamData(cachedSteam);
                        setSteamLoading(false);

                        // Still fetch Co-Op data and Online-Fix data if we have the game name
                        if (cachedSteam.name) {
                            fetchCoopData(cachedSteam.name);
                            fetchOnlineFixData(cachedSteam.name);
                        }
                        return;
                    } else if (cachedSteam) {
                        console.log('Cache exists but missing data, refetching for', appID);
                    }

                    const apiUrl = window.electronAPI
                        ? `${VERCEL_BASE_URL}/api/steam?appid=${appID}`
                        : `/api/steam?appid=${appID}`;

                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);

                    const response = await fetch(apiUrl, { signal: controller.signal });
                    clearTimeout(timeoutId);

                    const data = await response.json();

                    if (data[appID] && data[appID].success) {
                        const gameData = data[appID].data;
                        console.log('=== Steam API Response for', appID, '===');
                        console.log('Full game data:', gameData);
                        console.log('Metacritic data:', gameData.metacritic);
                        console.log('Recommendations data:', gameData.recommendations);
                        console.log('Review score:', gameData.review_score);
                        console.log('Review score desc:', gameData.review_score_desc);
                        console.log('Recommendations structure:', {
                            total: gameData.recommendations?.total,
                            positive: gameData.recommendations?.positive || gameData.recommendations?.up
                        });

                        const steamDataObj = {
                            name: gameData.name || `Game ${appID}`,
                            header_image: gameData.header_image || '',
                            background: gameData.background || gameData.background_raw || '',
                            background_raw: gameData.background_raw || '',
                            short_description: gameData.short_description || '',
                            detailed_description: gameData.detailed_description || '',
                            about_the_game: gameData.about_the_game || '',
                            screenshots: gameData.screenshots || [],
                            movies: gameData.movies || [],
                            genres: gameData.genres || [],
                            categories: gameData.categories || [],
                            user_tags: gameData.user_tags || [],
                            developers: gameData.developers || [],
                            publishers: gameData.publishers || [],
                            release_date: gameData.release_date || {},
                            platforms: gameData.platforms || {},
                            metacritic: gameData.metacritic || null,
                            review_score: gameData.review_score || null,
                            review_score_desc: gameData.review_score_desc || null,
                            recommendations: gameData.recommendations ? {
                                total: gameData.recommendations.total,
                                positive: gameData.recommendations.positive || gameData.recommendations.up || 0
                            } : null
                        };
                        console.log('Processed steamDataObj:', steamDataObj);
                        setSteamData(steamDataObj);

                        // Cache the detailed Steam data (Metacritic fallback now handled by Vercel API)
                        setCachedSteamData(appID, steamDataObj);

                        setGames(prevGames =>
                            prevGames.map(game =>
                                game.appID === appID ? { ...game, name: gameData.name } : game
                            )
                        );

                        // Fetch Co-Op data and Online-Fix data after getting game name
                        if (gameData.name) {
                            console.log('Triggering co-op fetch for:', gameData.name);
                            fetchCoopData(gameData.name);
                            fetchOnlineFixData(gameData.name);
                        }
                    } else {
                        throw new Error('Game not found');
                    }
                } catch (error) {
                    console.error('Error fetching Steam data:', error);
                    setSteamData({
                        name: `Game ${appID}`,
                        header_image: '',
                        short_description: 'Description not available',
                        detailed_description: '',
                        about_the_game: '',
                        screenshots: [],
                        movies: [],
                        genres: [],
                        categories: [],
                        user_tags: [],
                        metacritic: null,
                        recommendations: null
                    });
                } finally {
                    setSteamLoading(false);
                }
            };

            const fetchCoopData = async (gameName) => {
                if (!gameName) {
                    console.log('No game name provided for Co-Op fetch');
                    return;
                }

                setCoopLoading(true);
                setCoopData(null);

                try {
                    console.log('=== Fetching Co-Op data for:', gameName, '===');

                    // Try manual database first
                    try {
                        const dbUrl = window.electronAPI
                            ? `${VERCEL_BASE_URL}/coopData.json`
                            : '/coopData.json';

                        console.log('Trying manual DB at:', dbUrl);
                        const manualResponse = await fetch(dbUrl);

                        if (manualResponse.ok) {
                            const manualData = await manualResponse.json();
                            console.log('Manual DB loaded, checking for:', gameName);
                            console.log('Available games in DB:', Object.keys(manualData.games || {}).slice(0, 5));

                            if (manualData.games && manualData.games[gameName]) {
                                console.log('‚úì Found Co-Op data in manual DB!');
                                setCoopData(manualData.games[gameName]);
                                setCoopLoading(false);
                                return;
                            } else {
                                console.log('Game not found in manual DB');
                            }
                        } else {
                            console.log('Manual DB not available, status:', manualResponse.status);
                        }
                    } catch (e) {
                        console.log('Manual DB error:', e.message);
                    }

                    // Try API
                    console.log('Trying Co-Op API...');
                    const searchQuery = encodeURIComponent(gameName);
                    const apiUrl = window.electronAPI
                        ? `${VERCEL_BASE_URL}/api/coop?name=${searchQuery}`
                        : `/api/coop?name=${searchQuery}`;

                    console.log('Co-Op API URL:', apiUrl);

                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000);

                    const response = await fetch(apiUrl, { signal: controller.signal });
                    clearTimeout(timeoutId);

                    console.log('Co-Op API status:', response.status);

                    if (response.ok) {
                        const data = await response.json();
                        console.log('Co-Op API Response:', data);
                        console.log('Co-Op data has properties:', Object.keys(data || {}).join(', '));

                        // Check if data is valid and has co-op properties
                        if (data && typeof data === 'object' && Object.keys(data).length > 0) {
                            console.log('‚úì Co-Op data received from API!');
                            setCoopData(data);
                        } else {
                            console.log('‚úó Co-Op API returned empty or invalid data');
                            setCoopData(null);
                        }
                    } else {
                        console.log('‚úó Co-Op API failed with status:', response.status);
                        try {
                            const errorText = await response.text();
                            console.log('Error response:', errorText);
                        } catch (e) {
                            console.log('Could not read error response');
                        }
                        setCoopData(null);
                    }
                } catch (error) {
                    console.error('‚úó Co-op fetch error:', error.message);
                    setCoopData(null);
                } finally {
                    setCoopLoading(false);
                }
            };

            // Fetch Online-Fix.me data (Playing Through + How to Run)
            const fetchOnlineFixData = async (gameName) => {
                if (!gameName) {
                    console.log('‚ùå No game name provided for online-fix fetch');
                    return;
                }

                try {
                    console.log('üîç Fetching online-fix.me data for:', gameName);

                    // Search for the game on online-fix.me
                    const searchUrl = `https://online-fix.me/index.php?do=search&subaction=search&story=${encodeURIComponent(gameName)}`;
                    console.log('üîó Search URL:', searchUrl);

                    let html = '';
                    if (window.electronAPI && window.electronAPI.fetchRemoteFile) {
                        console.log('üì° Using Electron API to fetch...');
                        html = await window.electronAPI.fetchRemoteFile(searchUrl);
                    } else {
                        console.log('‚ùå Electron API not available. Online-fix.me fetching only works in Electron app due to CORS restrictions.');
                        setOnlineFixData(null);
                        return null;
                    }

                    console.log('üìÑ HTML received, length:', html.length);

                    if (!html || html.length < 100) {
                        console.log('‚ùå HTML too short or empty');
                        setOnlineFixData(null);
                        return null;
                    }

                    // Parse HTML to find the game page link
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');

                    // Try multiple selectors to find game links
                    const selectors = [
                        '.story__title a',
                        '.story-title a',
                        '.short-story-title a',
                        '.news-title a',
                        '.short-title a',
                        'h2 a',
                        'h3 a',
                        'article a',
                        '.item-title a'
                    ];

                    let gameLink = null;
                    for (const selector of selectors) {
                        gameLink = doc.querySelector(selector);
                        if (gameLink) {
                            console.log('‚úÖ Found link with selector:', selector);
                            break;
                        }
                    }

                    if (!gameLink) {
                        console.log('‚ùå No game page link found with standard selectors');

                        // Try to find any link with "games" in href
                        const allLinks = doc.querySelectorAll('a[href*="games"]');
                        console.log('Found', allLinks.length, 'links with "games" in href');

                        if (allLinks.length > 0) {
                            // Filter links that look like game pages (contain numbers)
                            const gameLinks = Array.from(allLinks).filter(link => {
                                const href = link.getAttribute('href') || '';
                                return /games\/[^\/]+\/\d+/.test(href);
                            });

                            if (gameLinks.length > 0) {
                                gameLink = gameLinks[0];
                                console.log('‚úÖ Using filtered game link:', gameLink.getAttribute('href'));
                            } else if (allLinks.length > 0) {
                                gameLink = allLinks[0];
                                console.log('‚ö†Ô∏è Using first games link:', gameLink.getAttribute('href'));
                            }
                        }

                        if (!gameLink) {
                            console.log('‚ùå No suitable game links found');
                            setOnlineFixData(null);
                            return null;
                        }
                    }

                    let gamePageUrl = gameLink.href;
                    if (!gamePageUrl.startsWith('http')) {
                        gamePageUrl = `https://online-fix.me${gameLink.getAttribute('href')}`;
                    }

                    console.log('üéÆ Game page URL:', gamePageUrl);

                    // Fetch the actual game page
                    let gameHtml = '';
                    if (window.electronAPI && window.electronAPI.fetchRemoteFile) {
                        gameHtml = await window.electronAPI.fetchRemoteFile(gamePageUrl);
                    } else {
                        console.log('‚ùå Cannot fetch game page without Electron API');
                        setOnlineFixData(null);
                        return null;
                    }

                    console.log('üìÑ Game page HTML received, length:', gameHtml.length);

                    const gameDoc = parser.parseFromString(gameHtml, 'text/html');

                    // Extract "Playing Through" (–ò–≥—Ä–∞ —á–µ—Ä–µ–∑)
                    let playingThrough = '';
                    const allText = gameDoc.body.textContent;

                    // Try multiple patterns - looking for "–ò–≥—Ä–∞ —á–µ—Ä–µ–∑:" or "–ò–≥—Ä–∞–µ–º —á–µ—Ä–µ–∑:"
                    // Match until we hit Russian text or end markers
                    const playingPatterns = [
                        /–ò–≥—Ä–∞ —á–µ—Ä–µ–∑[:\s]+([^\n]+?)(?=\.|–°—Ç—Ä–∞–Ω–∏—Ü–∞|–°–∫–∞—á–∞—Ç—å|–ö–∞–∫ –∑–∞–ø—É—Å–∫|$)/i,
                        /–ò–≥—Ä–∞–µ–º —á–µ—Ä–µ–∑[:\s]+([^\n]+?)(?=\.|–°—Ç—Ä–∞–Ω–∏—Ü–∞|–°–∫–∞—á–∞—Ç—å|–ö–∞–∫ –∑–∞–ø—É—Å–∫|$)/i,
                        /Playing through[:\s]+([^\n]+?)(?=\.|Page|Download|How to|$)/i
                    ];

                    for (const pattern of playingPatterns) {
                        const match = allText.match(pattern);
                        if (match) {
                            playingThrough = match[1].trim();
                            console.log('üìù Raw extracted text:', playingThrough);

                            // Clean up - only keep platform names (Steam, Epic Games, Microsoft, etc.)
                            // Stop at any non-platform text
                            // FIXED: Improved to capture ALL platforms including combinations
                            // First, remove any leading/trailing whitespace and normalize spaces
                            playingThrough = playingThrough.trim().replace(/\s+/g, ' ');
                            console.log('üìù After whitespace normalization:', playingThrough);

                            // Remove "–∞–∫–∫–∞—É–Ω—Ç" (account) text that sometimes appears between platforms
                            // Handle patterns like "Steam + –∞–∫–∫–∞—É–Ω—Ç Epic Game Store"
                            playingThrough = playingThrough.replace(/\s*\+\s*–∞–∫–∫–∞—É–Ω—Ç\s+/gi, ' + ');
                            playingThrough = playingThrough.replace(/–∞–∫–∫–∞—É–Ω—Ç\s+/gi, '');
                            console.log('üìù After removing –∞–∫–∫–∞—É–Ω—Ç:', playingThrough);

                            // Extract platform names - match one or more platforms with + separators
                            // IMPORTANT: Added "Epic Game Store" (singular) variant as online-fix.me uses both
                            // This regex captures: "Steam" or "Steam + Epic Games Store" or "Steam Remote Play + Microsoft Store"
                            const platformMatch = playingThrough.match(/^((?:Steam Remote Play|Steam|Epic Games Store|Epic Game Store|Epic Games|Epic|Microsoft Store|Microsoft|Xbox|PlayStation|GOG|Origin|Uplay|Battle\.net)(?:\s*\+\s*(?:Steam Remote Play|Steam|Epic Games Store|Epic Game Store|Epic Games|Epic|Microsoft Store|Microsoft|Xbox|PlayStation|GOG|Origin|Uplay|Battle\.net))*)/i);

                            if (platformMatch) {
                                playingThrough = platformMatch[1].trim();

                                // Final cleanup: normalize spaces around + signs
                                playingThrough = playingThrough.replace(/\s*\+\s*/g, ' + ');

                                // Normalize "Epic Game Store" to "Epic Games Store" for consistency
                                playingThrough = playingThrough.replace(/Epic Game Store/gi, 'Epic Games Store');
                            } else {
                                console.log('‚ö†Ô∏è Platform match failed for:', playingThrough);
                            }

                            console.log('‚úÖ Found "Playing Through":', playingThrough);
                            break;
                        }
                    }

                    // Fallback: Try to find in HTML structure directly
                    if (!playingThrough) {
                        console.log('‚ö†Ô∏è Text-based extraction failed, trying HTML structure...');

                        // Look for elements that might contain platform info
                        const possibleSelectors = [
                            '.game-info',
                            '.game-details',
                            '.full-text',
                            '.story-content',
                            '.entry-content',
                            '[class*="info"]',
                            '[class*="detail"]'
                        ];

                        for (const selector of possibleSelectors) {
                            const elements = gameDoc.querySelectorAll(selector);
                            for (const elem of elements) {
                                const text = elem.textContent;
                                const match = text.match(/(?:–ò–≥—Ä–∞ —á–µ—Ä–µ–∑|–ò–≥—Ä–∞–µ–º —á–µ—Ä–µ–∑)[:\s]+([^\n\.]+)/i);
                                if (match) {
                                    let extracted = match[1].trim();
                                    // Apply same cleanup
                                    extracted = extracted.replace(/\s+/g, ' ').replace(/\s*\+\s*–∞–∫–∫–∞—É–Ω—Ç\s+/gi, ' + ').replace(/–∞–∫–∫–∞—É–Ω—Ç\s+/gi, '');
                                    const platformMatch = extracted.match(/^((?:Steam Remote Play|Steam|Epic Games Store|Epic Game Store|Epic Games|Epic|Microsoft Store|Microsoft|Xbox|PlayStation|GOG|Origin|Uplay|Battle\.net)(?:\s*\+\s*(?:Steam Remote Play|Steam|Epic Games Store|Epic Game Store|Epic Games|Epic|Microsoft Store|Microsoft|Xbox|PlayStation|GOG|Origin|Uplay|Battle\.net))*)/i);
                                    if (platformMatch) {
                                        playingThrough = platformMatch[1].trim().replace(/\s*\+\s*/g, ' + ').replace(/Epic Game Store/gi, 'Epic Games Store');
                                        console.log('‚úÖ Found via HTML structure:', playingThrough);
                                        break;
                                    }
                                }
                            }
                            if (playingThrough) break;
                        }
                    }

                    if (!playingThrough) {
                        console.log('‚ùå "Playing Through" not found in page');
                        console.log('Sample text from page:', allText.substring(0, 500));
                    }

                    // Extract "How to Run" instructions (–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å / –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å / How to run)
                    const instructions = [];

                    // Try to find the section with multiple approaches
                    const howToPatterns = [
                        /–ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å[:\s]*/i,
                        /–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å[:\s]*/i,
                        /How to run[:\s]*/i,
                        /–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã[:\s]*/i
                    ];

                    let howToStartIndex = -1;

                    // First try to find in plain text
                    for (const pattern of howToPatterns) {
                        const match = allText.match(pattern);
                        if (match) {
                            console.log('‚úÖ Found "How to Run" header in text:', match[0]);

                            // Get text after the header - but limit it to avoid grabbing comments/code sections
                            const afterHeader = allText.substring(allText.indexOf(match[0]) + match[0].length);

                            // Find the end of the instructions section
                            // Look for common section headers that indicate end of instructions
                            // NOTE: "–í –∏–≥—Ä–µ:", "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:", "–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:" are PART of instructions, not enders
                            const sectionEnders = [
                                '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ç–µ–≤—ã—Ö —Ä–µ–∂–∏–º–∞—Ö',
                                '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:',
                                '–§–∞–π–ª—ã –¥–ª—è –∏–≥—Ä—ã',
                                '–°–∫–∞—á–∞—Ç—å',
                                '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏',
                                '–ü–æ—Ö–æ–∂–∏–µ –∏–≥—Ä—ã',
                                '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è',
                                '–í–µ—Ä—Å–∏—è –∏–≥—Ä—ã'
                            ];

                            // Find the earliest section ender
                            let endIndex = afterHeader.length;
                            for (const ender of sectionEnders) {
                                const idx = afterHeader.indexOf(ender);
                                if (idx !== -1 && idx < endIndex) {
                                    endIndex = idx;
                                }
                            }

                            // Only extract from the "How to Run" section
                            let instructionText = afterHeader.substring(0, endIndex);
                            console.log('Instruction text length:', instructionText.length);

                            // Clean up the text - remove extra whitespace but preserve structure
                            instructionText = instructionText.replace(/\s+/g, ' ').trim();

                            // IMPORTANT: Normalize numbered items - add newline before numbers to ensure proper splitting
                            // This fixes "1. Text2. Text" becoming two separate items
                            instructionText = instructionText.replace(/(\d+[\.)]\s)/g, '\n$1');

                            // Now split by newlines to get individual items
                            const lines = instructionText.split('\n').filter(l => l.trim().length > 0);

                            console.log(`Found ${lines.length} lines in instructions`);

                            // Track which sections we've seen to avoid duplicates
                            const seenSections = new Set();

                            lines.forEach((line, idx) => {
                                line = line.trim();
                                if (line.length > 5) {
                                    // Check if it's a section header (–í –∏–≥—Ä–µ:, –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:, –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:)
                                    const sectionMatch = line.match(/^(–í –∏–≥—Ä–µ|–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ|–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞)[:]/i);

                                    if (sectionMatch) {
                                        const sectionName = sectionMatch[1];

                                        // Only add if we haven't seen this section yet
                                        if (!seenSections.has(sectionName)) {
                                            seenSections.add(sectionName);
                                            instructions.push(line);
                                            console.log(`  ${instructions.length}. [Section] ${line.substring(0, 60)}...`);
                                        }
                                    } else if (/^\d+[\.)]\s/.test(line)) {
                                        // It's a numbered instruction
                                        let cleaned = line.replace(/^\d+[\.)]\s+/, '').trim();

                                        // Only keep reasonable length instructions
                                        if (cleaned.length > 10 && cleaned.length < 1000 && !cleaned.includes('function') && !cleaned.includes('DLEalert') && !cleaned.includes('{')) {
                                            instructions.push(cleaned);
                                            console.log(`  ${instructions.length}. ${cleaned.substring(0, 60)}...`);
                                        }
                                    }
                                }
                            });

                            if (instructions.length === 0) {
                                // Fallback: Split by lines
                                console.log('Falling back to line-by-line parsing');
                                const lines = afterHeader.split('\n');
                                let foundInstructions = false;

                                for (let i = 0; i < lines.length && i < 50; i++) {
                                    const line = lines[i].trim();

                                    // Match lines that start with "1.", "2.", etc. or "1)", "2)", etc.
                                    if (/^\d+[\.)]\s+.+/.test(line)) {
                                        // Remove the number prefix and clean up
                                        let cleanedLine = line.replace(/^\d+[\.)]\s+/, '').trim();

                                        // Remove everything after certain stop patterns
                                        cleanedLine = cleanedLine.split(/–í –∏–≥—Ä–µ:|–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:|–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:|–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ|–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:|–§–∞–π–ª—ã –¥–ª—è/i)[0].trim();

                                        if (cleanedLine.length > 3 && cleanedLine.length < 500) {
                                            instructions.push(cleanedLine);
                                            console.log(`  ${instructions.length}. ${cleanedLine.substring(0, 60)}...`);
                                            foundInstructions = true;
                                        }
                                    }
                                    // Stop at these section headers
                                    else if (foundInstructions && /^(–í –∏–≥—Ä–µ|–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ|–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞|–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ|–ü—Ä–∏–º–µ—á–∞–Ω–∏—è|–§–∞–π–ª—ã –¥–ª—è)/i.test(line)) {
                                        console.log('  Stopping at section:', line.substring(0, 30));
                                        break;
                                    }
                                }
                            }

                            if (instructions.length > 0) {
                                console.log(`‚úÖ Found ${instructions.length} instructions via text parsing`);
                                break;
                            }
                        }
                    }

                    // Fallback: Try HTML parsing
                    if (instructions.length === 0) {
                        console.log('Trying HTML-based extraction...');

                        for (const pattern of howToPatterns) {
                            const match = gameHtml.match(pattern);
                            if (match) {
                                howToStartIndex = match.index;
                                console.log('‚úÖ Found "How to Run" in HTML at index:', howToStartIndex);

                                const fragment = gameHtml.slice(howToStartIndex, howToStartIndex + 10000);
                                const fragmentDoc = parser.parseFromString('<div>' + fragment + '</div>', 'text/html');

                                // Try to find ordered/unordered lists
                                const lists = fragmentDoc.querySelectorAll('ol, ul');
                                console.log('Found', lists.length, 'lists in fragment');

                                if (lists.length > 0) {
                                    const firstList = lists[0];
                                    const listItems = firstList.querySelectorAll('li');
                                    console.log('Found', listItems.length, 'list items');

                                    listItems.forEach((li, idx) => {
                                        const text = li.textContent.trim();
                                        if (text && text.length > 5) {
                                            instructions.push(text);
                                            console.log(`  ${idx + 1}. ${text.substring(0, 50)}...`);
                                        }
                                    });
                                }

                                if (instructions.length > 0) {
                                    break;
                                }
                            }
                        }
                    }

                    if (instructions.length === 0) {
                        console.log('‚ùå "How to Run" instructions not found');
                    } else {
                        console.log(`‚úÖ Extracted ${instructions.length} instructions`);
                    }

                    // Extract "Files for the game" (–§–∞–π–ª—ã –¥–ª—è –∏–≥—Ä—ã)
                    const filesForGame = [];
                    const filesPatterns = [
                        /–§–∞–π–ª—ã –¥–ª—è –∏–≥—Ä—ã[:\s]*/i,
                        /Files for the game[:\s]*/i
                    ];

                    console.log('üîç Looking for "Files for the game" section...');

                    for (const pattern of filesPatterns) {
                        const match = allText.match(pattern);
                        if (match) {
                            console.log('‚úÖ Found "Files for the game" header in text:', match[0]);

                            // Get text after the header
                            const afterHeader = allText.substring(allText.indexOf(match[0]) + match[0].length);

                            // Find the end of the files section - stop at common section headers
                            const sectionEnders = [
                                '–ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å',
                                '–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å',
                                'How to run',
                                '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ç–µ–≤—ã—Ö —Ä–µ–∂–∏–º–∞—Ö',
                                '–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:',
                                '–°–∫–∞—á–∞—Ç—å',
                                '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏',
                                '–ü–æ—Ö–æ–∂–∏–µ –∏–≥—Ä—ã',
                                '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è'
                            ];

                            // Find the earliest section ender
                            let endIndex = afterHeader.length;
                            for (const ender of sectionEnders) {
                                const idx = afterHeader.indexOf(ender);
                                if (idx !== -1 && idx < endIndex) {
                                    endIndex = idx;
                                }
                            }

                            // Only extract from the "Files for the game" section
                            let filesText = afterHeader.substring(0, endIndex);
                            console.log('Files text length:', filesText.length);

                            // Clean up and normalize
                            filesText = filesText.replace(/\s+/g, ' ').trim();
                            filesText = filesText.replace(/(\d+[\.)]\s)/g, '\n$1');

                            // Split by newlines
                            const lines = filesText.split('\n').filter(l => l.trim().length > 0);
                            console.log(`Found ${lines.length} lines in files section`);

                            lines.forEach((line) => {
                                line = line.trim();
                                if (line.length > 5 && /^\d+[\.)]\s+.+/.test(line)) {
                                    // Remove the number prefix and clean up
                                    let cleanedLine = line.replace(/^\d+[\.)]\s+/, '').trim();

                                    // Only keep reasonable length items
                                    if (cleanedLine.length > 10 && cleanedLine.length < 1000 && !cleanedLine.includes('function') && !cleanedLine.includes('DLEalert')) {
                                        filesForGame.push(cleanedLine);
                                        console.log(`  ${filesForGame.length}. ${cleanedLine.substring(0, 60)}...`);
                                    }
                                }
                            });

                            if (filesForGame.length > 0) {
                                console.log(`‚úÖ Extracted ${filesForGame.length} file instructions`);
                                break;
                            }
                        }
                    }

                    if (filesForGame.length === 0) {
                        console.log('‚ùå "Files for the game" section not found');
                    }

                    const result = {
                        playingThrough: playingThrough || null,
                        instructions: instructions.length > 0 ? instructions : null,
                        filesForGame: filesForGame.length > 0 ? filesForGame : null,
                        gamePageUrl: gamePageUrl
                    };

                    console.log('üìä Final result:', {
                        hasPlayingThrough: !!result.playingThrough,
                        instructionsCount: result.instructions?.length || 0,
                        filesForGameCount: result.filesForGame?.length || 0,
                        url: result.gamePageUrl
                    });

                    setOnlineFixData(result);
                    return result;

                } catch (error) {
                    console.error('‚ùå Error fetching online-fix data:', error);
                    console.error('Error details:', error.message, error.stack);
                    setOnlineFixData(null);
                    return null;
                }
            };

            // Simple translation function for Russian to current language
            const translateRussianText = (text, toLang) => {
                if (!text || !toLang) {
                    console.log('‚ö†Ô∏è Translation called with missing params:', { text: !!text, toLang });
                    return text;
                }

                console.log('üî§ Translating:', text.substring(0, 60) + '...', 'to', toLang);

                // For simple platform names, no translation needed
                // Normalize "Epic Game Store" to "Epic Games Store" first
                text = text.replace(/Epic Game Store/gi, 'Epic Games Store');

                if (/^(Steam Remote Play|Steam|Epic Games Store|Epic Game Store|Epic Games|Microsoft Store|Microsoft|Xbox|PlayStation|GOG|Origin|Uplay|Battle\.net|\+|\s)+$/i.test(text)) {
                    return text;
                }

                // Comprehensive translation dictionary for common terms
                // IMPORTANT: Longer phrases MUST come first to avoid partial replacements causing double words
                const translations = {
                    // Platforms (keep as-is)
                    'Steam Remote Play': { en: 'Steam Remote Play', fr: 'Steam Remote Play', es: 'Steam Remote Play', zh: 'Steam Remote Play' },
                    'Steam': { en: 'Steam', fr: 'Steam', es: 'Steam', zh: 'Steam' },
                    'Epic Games Store': { en: 'Epic Games Store', fr: 'Epic Games Store', es: 'Epic Games Store', zh: 'Epic Games Store' },
                    'Epic Games': { en: 'Epic Games', fr: 'Epic Games', es: 'Epic Games', zh: 'Epic Games' },
                    'Microsoft Store': { en: 'Microsoft Store', fr: 'Microsoft Store', es: 'Microsoft Store', zh: 'Microsoft Store' },
                    'Microsoft': { en: 'Microsoft Store', fr: 'Microsoft Store', es: 'Microsoft Store', zh: 'Microsoft Store' },

                    // Multi-word phrases (MUST come before individual words to prevent double translation)
                    // Very long phrases first
                    '–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤': { en: 'You don\'t have permission', fr: 'Vous n\'avez pas la permission', es: 'No tienes permiso', zh: 'ÊÇ®Ê≤°ÊúâÊùÉÈôê' },
                    '–Ω–µ—Ç –ø—Ä–∞–≤': { en: 'no permission', fr: 'pas de permission', es: 'sin permiso', zh: 'Êó†ÊùÉÈôê' },
                    '–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞': { en: 'to view hidden text', fr: 'pour voir le texte cach√©', es: 'para ver texto oculto', zh: 'Êü•ÁúãÈöêËóèÊñáÊú¨' },
                    '—Å–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞': { en: 'hidden text', fr: 'texte cach√©', es: 'texto oculto', zh: 'ÈöêËóèÊñáÊú¨' },
                    '–∑–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ': { en: 'for free', fr: 'gratuitement', es: 'gratis', zh: 'ÂÖçË¥π' },
                    '–ü–æ–∫—É–ø–∞–µ–º –∑–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ': { en: 'Purchase for free', fr: 'Achetez gratuitement', es: 'Comprar gratis', zh: 'ÂÖçË¥πË¥≠‰π∞' },
                    '–ü–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —Ç–µ–º —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ': { en: 'Before enabling developer mode, read about what it is on the internet', fr: 'Avant d\'activer le mode d√©veloppeur, renseignez-vous sur ce que c\'est sur Internet', es: 'Antes de habilitar el modo desarrollador, inf√≥rmese sobre qu√© es en Internet', zh: 'Âú®ÂêØÁî®ÂºÄÂèëËÄÖÊ®°Âºè‰πãÂâçÔºåËØ∑Âú®‰∫íËÅîÁΩë‰∏ä‰∫ÜËß£ÂÆÉÊòØ‰ªÄ‰πà' },
                    '–≤—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –ü–ö, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è': { en: 'restart the PC if necessary', fr: 'red√©marrez le PC si n√©cessaire', es: 'reiniciar la PC si es necesario', zh: 'ÂøÖË¶ÅÊó∂ÈáçÂêØÁîµËÑë' },
                    '–ê–∫—Ç–∏–≤–∞—Ü–∏—è Epic Store Fix: (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ–¥–∏–Ω–æ–∂–¥—ã)': { en: 'Epic Store Fix Activation: (done once)', fr: 'Activation du Fix Epic Store : (fait une fois)', es: 'Activaci√≥n del Fix Epic Store: (se hace una vez)', zh: 'Epic Store‰øÆÂ§çÊøÄÊ¥ªÔºöÔºà‰ªÖ‰∏ÄÊ¨°Ôºâ' },
                    '–ö–∞–∫ –º–∏–Ω–∏–º—É–º Windows 10 x64 –≤–µ—Ä—Å–∏–∏ –Ω–µ –º–µ–Ω–µ–µ 1909 —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏': { en: 'At minimum Windows 10 x64 version 1909 or higher with installed services', fr: 'Au minimum Windows 10 x64 version 1909 ou sup√©rieure avec les services install√©s', es: 'Como m√≠nimo Windows 10 x64 versi√≥n 1909 o superior con servicios instalados', zh: 'Ëá≥Â∞ë Windows 10 x64 ÁâàÊú¨ 1909 ÊàñÊõ¥È´òÁâàÊú¨Âπ∂ÂÆâË£ÖÊúçÂä°' },
                    '–∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ —Å –∏–≥—Ä–æ–π': { en: 'which is located in the game folder', fr: 'qui se trouve dans le dossier du jeu', es: 'que se encuentra en la carpeta del juego', zh: '‰Ωç‰∫éÊ∏∏ÊàèÊñá‰ª∂Â§π‰∏≠' },
                    '–∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –ø–∞–ø–∫–µ —Å –∏–≥—Ä–æ–π': { en: 'which is located in the game folder', fr: 'qui se trouve dans le dossier du jeu', es: 'que se encuentra en la carpeta del juego', zh: '‰Ωç‰∫éÊ∏∏ÊàèÊñá‰ª∂Â§π‰∏≠' },
                    '–ü—Ä–∏–≥–ª–∞—à–∞–µ–º –¥—Ä—É–∑–µ–π –∏ –æ–∂–∏–¥–∞–µ–º –∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è': { en: 'Invite friends and wait for their connection', fr: 'Invitez des amis et attendez leur connexion', es: 'Invitar amigos y esperar su conexi√≥n', zh: 'ÈÇÄËØ∑ÊúãÂèãÂπ∂Á≠âÂæÖ‰ªñ‰ª¨ËøûÊé•' },
                    '–ù–∞–∂–∏–º–∞–µ–º –Ω–∏–∂–Ω—é—é –ø—Ä–∞–≤—É—é –∫–Ω–æ–ø–∫—É': { en: 'Press the bottom right button', fr: 'Appuyez sur le bouton en bas √† droite', es: 'Presionar el bot√≥n inferior derecho', zh: 'ÊåâÂè≥‰∏ãËßíÊåâÈíÆ' },
                    '–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∏–≥—Ä—É': { en: 'Create custom game', fr: 'Cr√©er un jeu personnalis√©', es: 'Crear juego personalizado', zh: 'ÂàõÂª∫Ëá™ÂÆö‰πâÊ∏∏Êàè' },
                    '–≤ —Å–≤–æ—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É (–Ω–µ —Å–∫–∞—á–∏–≤–∞–µ–º –µ—ë)': { en: 'to your library (don\'t download it)', fr: '√† votre biblioth√®que (ne la t√©l√©chargez pas)', es: 'a tu biblioteca (no la descargues)', zh: 'Âà∞‰Ω†ÁöÑÂ∫ìÔºà‰∏çË¶Å‰∏ãËΩΩÔºâ' },
                    '–Ω–µ —Å–∫–∞—á–∏–≤–∞–µ–º –µ—ë': { en: 'don\'t download it', fr: 'ne la t√©l√©chargez pas', es: 'no la descargues', zh: '‰∏çË¶Å‰∏ãËΩΩ' },

                    // Files for the game section phrases
                    'Free Trial & Friend\'s Pass': { en: 'Free Trial & Friend\'s Pass', fr: 'Essai Gratuit & Pass Ami', es: 'Prueba Gratuita y Pase de Amigo', zh: 'ÂÖçË¥πËØïÁî®ÂíåÂ•ΩÂèãÈÄöË°åËØÅ' },
                    'Friend\'s Pass': { en: 'Friend\'s Pass', fr: 'Pass Ami', es: 'Pase de Amigo', zh: 'Â•ΩÂèãÈÄöË°åËØÅ' },
                    'Free Trial': { en: 'Free Trial', fr: 'Essai Gratuit', es: 'Prueba Gratuita', zh: 'ÂÖçË¥πËØïÁî®' },
                    'Fix Repair': { en: 'Fix Repair', fr: 'Fix Repair', es: 'Fix Repair', zh: 'Fix Repair' },
                    '–ø–æ —Å—Å—ã–ª–∫–∞–º –Ω–∏–∂–µ –∏–∑ –ø–∞–ø–∫–∏': { en: 'from the links below from the folder', fr: 'depuis les liens ci-dessous du dossier', es: 'desde los enlaces a continuaci√≥n de la carpeta', zh: '‰ªé‰∏ãÈù¢Êñá‰ª∂Â§πÁöÑÈìæÊé•' },
                    '–∏–∑ –ø–∞–ø–∫–∏ Fix Repair': { en: 'from the Fix Repair folder', fr: 'depuis le dossier Fix Repair', es: 'desde la carpeta Fix Repair', zh: '‰ªé Fix Repair Êñá‰ª∂Â§π' },
                    '–Ω–∏–∂–µ –∏–∑ –ø–∞–ø–∫–∏': { en: 'below from the folder', fr: 'ci-dessous du dossier', es: 'a continuaci√≥n de la carpeta', zh: '‰∏ãÈù¢‰ªéÊñá‰ª∂Â§π' },
                    '—Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –µ–≥–æ –≤ –ø–∞–ø–∫—É —Å –∏–≥—Ä–æ–π': { en: 'extract it to the game folder', fr: 'extraire dans le dossier du jeu', es: 'extraerlo a la carpeta del juego', zh: 'Ëß£ÂéãÂà∞Ê∏∏ÊàèÊñá‰ª∂Â§π' },
                    '–≤ –ø–∞–ø–∫—É —Å –∏–≥—Ä–æ–π': { en: 'to the game folder', fr: 'dans le dossier du jeu', es: 'a la carpeta del juego', zh: 'Âà∞Ê∏∏ÊàèÊñá‰ª∂Â§π' },
                    '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–∞': { en: 'invitation from a friend', fr: 'invitation d\'un ami', es: 'invitaci√≥n de un amigo', zh: 'Êù•Ëá™ÊúãÂèãÁöÑÈÇÄËØ∑' },
                    '–ü—Ä–∏–Ω–∏–º–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–∞': { en: 'Accept invitation from a friend', fr: 'Accepter l\'invitation d\'un ami', es: 'Aceptar invitaci√≥n de un amigo', zh: 'Êé•ÂèóÊù•Ëá™ÊúãÂèãÁöÑÈÇÄËØ∑' },
                    '–∑–∞—Ö–æ–¥–∏–º –≤ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å': { en: 'go to your profile', fr: 'allons √† votre profil', es: 'ir a tu perfil', zh: 'ÂâçÂæÄ‰Ω†ÁöÑ‰∏™‰∫∫ËµÑÊñô' },
                    '–≤ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å': { en: 'to your profile', fr: '√† votre profil', es: 'a tu perfil', zh: 'Âà∞‰Ω†ÁöÑ‰∏™‰∫∫ËµÑÊñô' },
                    '–≤ –ª—é–±—É—é –ø–∞–ø–∫—É': { en: 'to any folder', fr: 'dans n\'importe quel dossier', es: 'a cualquier carpeta', zh: 'Âà∞‰ªªÊÑèÊñá‰ª∂Â§π' },
                    '–æ–∂–∏–¥–∞–µ–º –∏—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è': { en: 'wait for their connection', fr: 'attendons leur connexion', es: 'esperar su conexi√≥n', zh: 'Á≠âÂæÖ‰ªñ‰ª¨ËøûÊé•' },
                    '–≤ –æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è –æ–∫–Ω–µ –±—Ä–∞—É–∑–µ—Ä–∞': { en: 'in the opened browser window', fr: 'dans la fen√™tre du navigateur ouverte', es: 'en la ventana del navegador abierta', zh: 'Âú®ÊâìÂºÄÁöÑÊµèËßàÂô®Á™óÂè£‰∏≠' },
                    '–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø': { en: 'grant access', fr: 'accordons l\'acc√®s', es: 'otorgar acceso', zh: 'Êéà‰∫àËÆøÈóÆÊùÉÈôê' },
                    '–∫ –ª—é–±–æ–º—É —Å–µ—Ä–≤–µ—Ä—É': { en: 'to any server', fr: '√† n\'importe quel serveur', es: 'a cualquier servidor', zh: 'Âà∞‰ªªÊÑèÊúçÂä°Âô®' },
                    '–≤ –ø–∞–ø–∫–µ —Å –∏–≥—Ä–æ–π': { en: 'in the game folder', fr: 'dans le dossier du jeu', es: 'en la carpeta del juego', zh: 'Âú®Ê∏∏ÊàèÊñá‰ª∂Â§π‰∏≠' },
                    '–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫': { en: 'Connect to', fr: 'Connectons-nous √†', es: 'Conectar a', zh: 'ËøûÊé•Âà∞' },

                    // Verbs
                    '–ó–∞–ø—É—Å–∫–∞–µ–º': { en: 'Launch', fr: 'Lan√ßons', es: 'Iniciar', zh: 'ÂêØÂä®' },
                    '–ó–∞–ø—É—Å—Ç–∏—Ç–µ': { en: 'Launch', fr: 'Lancez', es: 'Iniciar', zh: 'ÂêØÂä®' },
                    '–ó–∞–ø—É—Å—Ç–∏—Ç—å': { en: 'Launch', fr: 'Lancer', es: 'Iniciar', zh: 'ÂêØÂä®' },
                    '–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ': { en: 'Install', fr: 'Installez', es: 'Instalar', zh: 'ÂÆâË£Ö' },
                    '–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º': { en: 'Install', fr: 'Installons', es: 'Instalar', zh: 'ÂÆâË£Ö' },
                    '–í–æ–π–¥–∏—Ç–µ': { en: 'Log in to', fr: 'Connectez-vous √†', es: 'Iniciar sesi√≥n en', zh: 'ÁôªÂΩïÂà∞' },
                    '–ó–∞—Ö–æ–¥–∏–º': { en: 'Go to', fr: 'Allons √†', es: 'Ir a', zh: 'ÂâçÂæÄ' },
                    '–∑–∞—Ö–æ–¥–∏–º': { en: 'go to', fr: 'allons √†', es: 'ir a', zh: 'ÂâçÂæÄ' },
                    '–ü—Ä–∏–Ω–∏–º–∞–µ–º': { en: 'Accept', fr: 'Acceptons', es: 'Aceptar', zh: 'Êé•Âèó' },
                    '–°–æ–∑–¥–∞–Ω–∏–µ': { en: 'Creating', fr: 'Cr√©ation', es: 'Creando', zh: 'ÂàõÂª∫‰∏≠' },
                    '–°–æ–∑–¥–∞—Ç—å': { en: 'Create', fr: 'Cr√©er', es: 'Crear', zh: 'ÂàõÂª∫' },
                    '–ü—Ä–∏–≥–ª–∞—à–∞–µ–º': { en: 'Invite', fr: 'Invitons', es: 'Invitar', zh: 'ÈÇÄËØ∑' },
                    '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å': { en: 'Invite', fr: 'Inviter', es: 'Invitar', zh: 'ÈÇÄËØ∑' },
                    '–æ–∂–∏–¥–∞–µ–º': { en: 'wait for', fr: 'attendons', es: 'esperar', zh: 'Á≠âÂæÖ' },
                    '–°–∫–∞—á–∏–≤–∞–µ–º': { en: 'Download', fr: 'T√©l√©chargeons', es: 'Descargar', zh: '‰∏ãËΩΩ' },
                    '–°–∫–∞—á–∞—Ç—å': { en: 'Download', fr: 'T√©l√©charger', es: 'Descargar', zh: '‰∏ãËΩΩ' },
                    '–ü–æ–∫—É–ø–∞–µ–º': { en: 'Purchase', fr: 'Achetons', es: 'Comprar', zh: 'Ë¥≠‰π∞' },
                    '—Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º': { en: 'extract', fr: 'extrayons', es: 'extraer', zh: 'Ëß£Âéã' },
                    '–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è': { en: 'Connect', fr: 'Connectons-nous', es: 'Conectar', zh: 'ËøûÊé•' },
                    '–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º': { en: 'Activate', fr: 'Activons', es: 'Activar', zh: 'ÊøÄÊ¥ª' },
                    '–ß–∏—Ç–∞–µ–º': { en: 'Read', fr: 'Lisons', es: 'Leer', zh: 'ÈòÖËØª' },
                    '–í–∫–ª—é—á–∞–µ–º': { en: 'Enable', fr: 'Activons', es: 'Habilitar', zh: 'ÂêØÁî®' },
                    '–í—ã–∫–ª—é—á–∞–µ–º': { en: 'Disable', fr: 'D√©sactivons', es: 'Deshabilitar', zh: 'Á¶ÅÁî®' },
                    '–ù–∞–∂–∏–º–∞–µ–º': { en: 'Press', fr: 'Appuyons', es: 'Presionar', zh: 'Êåâ' },
                    '–ü—Ä–æ—Ö–æ–¥–∏–º': { en: 'Complete', fr: 'Compl√©tons', es: 'Completar', zh: 'ÂÆåÊàê' },
                    '–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º': { en: 'grant', fr: 'accordons', es: 'otorgar', zh: 'Êéà‰∫à' },
                    '—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω': { en: 'located', fr: 'situ√©', es: 'ubicado', zh: '‰Ωç‰∫é' },
                    '–Ω–∞—Ö–æ–¥–∏—Ç—Å—è': { en: 'is located', fr: 'se trouve', es: 'est√° ubicado', zh: '‰Ωç‰∫é' },
                    '–æ—Ç–∫—Ä—ã–≤—à–µ–º—Å—è': { en: 'opened', fr: 'ouvert', es: 'abierto', zh: 'ÊâìÂºÄÁöÑ' },
                    '–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è': { en: 'is done', fr: 'est fait', es: 'se realiza', zh: 'ÂÆåÊàê' },
                    '–≤—ã–ø–æ–ª–Ω—è–µ–º': { en: 'perform', fr: 'effectuons', es: 'realizar', zh: 'ÊâßË°å' },
                    '–ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è': { en: 'needed', fr: 'n√©cessaire', es: 'necesario', zh: 'ÈúÄË¶Å' },
                    '–ó–∞–≥—Ä—É–∂–∞–µ–º': { en: 'Load', fr: 'Chargeons', es: 'Cargar', zh: 'Âä†ËΩΩ' },

                    // Nouns
                    '–í–Ω–∏–º–∞–Ω–∏–µ!': { en: 'Attention!', fr: 'Attention !', es: '¬°Atenci√≥n!', zh: 'Ê≥®ÊÑèÔºÅ' },
                    '–í–Ω–∏–º–∞–Ω–∏–µ': { en: 'Attention', fr: 'Attention', es: 'Atenci√≥n', zh: 'Ê≥®ÊÑè' },
                    '–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å': { en: 'register', fr: 'inscrivez-vous', es: 'registrarse', zh: 'Ê≥®ÂÜå' },
                    '–ø—Ä–æ—Å–º–æ—Ç—Ä–∞': { en: 'viewing', fr: 'visualisation', es: 'visualizaci√≥n', zh: 'Êü•Áúã' },
                    '—Å–∫—Ä—ã—Ç–æ–≥–æ': { en: 'hidden', fr: 'cach√©', es: 'oculto', zh: 'ÈöêËóèÁöÑ' },
                    '—Ç–µ–∫—Å—Ç–∞': { en: 'text', fr: 'texte', es: 'texto', zh: 'ÊñáÊú¨' },
                    '–ø—Ä–∞–≤–∞': { en: 'permission', fr: 'permission', es: 'permiso', zh: 'ÊùÉÈôê' },
                    '–ø—Ä–∞–≤': { en: 'permission', fr: 'permission', es: 'permiso', zh: 'ÊùÉÈôê' },
                    '–≤–∞—Å': { en: 'you', fr: 'vous', es: 'usted', zh: 'ÊÇ®' },
                    '–Ω–µ—Ç': { en: 'no', fr: 'non', es: 'no', zh: 'Ê≤°Êúâ' },
                    '–±–µ—Å–ø–ª–∞—Ç–Ω–æ': { en: 'free', fr: 'gratuit', es: 'gratis', zh: 'ÂÖçË¥π' },
                    '–∏–≥—Ä—É': { en: 'the game', fr: 'le jeu', es: 'el juego', zh: 'Ê∏∏Êàè' },
                    '–∏–≥—Ä—ã': { en: 'game', fr: 'jeu', es: 'juego', zh: 'Ê∏∏Êàè' },
                    '–∏–≥—Ä–æ–π': { en: 'game', fr: 'jeu', es: 'juego', zh: 'Ê∏∏Êàè' },
                    'game': { en: 'game', fr: 'jeu', es: 'juego', zh: 'Ê∏∏Êàè' },
                    'via': { en: 'via', fr: 'via', es: 'v√≠a', zh: 'ÈÄöËøá' },
                    '—á–µ—Ä–µ–∑': { en: 'through', fr: 'via', es: 'a trav√©s de', zh: 'ÈÄöËøá' },
                    '–∑–∞': { en: 'for', fr: 'pour', es: 'por', zh: '‰∏∫‰∫Ü' },
                    '–ø—Ä–æ—Ñ–∏–ª—å': { en: 'profile', fr: 'profil', es: 'perfil', zh: '‰∏™‰∫∫ËµÑÊñô' },
                    '–∞–∫–∫–∞—É–Ω—Ç': { en: 'account', fr: 'compte', es: 'cuenta', zh: 'Ë¥¶Êà∑' },
                    '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ': { en: 'invitation', fr: 'invitation', es: 'invitaci√≥n', zh: 'ÈÇÄËØ∑' },
                    '–¥—Ä—É–≥–∞': { en: 'friend', fr: 'ami', es: 'amigo', zh: 'ÊúãÂèã' },
                    '–¥—Ä—É–∑–µ–π': { en: 'friends', fr: 'amis', es: 'amigos', zh: 'ÊúãÂèã‰ª¨' },
                    '–¥—Ä—É–≥–∏–µ': { en: 'other', fr: 'autres', es: 'otros', zh: 'ÂÖ∂‰ªñ' },
                    '—Å–µ—Ä–≤–µ—Ä–∞': { en: 'server', fr: 'serveur', es: 'servidor', zh: 'ÊúçÂä°Âô®' },
                    '—Å–µ—Ä–≤–µ—Ä—É': { en: 'server', fr: 'serveur', es: 'servidor', zh: 'ÊúçÂä°Âô®' },
                    '–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è': { en: 'connection', fr: 'connexion', es: 'conexi√≥n', zh: 'ËøûÊé•' },
                    '–ø–∞–ø–∫—É': { en: 'folder', fr: 'dossier', es: 'carpeta', zh: 'Êñá‰ª∂Â§π' },
                    '–ø–∞–ø–∫–µ': { en: 'folder', fr: 'dossier', es: 'carpeta', zh: 'Êñá‰ª∂Â§π' },
                    '—Ñ–∞–π–ª—ã': { en: 'files', fr: 'fichiers', es: 'archivos', zh: 'Êñá‰ª∂' },
                    '—Ñ–∏–∫—Å': { en: 'fix', fr: 'fix', es: 'fix', zh: '‰øÆÂ§ç' },
                    '—Å—Å—ã–ª–∫–∞–º': { en: 'links', fr: 'liens', es: 'enlaces', zh: 'ÈìæÊé•' },
                    '–Ω–∏–∂–µ': { en: 'below', fr: 'ci-dessous', es: 'a continuaci√≥n', zh: '‰∏ãÈù¢' },
                    '–µ–≥–æ': { en: 'it', fr: 'le', es: 'lo', zh: 'ÂÆÉ' },
                    '–µ—ë': { en: 'it', fr: 'la', es: 'la', zh: 'ÂÆÉ' },
                    '–∏—Ö': { en: 'their', fr: 'leur', es: 'su', zh: '‰ªñ‰ª¨ÁöÑ' },
                    '–µ–≥–æ': { en: 'his/its', fr: 'son', es: 'su', zh: '‰ªñÁöÑ/ÂÆÉÁöÑ' },
                    '–±—Ä–∞—É–∑–µ—Ä–∞': { en: 'browser', fr: 'navigateur', es: 'navegador', zh: 'ÊµèËßàÂô®' },
                    '–æ–∫–Ω–µ': { en: 'window', fr: 'fen√™tre', es: 'ventana', zh: 'Á™óÂè£' },
                    '–∫–Ω–æ–ø–∫—É': { en: 'button', fr: 'bouton', es: 'bot√≥n', zh: 'ÊåâÈíÆ' },
                    '–¥–æ—Å—Ç—É–ø': { en: 'access', fr: 'acc√®s', es: 'acceso', zh: 'ËÆøÈóÆ' },
                    '–∫–æ—Ç–æ—Ä—ã–π': { en: 'which', fr: 'qui', es: 'que', zh: 'Âì™‰∏™' },
                    '–∏–≥—Ä–æ–∫–æ–≤': { en: 'players', fr: 'joueurs', es: 'jugadores', zh: 'Áé©ÂÆ∂' },
                    '–æ–±—É—á–µ–Ω–∏–µ': { en: 'tutorial', fr: 'tutoriel', es: 'tutorial', zh: 'ÊïôÁ®ã' },
                    '—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ': { en: 'save', fr: 'sauvegarde', es: 'guardar', zh: '‰øùÂ≠ò' },
                    '—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è': { en: 'requirements', fr: 'exigences', es: 'requisitos', zh: 'Ë¶ÅÊ±Ç' },
                    '—Å–∏—Å—Ç–µ–º–µ': { en: 'system', fr: 'syst√®me', es: 'sistema', zh: 'Á≥ªÁªü' },
                    '–≤–µ—Ä—Å–∏–∏': { en: 'version', fr: 'version', es: 'versi√≥n', zh: 'ÁâàÊú¨' },
                    '—Å–µ—Ä–≤–∏—Å–∞–º–∏': { en: 'services', fr: 'services', es: 'servicios', zh: 'ÊúçÂä°' },
                    '—Ä–µ–∂–∏–º–∞': { en: 'mode', fr: 'mode', es: 'modo', zh: 'Ê®°Âºè' },
                    '—Ä–µ–∂–∏–º': { en: 'mode', fr: 'mode', es: 'modo', zh: 'Ê®°Âºè' },
                    '—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞': { en: 'developer', fr: 'd√©veloppeur', es: 'desarrollador', zh: 'ÂºÄÂèëËÄÖ' },
                    '–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É': { en: 'restart', fr: 'red√©marrage', es: 'reiniciar', zh: 'ÈáçÂêØ' },
                    '–º–µ–Ω—é': { en: 'menu', fr: 'menu', es: 'men√∫', zh: 'ËèúÂçï' },
                    '–ø—É—Å–∫': { en: 'start menu', fr: 'menu d√©marrer', es: 'men√∫ inicio', zh: 'ÂºÄÂßãËèúÂçï' },
                    '–Ω–∏–∂–Ω—é—é': { en: 'bottom', fr: 'bas', es: 'inferior', zh: 'Â∫ïÈÉ®' },
                    '–ø—Ä–∞–≤—É—é': { en: 'right', fr: 'droite', es: 'derecha', zh: 'Âè≥‰æß' },
                    '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é': { en: 'custom', fr: 'personnalis√©', es: 'personalizado', zh: 'Ëá™ÂÆö‰πâ' },
                    '–µ–¥–∏–Ω–æ–∂–¥—ã': { en: 'once', fr: 'une fois', es: 'una vez', zh: '‰∏ÄÊ¨°' },
                    '–±–∏–±–ª–∏–æ—Ç–µ–∫—É': { en: 'library', fr: 'biblioth√®que', es: 'biblioteca', zh: 'Â∫ì' },
                    '–º–æ—ë': { en: 'my', fr: 'mon', es: 'mi', zh: 'ÊàëÁöÑ' },
                    '—Å–≤–æ—ë': { en: 'your', fr: 'votre', es: 'tu', zh: '‰Ω†ÁöÑ' },
                    '—Å–≤–æ–π': { en: 'your', fr: 'votre', es: 'tu', zh: '‰Ω†ÁöÑ' },
                    '—Å–≤–æ—é': { en: 'your', fr: 'votre', es: 'tu', zh: '‰Ω†ÁöÑ' },

                    // Prepositions & conjunctions
                    '—á–µ—Ä–µ–∑': { en: 'via', fr: 'via', es: 'v√≠a', zh: 'ÈÄöËøá' },
                    '–æ—Ç': { en: 'from', fr: 'de', es: 'de', zh: '‰ªé' },
                    '–∏': { en: 'and', fr: 'et', es: 'y', zh: 'Âíå' },
                    '–∏–ª–∏': { en: 'or', fr: 'ou', es: 'o', zh: 'Êàñ' },
                    '–¥–ª—è': { en: 'for', fr: 'pour', es: 'para', zh: '‰∏∫‰∫Ü' },
                    '–Ω–∞': { en: 'on', fr: 'sur', es: 'en', zh: 'Âú®' },
                    '–≤': { en: 'in', fr: 'dans', es: 'en', zh: 'Âú®' },
                    '–∫': { en: 'to', fr: '√†', es: 'a', zh: 'Âà∞' },
                    '—Å': { en: 'with', fr: 'avec', es: 'con', zh: '‰∏é' },
                    '–ø–æ': { en: 'via/by', fr: 'par', es: 'por', zh: 'ÈÄöËøá' },
                    '–∏–∑': { en: 'from', fr: 'de', es: 'de', zh: '‰ªé' },
                    '–Ω–µ': { en: 'not', fr: 'ne pas', es: 'no', zh: '‰∏ç' },
                    '–µ—Å–ª–∏': { en: 'if', fr: 'si', es: 'si', zh: 'Â¶ÇÊûú' },
                    '—ç—Ç–æ': { en: 'this', fr: 'ceci', es: 'esto', zh: 'Ëøô‰∏™' },
                    '—á—Ç–æ': { en: 'that/what', fr: 'que/quoi', es: 'que/qu√©', zh: 'ÈÇ£/‰ªÄ‰πà' },
                    '–º–µ–Ω–µ–µ': { en: 'less', fr: 'moins', es: 'menos', zh: 'Â∞ë‰∫é' },
                    '–±–æ–ª–µ–µ': { en: 'more', fr: 'plus', es: 'm√°s', zh: 'Êõ¥Â§ö' },
                    '–º–∏–Ω–∏–º—É–º': { en: 'minimum', fr: 'minimum', es: 'm√≠nimo', zh: 'ÊúÄÂ∞è' },
                    '–Ω–µ–º—É': { en: 'it', fr: 'lui', es: 'ello', zh: 'ÂÆÉ' },
                    '—Ç–µ–º': { en: 'that', fr: 'cela', es: 'eso', zh: 'ÈÇ£' },
                    '—Ç–∞–∫–æ–µ': { en: 'such', fr: 'tel', es: 'tal', zh: 'ËøôÊ†∑ÁöÑ' },
                    '–∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ': { en: 'internet', fr: 'internet', es: 'internet', zh: '‰∫íËÅîÁΩë' },

                    // Common words
                    '—Å–≤–æ–π': { en: 'your', fr: 'votre', es: 'tu', zh: '‰Ω†ÁöÑ' },
                    '–∏—Ö': { en: 'their', fr: 'leur', es: 'su', zh: '‰ªñ‰ª¨ÁöÑ' },
                    '–ª—é–±—É—é': { en: 'any', fr: 'n\'importe quel', es: 'cualquier', zh: '‰ªªÊÑè' },
                    '–æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å': { en: 'familiarize yourself', fr: 'familiarisez-vous', es: 'familiar√≠cese', zh: 'ÁÜüÊÇâ' },
                    '—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏': { en: 'installed', fr: 'install√©s', es: 'instalados', zh: 'Â∑≤ÂÆâË£ÖÁöÑ' },

                    // Section headers (important - must be before individual words)
                    '–ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å:': { en: 'How to run:', fr: 'Comment ex√©cuter :', es: 'C√≥mo ejecutar:', zh: 'Â¶Ç‰ΩïËøêË°åÔºö' },
                    '–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å:': { en: 'How to launch:', fr: 'Comment lancer :', es: 'C√≥mo iniciar:', zh: 'Â¶Ç‰ΩïÂêØÂä®Ôºö' },
                    '–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ:': { en: 'System requirements:', fr: 'Configuration requise :', es: 'Requisitos del sistema:', zh: 'Á≥ªÁªüË¶ÅÊ±ÇÔºö' },
                    '–ê–∫—Ç–∏–≤–∞—Ü–∏—è Epic Store Fix: (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –µ–¥–∏–Ω–æ–∂–¥—ã)': { en: 'Epic Store Fix Activation: (done once)', fr: 'Activation du Fix Epic Store : (fait une fois)', es: 'Activaci√≥n del Fix Epic Store: (se hace una vez)', zh: 'Epic Store‰øÆÂ§çÊøÄÊ¥ªÔºöÔºà‰ªÖ‰∏ÄÊ¨°Ôºâ' },
                    '–ê–∫—Ç–∏–≤–∞—Ü–∏—è Epic Store Fix:': { en: 'Epic Store Fix Activation:', fr: 'Activation du Fix Epic Store :', es: 'Activaci√≥n del Fix Epic Store:', zh: 'Epic Store‰øÆÂ§çÊøÄÊ¥ªÔºö' },
                    '–û–Ω–ª–∞–π–Ω –∏ –°—Ö–≤–∞—Ç–∫–∞': { en: 'Online and Skirmish', fr: 'En ligne et Escarmouche', es: 'En l√≠nea y Escaramuza', zh: 'Âú®Á∫øÂíåÈÅ≠ÈÅáÊàò' },

                    // Game-specific
                    '–í –∏–≥—Ä–µ:': { en: 'In-game:', fr: 'Dans le jeu :', es: 'En el juego:', zh: 'Ê∏∏Êàè‰∏≠Ôºö' },
                    '–í –∏–≥—Ä–µ': { en: 'In-game', fr: 'Dans le jeu', es: 'En el juego', zh: 'Ê∏∏Êàè‰∏≠' },
                    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:': { en: 'Connection:', fr: 'Connexion :', es: 'Conexi√≥n:', zh: 'ËøûÊé•Ôºö' },
                    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ': { en: 'Connection', fr: 'Connexion', es: 'Conexi√≥n', zh: 'ËøûÊé•' },
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:': { en: 'Creating server:', fr: 'Cr√©ation de serveur :', es: 'Creando servidor:', zh: 'ÂàõÂª∫ÊúçÂä°Âô®Ôºö' },
                    '–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞': { en: 'Creating server', fr: 'Cr√©ation de serveur', es: 'Creando servidor', zh: 'ÂàõÂª∫ÊúçÂä°Âô®' },
                    '–ü—Ä–æ—Ö–æ–¥–∏–º –æ–±—É—á–µ–Ω–∏–µ': { en: 'Complete tutorial', fr: 'Compl√©tez le tutoriel', es: 'Completar tutorial', zh: 'ÂÆåÊàêÊïôÁ®ã' },
                    '–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä': { en: 'Multiplayer', fr: 'Multijoueur', es: 'Multijugador', zh: 'Â§ö‰∫∫Ê∏∏Êàè' },
                    '–°—Ö–≤–∞—Ç–∫–∞': { en: 'Skirmish', fr: 'Escarmouche', es: 'Escaramuza', zh: 'ÈÅ≠ÈÅáÊàò' }
                };

                let translated = text;

                // Sort by length (longest first) to avoid partial replacements
                const sortedEntries = Object.entries(translations).sort((a, b) => b[0].length - a[0].length);

                let replacements = 0;
                for (const [rus, trans] of sortedEntries) {
                    // Skip single-letter translations to avoid garbling
                    if (rus.length === 1) {
                        continue;
                    }

                    // Escape special regex characters
                    const escapedRus = rus.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    const regex = new RegExp(escapedRus, 'gi');

                    const before = translated;
                    translated = translated.replace(regex, trans[toLang] || rus);

                    if (before !== translated) {
                        replacements++;
                        console.log(`  ‚úì Replaced "${rus}" with "${trans[toLang]}"`);
                    }
                }

                console.log(`‚úÖ Translation complete: ${replacements} replacements made`);
                console.log('   Result:', translated.substring(0, 80) + '...');
                return translated;
            };

            const handleGameClick = (game) => {
                setSelectedGame(game);
                setCurrentView('game');
                setCoopData(null);
                setOnlineFixData(null);
                fetchSteamData(game.appID);
                setVideoPlaying(false);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const toggleFavorite = (appID) => {
                setFavorites(prev => 
                    prev.includes(appID) 
                        ? prev.filter(id => id !== appID)
                        : [...prev, appID]
                );
            };

            const handleDownload = async (game) => {
                // Create a clean filename from game name
                const gameName = game.name && !game.name.startsWith('Game ') ? game.name : `Game_${game.appID}`;
                const cleanFileName = gameName
                    .replace(/[^a-zA-Z0-9\s-]/g, '')
                    .replace(/\s+/g, '_')
                    .substring(0, 100); // Limit filename length
                const downloadFileName = `${cleanFileName}.zip`;

                const downloadUrl = game.downloadUrl;

                try {
                    // Check if file exists
                    const headResponse = await fetch(downloadUrl, { method: 'HEAD' });

                    if (!headResponse.ok) {
                        // File doesn't exist
                        alert(`Fix file not available yet for ${game.name}.\n\nYou can search for fixes on Co-Optimus or online-fix.me`);
                        window.open(`https://www.google.com/search?q=${encodeURIComponent(game.name + ' online fix')}`, '_blank');
                        return;
                    }

                    // Check if Electron API is available for automatic extraction
                    if (window.electronAPI && window.electronAPI.selectFolder && window.electronAPI.downloadAndExtractFix) {
                        // Show notification
                        addNotification(`Preparing to download ${game.name}...`, 'info');

                        // Ask user to select folder
                        const selectedFolder = await window.electronAPI.selectFolder();

                        if (!selectedFolder) {
                            console.log('User canceled folder selection');
                            return;
                        }

                        console.log('Selected folder:', selectedFolder);
                        addNotification(`Downloading and extracting ${game.name}...`, 'info');

                        // Download and extract
                        const result = await window.electronAPI.downloadAndExtractFix(
                            downloadUrl,
                            selectedFolder,
                            game.appID,
                            downloadFileName
                        );

                        if (result.success) {
                            // Add to download history
                            const downloadEntry = {
                                appID: game.appID,
                                name: game.name,
                                timestamp: Date.now()
                            };
                            setDownloadHistory(prev => {
                                const filtered = prev.filter(d => d.appID !== game.appID);
                                return [downloadEntry, ...filtered].slice(0, 50);
                            });

                            addNotification(`Successfully extracted ${game.name} to ${selectedFolder}`, 'success');
                        } else {
                            throw new Error(result.error || 'Unknown error during extraction');
                        }
                    } else {
                        // Fallback to regular download (browser mode)
                        addNotification(`Downloading ${game.name}...`, 'info');

                        const response = await fetch(downloadUrl);
                        const blob = await response.blob();

                        const blobUrl = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = blobUrl;
                        link.download = downloadFileName;
                        link.style.display = 'none';
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);

                        setTimeout(() => URL.revokeObjectURL(blobUrl), 100);

                        const downloadEntry = {
                            appID: game.appID,
                            name: game.name,
                            timestamp: Date.now()
                        };
                        setDownloadHistory(prev => {
                            const filtered = prev.filter(d => d.appID !== game.appID);
                            return [downloadEntry, ...filtered].slice(0, 50);
                        });

                        addNotification(`Downloaded ${game.name}`, 'success');
                    }
                } catch (error) {
                    console.error('Download error:', error);
                    alert(`Unable to download fix for ${game.name}.\n\nError: ${error.message}\n\nPlease check your internet connection or search for fixes manually.`);
                }
            };

            const removeFromDownloads = (appID) => {
                setDownloadHistory(prev => prev.filter(d => d.appID !== appID));
            };

            // FIX #3: Modified to allow removing ratings by clicking the same star
            const setGameRating = (appID, rating) => {
                setRatings(prev => {
                    // If clicking the same rating, remove it
                    if (prev[appID] === rating) {
                        const newRatings = { ...prev };
                        delete newRatings[appID];
                        return newRatings;
                    }
                    // Otherwise set the new rating
                    return {
                        ...prev,
                        [appID]: rating
                    };
                });
            };

            const stripHtml = (html) => {
                const tmp = document.createElement('div');
                tmp.innerHTML = html;
                return tmp.textContent || tmp.innerText || '';
            };

            // Debug: Show filter state
            if (advancedFilters.playerCount) {
                console.log('üîç Player Count Filter Active:', advancedFilters.playerCount);
                console.log('üìä Total games before filter:', games.length);
                console.log('üìã Sample game coopData:', games[0]?.name, games[0]?.coopData?.maxPlayers);
            }

            const filteredGames = games.filter(game => {
                const matchesSearch = game.appID.includes(searchQuery) || game.name.toLowerCase().includes(searchQuery.toLowerCase());

                // Multi-select tag filtering (AND logic - game must have ALL selected tags)
                const matchesTag = selectedTags.length === 0 ||
                    (game.tags && selectedTags.every(selectedTag =>
                        game.tags.some(tag => tag.name === selectedTag)
                    ));

                // Multi-select genre filtering (AND logic - game must have ALL selected genres)
                const matchesGenre = selectedGenres.length === 0 ||
                    (game.genres && selectedGenres.every(selectedGenre =>
                        game.genres.some(genre => genre.description === selectedGenre)
                    ));

                // Legacy single-select support
                const matchesSingleTag = !selectedTag || (game.tags && game.tags.some(tag => tag.name === selectedTag));
                const matchesSingleGenre = !selectedGenre || (game.genres && game.genres.some(genre => genre.description === selectedGenre));

                if (selectedTag === 'FAVORITES_FILTER') {
                    return favorites.includes(game.appID) && matchesSearch;
                }
                if (selectedTag === 'DOWNLOADED_FILTER') {
                    return downloadHistory.some(d => d.appID === game.appID) && matchesSearch;
                }

                // NEW: Filter for newly added games
                if (selectedTag === 'NEW_GAMES_FILTER') {
                    // Show the last N games where N = newGamesCount
                    const gameIndex = games.indexOf(game);
                    return gameIndex >= (games.length - newGamesCount) && matchesSearch;
                }

                // Advanced filter: Rating
                const gameRating = ratings[game.appID] || 0;
                const matchesRating = gameRating >= advancedFilters.minRating && gameRating <= advancedFilters.maxRating;
                
                // Advanced filter: Player count
                let matchesPlayerCount = true;
                if (advancedFilters.playerCount) {
                    if (game.coopData && game.coopData.maxPlayers) {
                        const maxPlayers = parseInt(game.coopData.maxPlayers);
                        const requestedPlayers = parseInt(advancedFilters.playerCount);

                        if (requestedPlayers === 6) {
                            // For 6+, show games with 6 or more players
                            matchesPlayerCount = maxPlayers >= 6;
                        } else {
                            // For 2 and 4 players, show ONLY exact matches
                            matchesPlayerCount = maxPlayers === requestedPlayers;
                        }
                    } else {
                        // No co-op data or maxPlayers = doesn't match
                        matchesPlayerCount = false;
                    }
                }
                
                // Advanced filter: Co-Op Campaign
                let matchesCampaign = true;
                if (advancedFilters.hasCoopCampaign) {
                    matchesCampaign = game.coopData?.coopCampaign === true;
                }
                
                // Advanced filter: Has Online Co-Op (not "only")
                let matchesOnline = true;
                if (advancedFilters.onlineOnly) {
                    matchesOnline = game.coopData?.onlineCoop === true;
                }
                
                // Advanced filter: Has Local Co-Op (includes split-screen from Steam)
                let matchesLocal = true;
                if (advancedFilters.localOnly) {
                    matchesLocal = game.coopData?.localCoop === true || game.hasSplitScreen === true;
                }
                
                return matchesSearch && matchesTag && matchesGenre && matchesRating && matchesPlayerCount && matchesCampaign && matchesOnline && matchesLocal;
            });

            const totalPages = Math.ceil(filteredGames.length / GAMES_PER_PAGE);
            
            // Sort games based on selection
            const sortedGames = [...filteredGames].sort((a, b) => {
                switch(sortBy) {
                    case 'name-asc':
                        return a.name.localeCompare(b.name);
                    case 'name-desc':
                        return b.name.localeCompare(a.name);
                    case 'rating-high':
                        return (ratings[b.appID] || 0) - (ratings[a.appID] || 0);
                    case 'rating-low':
                        return (ratings[a.appID] || 0) - (ratings[b.appID] || 0);
                    case 'recent-download':
                        const aDownload = downloadHistory.find(d => d.appID === a.appID);
                        const bDownload = downloadHistory.find(d => d.appID === b.appID);
                        if (!aDownload && !bDownload) return 0;
                        if (!aDownload) return 1;
                        if (!bDownload) return -1;
                        return bDownload.timestamp - aDownload.timestamp;
                    case 'appid-asc':
                        return parseInt(a.appID) - parseInt(b.appID);
                    case 'appid-desc':
                        return parseInt(b.appID) - parseInt(a.appID);
                    case 'favorited':
                        const aFav = favorites.includes(a.appID) ? 1 : 0;
                        const bFav = favorites.includes(b.appID) ? 1 : 0;
                        return bFav - aFav;
                    default:
                        return 0;
                }
            });
            
            const startIdx = (currentPage - 1) * GAMES_PER_PAGE;
            const currentGames = sortedGames.slice(startIdx, startIdx + GAMES_PER_PAGE);

            useEffect(() => {
                setCurrentPage(1);
            }, [searchQuery, selectedTag, selectedGenre]);

            const getPageNumbers = () => {
                const pages = [];
                const maxVisible = 10;
                let start = Math.max(1, currentPage - Math.floor(maxVisible / 2));
                let end = Math.min(totalPages, start + maxVisible - 1);
                
                if (end - start < maxVisible - 1) {
                    start = Math.max(1, end - maxVisible + 1);
                }
                
                for (let i = start; i <= end; i++) {
                    pages.push(i);
                }
                return pages;
            };

            const stats = {
                totalGames: games.length,
                totalDownloads: downloadHistory.length,
                totalFavorites: favorites.length,
                averageRating: Object.values(ratings).length > 0 
                    ? (Object.values(ratings).reduce((a, b) => a + b, 0) / Object.values(ratings).length).toFixed(1)
                    : 0,
                topGenres: allGenres.slice(0, 5),
                recentDownloads: downloadHistory.slice(0, 10)
            };

            if (loading || initialLoading) {
                return (
                    <div className={`flex items-center justify-center h-screen ${darkMode ? 'bg-gray-900' : 'bg-white'}`}>
                        <div className="text-center max-w-md">
                            <div className="mb-6">
                                <Loader />
                            </div>
                            <h2 className={`${darkMode ? 'text-white' : 'text-gray-900'} text-2xl font-bold mb-4`}>{t('loadingStore')}</h2>
                            <p className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} text-lg mb-6`}>{loadingMessage}</p>

                            {/* Progress Bar */}
                            <div className={`w-full ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-full h-4 mb-2 overflow-hidden`}>
                                <div
                                    className="bg-blue-600 h-full transition-all duration-300 rounded-full flex items-center justify-end pr-2"
                                    style={{ width: `${loadingProgress}%` }}
                                >
                                    {loadingProgress > 10 && (
                                        <span className="text-white text-xs font-bold">{loadingProgress}%</span>
                                    )}
                                </div>
                            </div>
                            <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'} text-sm`}>
                                {t('loadingMessage')}
                            </p>
                        </div>
                    </div>
                );
            }

            // Get proper image path for dev and production
            const getImagePath = (filename) => {
                // In Electron app, images are in the same directory as index.html
                // In dev mode (browser), they're relative
                return filename;
            };

            // Get wallpaper based on current theme
            const getWallpaperImage = () => {
                if (darkMode) {
                    return getImagePath('online fix store wallpaper.png');
                } else {
                    return getImagePath('wallpaper online fix store blanc.png');
                }
            };

            return (
                <div className={`flex min-h-screen ${darkMode ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}`} style={showWallpaper ? {
                    backgroundImage: `url("${getWallpaperImage()}")`,
                    backgroundSize: 'cover',
                    backgroundPosition: 'center',
                    backgroundAttachment: 'fixed'
                } : {}}>
                    {leftSidebarOpen && (
                        <div className={`w-64 ${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-gray-50 border-gray-200'} border-r fixed h-full overflow-y-auto`}>
                            <div className="p-6">
                                <div className="flex items-center justify-between mb-8">
                                    <img src={getImagePath('logo online fix store.png')} alt="Online Fix Store" className="h-36 object-contain" />
                                    <button onClick={() => setLeftSidebarOpen(false)} className={`${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} p-2 rounded transition`}>
                                        <ChevronLeft />
                                    </button>
                                </div>
                                

                                {/* Update Notifications */}
                                {notifications.length > 0 && (
                                    <div className="mb-4 space-y-2">
                                        {notifications.map(notif => (
                                            <div
                                                key={notif.id}
                                                style={{
                                                    backgroundColor: notif.type === 'update' ? 'var(--accent-secondary)' : notif.type === 'success' ? '#10b981' : 'var(--accent-primary)'
                                                }}
                                                className="p-3 rounded-lg text-white text-sm flex items-center gap-2 animate-slideIn"
                                            >
                                                <Bell />
                                                <span className="flex-1">{notif.message}</span>
                                                <button
                                                    onClick={() => dismissNotification(notif.id)}
                                                    className="hover:opacity-70 transition"
                                                >
                                                    <X />
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                )}
                                
                                <nav className="space-y-2">
                                    <button onClick={() => setCurrentView('home')} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${currentView === 'home' ? 'bg-blue-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <Home /> {t('home')}
                                    </button>

                                    {/* FIX #2: Clear filters when clicking Store */}
                                    <button onClick={() => { setCurrentView('store'); setSelectedGame(null); setSelectedTag(null); setSelectedGenre(null); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${currentView === 'store' && !selectedTag && !selectedGenre ? 'bg-blue-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <Store /> {t('store')}
                                    </button>

                                    <button onClick={() => { setCurrentView('bypasses'); setSelectedGame(null); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${currentView === 'bypasses' ? 'bg-purple-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                        </svg>
                                        {t('gameBypasses')}
                                    </button>

                                    <button onClick={() => { setCurrentView('store'); setSelectedGame(null); setSelectedTag('FAVORITES_FILTER'); setSelectedGenre(null); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${selectedTag === 'FAVORITES_FILTER' ? 'bg-pink-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <Heart filled={true} /> {t('favorites')} ({favorites.length})
                                    </button>

                                    <button onClick={() => { setCurrentView('store'); setSelectedGame(null); setSelectedTag('DOWNLOADED_FILTER'); setSelectedGenre(null); }} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${selectedTag === 'DOWNLOADED_FILTER' ? 'bg-green-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <History /> {t('downloads')} ({downloadHistory.length})
                                    </button>

                                    <button onClick={() => setShowStats(true)} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <BarChart /> {t('statistics')}
                                    </button>

                                    <button onClick={() => setCurrentView('settings')} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${currentView === 'settings' ? 'bg-blue-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <Settings /> {t('settings')}
                                    </button>

                                    <button onClick={() => setCurrentView('contact')} className={`w-full flex items-center gap-3 px-4 py-3 rounded transition ${currentView === 'contact' ? 'bg-blue-600 text-white' : darkMode ? 'text-gray-300 hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-200'}`}>
                                        <Mail /> {t('contact')}
                                    </button>
                                </nav>

                                <div className={`mt-8 p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg text-xs`}>
                                    <p className="font-semibold mb-2">{t('keyboardShortcuts')}</p>
                                    <p>‚Üê ‚Üí {t('navigatePages')}</p>
                                    <p>Esc {t('backClose')}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    {!leftSidebarOpen && (
                        <button onClick={() => setLeftSidebarOpen(true)} className={`fixed top-6 left-2 z-50 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} p-1.5 rounded transition`} style={{ width: '32px', height: '32px' }}>
                            <ChevronRight />
                        </button>
                    )}

                    <div className={`flex-1 transition-all duration-300 ${leftSidebarOpen ? 'ml-64' : 'ml-0'}`}>
                        {currentView === 'home' && (
                            <div className="p-8 max-w-4xl mx-auto">
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-gray-50'} rounded-lg p-8 shadow-xl`}>
                                    <div className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} leading-relaxed markdown-content`}>
                                        {homeContent.split('\n').map((line, idx) => {
                                            // H1 headers (# )
                                            if (line.startsWith('# ')) {
                                                return <h1 key={idx} className="text-4xl font-bold mb-6 mt-8 first:mt-0">{line.substring(2)}</h1>;
                                            }
                                            // H2 headers (## )
                                            if (line.startsWith('## ')) {
                                                return <h2 key={idx} className="text-3xl font-bold mb-4 mt-6">{line.substring(3)}</h2>;
                                            }
                                            // H3 headers (### )
                                            if (line.startsWith('### ')) {
                                                return <h3 key={idx} className="text-2xl font-bold mb-3 mt-5">{line.substring(4)}</h3>;
                                            }
                                            // Unordered list items (- )
                                            if (line.startsWith('- ')) {
                                                const content = line.substring(2);
                                                // Parse bold text (**text**)
                                                const parts = content.split(/(\*\*.*?\*\*)/g);
                                                return (
                                                    <li key={idx} className="ml-6 mb-2 list-disc">
                                                        {parts.map((part, i) => {
                                                            if (part.startsWith('**') && part.endsWith('**')) {
                                                                return <strong key={i}>{part.slice(2, -2)}</strong>;
                                                            }
                                                            return part;
                                                        })}
                                                    </li>
                                                );
                                            }
                                            // Horizontal rule (---)
                                            if (line.trim() === '---') {
                                                return <hr key={idx} className="my-6 border-gray-600" />;
                                            }
                                            // Empty lines
                                            if (line.trim() === '') {
                                                return <div key={idx} className="h-4"></div>;
                                            }
                                            // Regular paragraphs with inline formatting
                                            const parts = line.split(/(\*\*.*?\*\*|\[.*?\]\(.*?\))/g);
                                            return (
                                                <p key={idx} className="mb-3">
                                                    {parts.map((part, i) => {
                                                        // Bold text (**text**)
                                                        if (part.startsWith('**') && part.endsWith('**')) {
                                                            return <strong key={i}>{part.slice(2, -2)}</strong>;
                                                        }
                                                        // Links [text](url)
                                                        const linkMatch = part.match(/\[(.*?)\]\((.*?)\)/);
                                                        if (linkMatch) {
                                                            return (
                                                                <a
                                                                    key={i}
                                                                    href={linkMatch[2]}
                                                                    onClick={(e) => {
                                                                        e.preventDefault();
                                                                        window.electronAPI.openExternal(linkMatch[2]);
                                                                    }}
                                                                    className="text-blue-400 hover:text-blue-300 underline cursor-pointer"
                                                                >
                                                                    {linkMatch[1]}
                                                                </a>
                                                            );
                                                        }
                                                        return part;
                                                    })}
                                                </p>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentView === 'settings' && (
                            <div className="p-8 max-w-4xl mx-auto">
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-gray-50'} rounded-lg p-8 shadow-xl`}>
                                    <h2 className="text-4xl font-bold mb-6">‚öôÔ∏è {t('settings')}</h2>

                                    <div className="space-y-6">
                                        {/* Themes Section */}
                                        <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                            <h3 className="text-2xl font-semibold mb-4 flex items-center gap-2">
                                                <Palette />
                                                {t('theme')}
                                            </h3>
                                            <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                                                {Object.entries(themes).map(([key, theme]) => (
                                                    <button
                                                        key={key}
                                                        onClick={() => setCurrentTheme(key)}
                                                        style={{
                                                            backgroundColor: currentTheme === key ? 'var(--accent-primary)' : 'var(--bg-tertiary)',
                                                            color: 'var(--text-primary)'
                                                        }}
                                                        className="flex flex-col items-center gap-2 p-4 rounded-lg transition hover:opacity-80 border-2"
                                                    >
                                                        <span className="text-3xl">{theme.icon}</span>
                                                        <span className="text-sm font-semibold">{theme.name}</span>
                                                        {currentTheme === key && <span className="text-xs">‚úì {t('activeTheme')}</span>}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>

                                        {/* Background Wallpaper Toggle */}
                                        <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                            <h3 className="text-2xl font-semibold mb-4">üñºÔ∏è {t('backgroundWallpaper')}</h3>
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <span className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} block`}>
                                                        {t('showWallpaper')}
                                                    </span>
                                                    <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                        {t('autoSwitchesTheme')}
                                                    </span>
                                                </div>
                                                <button
                                                    onClick={() => setShowWallpaper(!showWallpaper)}
                                                    className={`relative inline-flex h-8 w-16 items-center rounded-full transition ${
                                                        showWallpaper ? 'bg-blue-600' : 'bg-gray-400'
                                                    }`}
                                                >
                                                    <span
                                                        className={`inline-block h-6 w-6 transform rounded-full bg-white transition ${
                                                            showWallpaper ? 'translate-x-9' : 'translate-x-1'
                                                        }`}
                                                    />
                                                </button>
                                            </div>
                                        </div>

                                        {/* Background Music Toggle */}
                                        <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                            <h3 className="text-2xl font-semibold mb-4">üéµ {t('backgroundMusic')}</h3>
                                            <div className="flex items-center justify-between">
                                                <div>
                                                    <span className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} block`}>
                                                        {t('playBackgroundMusic')}
                                                    </span>
                                                    <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                        {t('startsAfterLoading')}
                                                    </span>
                                                </div>
                                                <button
                                                    onClick={() => setBackgroundMusicEnabled(!backgroundMusicEnabled)}
                                                    className={`relative inline-flex h-8 w-16 items-center rounded-full transition ${
                                                        backgroundMusicEnabled ? 'bg-blue-600' : 'bg-gray-400'
                                                    }`}
                                                >
                                                    <span
                                                        className={`inline-block h-6 w-6 transform rounded-full bg-white transition ${
                                                            backgroundMusicEnabled ? 'translate-x-9' : 'translate-x-1'
                                                        }`}
                                                    />
                                                </button>
                                            </div>
                                            {backgroundMusicEnabled && !loading && (
                                                <div className="mt-3 flex items-center gap-2 text-sm text-green-600">
                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                                    </svg>
                                                    Music is playing
                                                </div>
                                            )}
                                        </div>

                                        {/* Language Selection */}
                                        <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                            <h3 className="text-2xl font-semibold mb-4">üåê Language</h3>
                                            <div className="grid grid-cols-2 gap-3">
                                                <button
                                                    onClick={() => setLanguage('en')}
                                                    className={`p-4 rounded-lg font-semibold transition ${
                                                        language === 'en'
                                                            ? 'bg-blue-600 text-white'
                                                            : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                    }`}
                                                >
                                                    üá∫üá∏ English
                                                </button>
                                                <button
                                                    onClick={() => setLanguage('fr')}
                                                    className={`p-4 rounded-lg font-semibold transition ${
                                                        language === 'fr'
                                                            ? 'bg-blue-600 text-white'
                                                            : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                    }`}
                                                >
                                                    üá´üá∑ Fran√ßais
                                                </button>
                                                <button
                                                    onClick={() => setLanguage('es')}
                                                    className={`p-4 rounded-lg font-semibold transition ${
                                                        language === 'es'
                                                            ? 'bg-blue-600 text-white'
                                                            : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                    }`}
                                                >
                                                    üá™üá∏ Espa√±ol
                                                </button>
                                                <button
                                                    onClick={() => setLanguage('zh')}
                                                    className={`p-4 rounded-lg font-semibold transition ${
                                                        language === 'zh'
                                                            ? 'bg-blue-600 text-white'
                                                            : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                    }`}
                                                >
                                                    üá®üá≥ ‰∏≠Êñá
                                                </button>
                                            </div>
                                        </div>

                                        {/* Window Mode Selection (Electron only) */}
                                        {window.electronAPI && (
                                            <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                                <h3 className="text-2xl font-semibold mb-4">üñ•Ô∏è {t('windowMode')}</h3>
                                                <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                                                    <button
                                                        onClick={() => setWindowMode('window')}
                                                        className={`p-4 rounded-lg font-semibold transition ${
                                                            windowMode === 'window'
                                                                ? 'bg-blue-600 text-white'
                                                                : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                        }`}
                                                    >
                                                        <div className="text-2xl mb-2">ü™ü</div>
                                                        {t('windowed')}
                                                    </button>
                                                    <button
                                                        onClick={() => setWindowMode('fullscreen')}
                                                        className={`p-4 rounded-lg font-semibold transition ${
                                                            windowMode === 'fullscreen'
                                                                ? 'bg-blue-600 text-white'
                                                                : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                        }`}
                                                    >
                                                        <div className="text-2xl mb-2">‚õ∂</div>
                                                        {t('fullscreen')}
                                                    </button>
                                                    <button
                                                        onClick={() => setWindowMode('borderless')}
                                                        className={`p-4 rounded-lg font-semibold transition ${
                                                            windowMode === 'borderless'
                                                                ? 'bg-blue-600 text-white'
                                                                : darkMode ? 'bg-gray-600 hover:bg-gray-500' : 'bg-gray-300 hover:bg-gray-400'
                                                        }`}
                                                    >
                                                        <div className="text-2xl mb-2">‚ñ≠</div>
                                                        {t('borderless')}
                                                    </button>
                                                </div>
                                                <div className="mt-4 flex items-center justify-between">
                                                    <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                                                        Having issues? Try restarting the app
                                                    </p>
                                                    {window.electronAPI && window.electronAPI.restartApp && (
                                                        <button
                                                            onClick={() => window.electronAPI.restartApp()}
                                                            className="px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-semibold transition flex items-center gap-2"
                                                        >
                                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                                <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                                                            </svg>
                                                            Restart App
                                                        </button>
                                                    )}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentView === 'contact' && (
                            <div className="p-8 max-w-4xl mx-auto">
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-gray-50'} rounded-lg p-8 shadow-xl`}>
                                    <h2 className="text-4xl font-bold mb-6">{t('contactUs')}</h2>
                                    <div className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} leading-relaxed space-y-4`}>
                                        <p>{t('getInTouch')}</p>
                                        <div className="space-y-4">
                                            <div className={`flex items-start gap-3 p-3 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded`}>
                                                <Mail />
                                                <div>
                                                    <p className={`font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>{t('email')}</p>
                                                    <a href="mailto:fixitf759@gmail.com" className="text-blue-400 hover:text-blue-300 break-all">fixitf759@gmail.com</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentView === 'store' && !selectedGame && (
                            <div className="flex">
                                <div className="flex-1 p-6">
                                    <div className="mb-6">
                                        {/* Advanced Search Toggle Button - Centered */}
                                        <div className="flex justify-center mb-4">
                                            <button 
                                                onClick={() => setShowAdvancedSearch(!showAdvancedSearch)}
                                                className={`px-6 py-3 rounded-lg transition font-semibold flex items-center gap-2 ${
                                                    showAdvancedSearch 
                                                        ? 'bg-blue-600 hover:bg-blue-700 text-white' 
                                                        : darkMode 
                                                            ? 'bg-gray-700 hover:bg-gray-600 text-white' 
                                                            : 'bg-purple-200 hover:bg-purple-300 text-gray-900'
                                                }`}
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <line x1="4" y1="21" x2="4" y2="14"></line>
                                                    <line x1="4" y1="10" x2="4" y2="3"></line>
                                                    <line x1="12" y1="21" x2="12" y2="12"></line>
                                                    <line x1="12" y1="8" x2="12" y2="3"></line>
                                                    <line x1="20" y1="21" x2="20" y2="16"></line>
                                                    <line x1="20" y1="12" x2="20" y2="3"></line>
                                                    <line x1="1" y1="14" x2="7" y2="14"></line>
                                                    <line x1="9" y1="8" x2="15" y2="8"></line>
                                                    <line x1="17" y1="16" x2="23" y2="16"></line>
                                                </svg>
                                                {showAdvancedSearch ? t('hideFilters') : t('advancedFilters')}
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div className="mb-6">
                                        <input type="text" placeholder={t('search')} value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} className={`w-full px-4 py-3 ${darkMode ? 'bg-gray-800 text-white border-gray-700' : 'bg-white text-gray-900 border-gray-300'} rounded-lg border focus:border-blue-500 focus:outline-none`} />
                                    </div>

                                    {/* View Mode Toggle */}
                                    <div className="mb-6 flex items-center justify-between">
                                        <span className="font-semibold">{t('viewMode')}</span>
                                        <div className="flex gap-2">
                                            <button
                                                onClick={() => setViewMode('grid')}
                                                className={`px-4 py-2 rounded-lg transition flex items-center gap-2 ${viewMode === 'grid' ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'}`}
                                                title={t('gridView')}
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <rect x="3" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="3" width="7" height="7"></rect>
                                                    <rect x="14" y="14" width="7" height="7"></rect>
                                                    <rect x="3" y="14" width="7" height="7"></rect>
                                                </svg>
                                                {t('gridView')}
                                            </button>
                                            <button
                                                onClick={() => setViewMode('list')}
                                                className={`px-4 py-2 rounded-lg transition flex items-center gap-2 ${viewMode === 'list' ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'}`}
                                                title={t('listView')}
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <line x1="8" y1="6" x2="21" y2="6"></line>
                                                    <line x1="8" y1="12" x2="21" y2="12"></line>
                                                    <line x1="8" y1="18" x2="21" y2="18"></line>
                                                    <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                                    <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                                    <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                                </svg>
                                                {t('listView')}
                                            </button>
                                            <button 
                                                onClick={() => setViewMode('card')}
                                                className={`px-4 py-2 rounded-lg transition flex items-center gap-2 ${viewMode === 'card' ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'}`}
                                                title="Card View"
                                            >
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <rect x="2" y="3" width="20" height="18" rx="2"></rect>
                                                    <line x1="2" y1="9" x2="22" y2="9"></line>
                                                </svg>
                                                Card
                                            </button>
                                        </div>
                                    </div>

                                    {/* Advanced Search Panel */}
                                    {showAdvancedSearch && (
                                        <div className={`mb-6 p-6 rounded-lg ${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-purple-50 border-purple-200'} border-2`}>
                                            <h3 className="font-bold text-xl mb-4 flex items-center gap-2">
                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                                </svg>
                                                {t('advancedFilters')}
                                            </h3>
                                            
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                {/* Rating Filter */}
                                                <div>
                                                    <label className="block text-sm font-semibold mb-2">‚≠ê My Rating Range</label>
                                                    <div className="flex gap-2 items-center">
                                                        <input 
                                                            type="number" 
                                                            min="0" 
                                                            max="5" 
                                                            value={advancedFilters.minRating}
                                                            onChange={(e) => setAdvancedFilters({...advancedFilters, minRating: parseInt(e.target.value) || 0})}
                                                            className={`w-20 px-3 py-2 rounded border ${darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'}`}
                                                        />
                                                        <span className="font-semibold">to</span>
                                                        <input 
                                                            type="number" 
                                                            min="0" 
                                                            max="5" 
                                                            value={advancedFilters.maxRating}
                                                            onChange={(e) => setAdvancedFilters({...advancedFilters, maxRating: parseInt(e.target.value) || 5})}
                                                            className={`w-20 px-3 py-2 rounded border ${darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'}`}
                                                        />
                                                        <span className="text-sm">stars</span>
                                                    </div>
                                                </div>

                                                {/* Player Count Filter */}
                                                <div>
                                                    <label className="block text-sm font-semibold mb-2">üéÆ {t('playerCount')}</label>
                                                    <select
                                                        value={advancedFilters.playerCount}
                                                        onChange={(e) => setAdvancedFilters({...advancedFilters, playerCount: e.target.value})}
                                                        className={`w-full px-3 py-2 rounded border ${darkMode ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300'}`}
                                                    >
                                                        <option value="">{t('anyPlayerCount')}</option>
                                                        <option value="2">{t('twoPlayers')}</option>
                                                        <option value="4">{t('fourPlayers')}</option>
                                                        <option value="6">{t('sixPlusPlayers')}</option>
                                                    </select>
                                                </div>
                                            </div>

                                            <div className="mt-6 flex flex-wrap gap-4">
                                                <label className={`flex items-center gap-2 cursor-pointer px-4 py-2 rounded-lg transition ${advancedFilters.hasCoopCampaign ? 'bg-green-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-white hover:bg-gray-100'}`}>
                                                    <input 
                                                        type="checkbox"
                                                        checked={advancedFilters.hasCoopCampaign}
                                                        onChange={(e) => setAdvancedFilters({...advancedFilters, hasCoopCampaign: e.target.checked})}
                                                        className="w-4 h-4"
                                                    />
                                                    <span className="text-sm font-semibold">üìñ {t('hasCoopCampaign')}</span>
                                                </label>

                                                <label className={`flex items-center gap-2 cursor-pointer px-4 py-2 rounded-lg transition ${advancedFilters.onlineOnly ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-white hover:bg-gray-100'}`}>
                                                    <input
                                                        type="checkbox"
                                                        checked={advancedFilters.onlineOnly}
                                                        onChange={(e) => setAdvancedFilters({...advancedFilters, onlineOnly: e.target.checked})}
                                                        className="w-4 h-4"
                                                    />
                                                    <span className="text-sm font-semibold">üåê {t('hasOnlineCoop')}</span>
                                                </label>

                                                <label className={`flex items-center gap-2 cursor-pointer px-4 py-2 rounded-lg transition ${advancedFilters.localOnly ? 'bg-purple-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-white hover:bg-gray-100'}`}>
                                                    <input
                                                        type="checkbox"
                                                        checked={advancedFilters.localOnly}
                                                        onChange={(e) => setAdvancedFilters({...advancedFilters, localOnly: e.target.checked})}
                                                        className="w-4 h-4"
                                                    />
                                                    <span className="text-sm font-semibold">üéÆ {t('hasLocalCoop')}</span>
                                                </label>
                                            </div>

                                            <button 
                                                onClick={() => setAdvancedFilters({minRating: 0, maxRating: 5, playerCount: '', hasCoopCampaign: false, onlineOnly: false, localOnly: false})}
                                                className={`mt-6 px-6 py-2 rounded-lg font-semibold transition ${darkMode ? 'bg-red-600 hover:bg-red-700' : 'bg-red-500 hover:bg-red-600'} text-white`}
                                            >
                                                ‚úï Clear All Filters
                                            </button>
                                        </div>
                                    )}

                                    {filteredGames.length === 0 ? (
                                        <div className="text-center py-12">
                                            <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'} text-lg`}>No games found</p>
                                        </div>
                                    ) : (
                                        <>
                                            {/* Grid View (Default) */}
                                            {viewMode === 'grid' && (
                                                <div className="grid grid-cols-6 gap-3 mb-8" style={{ gridAutoRows: 'auto' }}>
                                                    {currentGames.map(game => (
                                                        <div key={game.id} className={`game-card ${darkMode ? 'bg-gray-800' : ''} rounded-lg overflow-hidden cursor-pointer hover:transform hover:scale-105 transition relative`} style={{ boxShadow: '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)', transition: 'all 0.3s ease' }} onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 15px 40px rgba(139, 92, 246, 0.6), 0 8px 20px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(139, 92, 246, 0.3)'} onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)'}>
                                                            <div onClick={() => handleGameClick(game)} className="aspect-square bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center relative overflow-hidden">
                                                                {game.headerImage ? (
                                                                    <img src={game.headerImage} alt={game.name} loading="lazy" className="absolute inset-0 w-full h-full object-cover" />
                                                                ) : (
                                                                    <span className="text-center font-semibold text-xs leading-tight z-10 p-2 text-white">{game.name}</span>
                                                                )}
                                                                {downloadHistory.some(d => d.appID === game.appID) && (
                                                                    <div className="absolute top-1 right-1 bg-green-600 text-white text-xs px-2 py-1 rounded">‚úì</div>
                                                                )}
                                                                {isGameCached(game.appID) && !downloadHistory.some(d => d.appID === game.appID) && (
                                                                    <div className="absolute top-1 right-1 bg-blue-600 text-white text-xs px-2 py-1 rounded">üíæ</div>
                                                                )}
                                                                {selectedTag === 'DOWNLOADED_FILTER' && (
                                                                    <button 
                                                                        onClick={(e) => { e.stopPropagation(); removeFromDownloads(game.appID); }} 
                                                                        className="absolute top-1 left-1 bg-red-600 hover:bg-red-700 text-white text-xs px-2 py-1 rounded z-10"
                                                                        title="Remove from downloads"
                                                                    >
                                                                        ‚úï
                                                                    </button>
                                                                )}
                                                            </div>
                                                            <div className="p-2">
                                                                <div className="flex items-center justify-between mb-1">
                                                                    <p className={`text-xs ${darkMode ? 'text-white' : 'text-gray-900'} font-semibold truncate flex-1`} title={game.name}>
                                                                        {!game.name.startsWith('Game ') ? game.name : ''}
                                                                    </p>
                                                                    <button onClick={(e) => { e.stopPropagation(); toggleFavorite(game.appID); }} className="text-pink-500 hover:text-pink-600">
                                                                        <Heart filled={favorites.includes(game.appID)} />
                                                                    </button>
                                                                </div>
                                                                <p className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>ID: {game.appID}</p>
                                                                {game.metacritic && game.metacritic.score && (
                                                                    <div className="mt-1 flex items-center gap-1">
                                                                        <span className="text-xs font-bold px-1.5 py-0.5 rounded" style={{backgroundColor: game.metacritic.score >= 75 ? '#66cc33' : game.metacritic.score >= 50 ? '#ffcc33' : '#ff6666', color: 'white'}}>
                                                                            {game.metacritic.score}
                                                                        </span>
                                                                        <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>MC</span>
                                                                    </div>
                                                                )}
                                                                {ratings[game.appID] && (
                                                                    <div className="flex gap-0.5 mt-1">
                                                                        {[1, 2, 3, 4, 5].map(star => (
                                                                            <Star key={star} filled={star <= ratings[game.appID]} />
                                                                        ))}
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}

                                            {/* List View */}
                                            {viewMode === 'list' && (
                                                <div className="space-y-2 mb-8">
                                                    {currentGames.map(game => (
                                                        <div key={game.id} onClick={() => handleGameClick(game)} className={`game-card ${darkMode ? 'bg-gray-800' : ''} rounded-lg overflow-hidden cursor-pointer hover:bg-opacity-80 transition flex items-center p-3 gap-4`} style={{ boxShadow: '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)', transition: 'all 0.3s ease' }} onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 15px 40px rgba(139, 92, 246, 0.6), 0 8px 20px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(139, 92, 246, 0.3)'} onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)'}>
                                                            <div className="w-24 h-24 bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center relative overflow-hidden rounded flex-shrink-0">
                                                                {game.headerImage ? (
                                                                    <img src={game.headerImage} alt={game.name} loading="lazy" className="w-full h-full object-cover" />
                                                                ) : (
                                                                    <span className="text-center font-semibold text-xs text-white p-1">{game.name}</span>
                                                                )}
                                                            </div>
                                                            <div className="flex-1">
                                                                <h3 className={`font-bold text-lg ${darkMode ? 'text-white' : 'text-gray-900'}`}>{!game.name.startsWith('Game ') ? game.name : `Game ${game.appID}`}</h3>
                                                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>App ID: {game.appID}</p>
                                                                <div className="flex items-center gap-3 mt-1">
                                                                    {game.metacritic && game.metacritic.score && (
                                                                        <div className="flex items-center gap-1">
                                                                            <span className="text-sm font-bold px-2 py-1 rounded" style={{backgroundColor: game.metacritic.score >= 75 ? '#66cc33' : game.metacritic.score >= 50 ? '#ffcc33' : '#ff6666', color: 'white'}}>
                                                                                {game.metacritic.score}
                                                                            </span>
                                                                            <span className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Metacritic</span>
                                                                        </div>
                                                                    )}
                                                                    {ratings[game.appID] && (
                                                                        <div className="flex gap-1">
                                                                            {[1, 2, 3, 4, 5].map(star => (
                                                                                <Star key={star} filled={star <= ratings[game.appID]} />
                                                                            ))}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                            <div className="flex items-center gap-2">
                                                                {downloadHistory.some(d => d.appID === game.appID) && (
                                                                    <div className="bg-green-600 text-white text-xs px-3 py-1 rounded">Downloaded</div>
                                                                )}
                                                                {isGameCached(game.appID) && (
                                                                    <div className="bg-blue-600 text-white text-xs px-3 py-1 rounded">üíæ Cached</div>
                                                                )}
                                                                <button onClick={(e) => { e.stopPropagation(); toggleFavorite(game.appID); }} className="text-pink-500 hover:text-pink-600 p-2">
                                                                    <Heart filled={favorites.includes(game.appID)} />
                                                                </button>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}

                                            {/* Card View */}
                                            {viewMode === 'card' && (
                                                <div className="grid grid-cols-3 gap-6 mb-8">
                                                    {currentGames.map(game => (
                                                        <div key={game.id} onClick={() => handleGameClick(game)} className={`game-card ${darkMode ? 'bg-gray-800' : ''} rounded-lg overflow-hidden cursor-pointer hover:transform hover:scale-105 transition`} style={{ boxShadow: '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)', transition: 'all 0.3s ease' }} onMouseEnter={(e) => e.currentTarget.style.boxShadow = '0 15px 40px rgba(139, 92, 246, 0.6), 0 8px 20px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(139, 92, 246, 0.3)'} onMouseLeave={(e) => e.currentTarget.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.8), 0 4px 10px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.1)'}>
                                                            <div className="h-48 bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center relative overflow-hidden">
                                                                {game.headerImage ? (
                                                                    <img src={game.headerImage} alt={game.name} loading="lazy" className="w-full h-full object-cover" />
                                                                ) : (
                                                                    <span className="text-center font-semibold text-sm text-white p-4">{game.name}</span>
                                                                )}
                                                                {downloadHistory.some(d => d.appID === game.appID) && (
                                                                    <div className="absolute top-2 right-2 bg-green-600 text-white text-xs px-3 py-1 rounded">‚úì Downloaded</div>
                                                                )}
                                                                {isGameCached(game.appID) && !downloadHistory.some(d => d.appID === game.appID) && (
                                                                    <div className="absolute top-2 right-2 bg-blue-600 text-white text-xs px-3 py-1 rounded">üíæ Cached</div>
                                                                )}
                                                            </div>
                                                            <div className="p-4">
                                                                <div className="flex items-start justify-between mb-2">
                                                                    <h3 className={`font-bold text-base ${darkMode ? 'text-white' : 'text-gray-900'} flex-1`}>{!game.name.startsWith('Game ') ? game.name : `Game ${game.appID}`}</h3>
                                                                    <button onClick={(e) => { e.stopPropagation(); toggleFavorite(game.appID); }} className="text-pink-500 hover:text-pink-600 ml-2">
                                                                        <Heart filled={favorites.includes(game.appID)} />
                                                                    </button>
                                                                </div>
                                                                <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>App ID: {game.appID}</p>

                                                                {/* Metacritic Score */}
                                                                {game.metacritic && game.metacritic.score && (
                                                                    <div className="mb-2 flex items-center gap-2">
                                                                        <span className="text-sm font-bold px-2 py-1 rounded" style={{backgroundColor: game.metacritic.score >= 75 ? '#66cc33' : game.metacritic.score >= 50 ? '#ffcc33' : '#ff6666', color: 'white'}}>
                                                                            {game.metacritic.score}
                                                                        </span>
                                                                        <span className={`text-sm font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Metacritic Score</span>
                                                                    </div>
                                                                )}

                                                                {/* Co-Op Info */}
                                                                {game.coopData && (
                                                                    <div className="mb-2 flex flex-wrap gap-1">
                                                                        {game.coopData.maxPlayers && (
                                                                            <span className={`text-xs px-2 py-1 rounded ${darkMode ? 'bg-orange-600' : 'bg-orange-500'} text-white font-semibold`}>
                                                                                üéÆ {game.coopData.maxPlayers} Players
                                                                            </span>
                                                                        )}
                                                                        {game.coopData.onlineCoop && (
                                                                            <span className={`text-xs px-2 py-1 rounded ${darkMode ? 'bg-blue-600' : 'bg-blue-500'} text-white`}>
                                                                                üåê Online
                                                                            </span>
                                                                        )}
                                                                        {(game.coopData.localCoop || game.hasSplitScreen) && (
                                                                            <span className={`text-xs px-2 py-1 rounded ${darkMode ? 'bg-purple-600' : 'bg-purple-500'} text-white`}>
                                                                                üéÆ Local
                                                                            </span>
                                                                        )}
                                                                    </div>
                                                                )}

                                                                {ratings[game.appID] && (
                                                                    <div className="flex gap-1">
                                                                        {[1, 2, 3, 4, 5].map(star => (
                                                                            <Star key={star} filled={star <= ratings[game.appID]} />
                                                                        ))}
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}

                                            <div className="flex flex-col items-center gap-4">
                                                <div className="flex items-center gap-2">
                                                    <button onClick={() => setCurrentPage(1)} disabled={currentPage === 1} className={`px-3 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} disabled:opacity-50 rounded transition text-sm`}>{t('first')}</button>
                                                    <button onClick={() => setCurrentPage(p => Math.max(1, p - 1))} disabled={currentPage === 1} className={`flex items-center gap-2 px-4 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} disabled:opacity-50 rounded transition`}><ChevronLeft /> {t('previous')}</button>
                                                    <div className="flex gap-1">
                                                        {getPageNumbers().map(pageNum => (
                                                            <button key={pageNum} onClick={() => setCurrentPage(pageNum)} className={`px-3 py-2 rounded transition ${currentPage === pageNum ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300' : 'bg-gray-200 hover:bg-gray-300 text-gray-700'}`}>{pageNum}</button>
                                                        ))}
                                                    </div>
                                                    <button onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))} disabled={currentPage === totalPages} className={`flex items-center gap-2 px-4 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} disabled:opacity-50 rounded transition`}>{t('next')} <ChevronRight /></button>
                                                    <button onClick={() => setCurrentPage(totalPages)} disabled={currentPage === totalPages} className={`px-3 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} disabled:opacity-50 rounded transition text-sm`}>{t('last')}</button>
                                                </div>
                                                <span className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} text-sm`}>{t('page')} {currentPage} {t('pageOf')} {totalPages} ({filteredGames.length} {t('games')})</span>
                                            </div>
                                        </>
                                    )}
                                </div>

                                <div className="relative">
                                    {rightSidebarOpen && (
                                        <button onClick={() => setRightSidebarOpen(false)} className={`absolute top-4 -left-12 z-50 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} p-2 rounded transition`}><ChevronRight /></button>
                                    )}
                                    
                                    {rightSidebarOpen && (
                                        <div className={`w-72 ${darkMode ? 'bg-gray-800 border-gray-700' : 'bg-gray-50 border-gray-200'} border-l p-6 overflow-y-auto custom-scrollbar rounded-l-3xl`} style={{ maxHeight: '100vh', paddingBottom: '2rem' }}>
                                            
                                            {/* Active Filters Display */}
                                            {(selectedTag || selectedGenre) && (
                                                <div className={`mb-6 p-4 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-purple-100'} border-2 ${darkMode ? 'border-gray-600' : 'border-purple-300'}`}>
                                                    <div className="flex items-center justify-between mb-2">
                                                        <h3 className="font-bold text-sm">{t('activeFilters')}</h3>
                                                        <button
                                                            onClick={() => { setSelectedTag(null); setSelectedGenre(null); }}
                                                            className={`px-3 py-1 rounded text-xs font-semibold ${darkMode ? 'bg-red-600 hover:bg-red-700' : 'bg-red-500 hover:bg-red-600'} text-white transition`}
                                                        >
                                                            {t('clearAll')}
                                                        </button>
                                                    </div>
                                                    {selectedTag && selectedTag !== 'LATEST_GAMES_FILTER' && selectedTag !== 'FAVORITES_FILTER' && selectedTag !== 'DOWNLOADED_FILTER' && selectedTag !== 'NEW_GAMES_FILTER' && (
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <span className="text-xs">Tag:</span>
                                                            <span className="px-2 py-1 bg-cyan-600 text-white rounded text-xs">{selectedTag}</span>
                                                            <button onClick={() => setSelectedTag(null)} className="text-red-500 hover:text-red-600 font-bold">‚úï</button>
                                                        </div>
                                                    )}
                                                    {selectedTag === 'LATEST_GAMES_FILTER' && (
                                                        <div className="flex items-center gap-2 mb-1">
                                                            <span className="px-2 py-1 bg-purple-600 text-white rounded text-xs">Latest 18 Games</span>
                                                            <button onClick={() => setSelectedTag(null)} className="text-red-500 hover:text-red-600 font-bold">‚úï</button>
                                                        </div>
                                                    )}
                                                    {selectedGenre && (
                                                        <div className="flex items-center gap-2">
                                                            <span className="text-xs">Genre:</span>
                                                            <span className="px-2 py-1 bg-blue-600 text-white rounded text-xs">{selectedGenre}</span>
                                                            <button onClick={() => setSelectedGenre(null)} className="text-red-500 hover:text-red-600 font-bold">‚úï</button>
                                                        </div>
                                                    )}
                                                </div>
                                            )}

                                            {/* Player Count Filter - RIGHT SIDEBAR */}
                                            <div className="mb-6">
                                                <label className={`text-xl font-bold mb-4 block`}>üéÆ {t('playerCount')}</label>
                                                <select
                                                    value={advancedFilters.playerCount}
                                                    onChange={(e) => setAdvancedFilters({...advancedFilters, playerCount: e.target.value})}
                                                    className={`w-full px-4 py-2 rounded border ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-white border-gray-300 text-gray-900'}`}
                                                >
                                                    <option value="">{t('anyPlayerCount')}</option>
                                                    <option value="2">{t('twoPlayers')}</option>
                                                    <option value="4">{t('fourPlayers')}</option>
                                                    <option value="6">{t('sixPlusPlayers')}</option>
                                                </select>
                                            </div>

                                            <details className="mb-6">
                                                <summary className={`text-xl font-bold mb-4 cursor-pointer ${darkMode ? 'hover:text-blue-400' : 'hover:text-blue-600'} transition pr-6`}>üè∑Ô∏è Browse by Tags (Multi-select)</summary>
                                                {selectedTags.length > 0 && (
                                                    <div className="mb-2 flex flex-wrap gap-2">
                                                        {selectedTags.map(tag => (
                                                            <span key={tag} style={{backgroundColor: 'var(--accent-primary)'}} className="text-white text-xs px-2 py-1 rounded flex items-center gap-1">
                                                                {tag}
                                                                <button onClick={() => setSelectedTags(prev => prev.filter(t => t !== tag))} className="hover:text-red-300">‚úï</button>
                                                            </span>
                                                        ))}
                                                        <button onClick={() => setSelectedTags([])} className="text-xs text-red-500 hover:text-red-700">Clear All</button>
                                                    </div>
                                                )}
                                                <div className="mt-4 space-y-2" style={{ maxHeight: '400px', overflowY: 'auto', paddingRight: '8px' }}>
                                                    {allTags.length === 0 ? (
                                                        <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'} text-sm`}>Loading tags...</p>
                                                    ) : (
                                                        allTags.map((tag, idx) => (
                                                            <button
                                                                key={idx}
                                                                onClick={() => {
                                                                    setSelectedTag(null);
                                                                    setSelectedTags(prev =>
                                                                        prev.includes(tag.name)
                                                                            ? prev.filter(t => t !== tag.name)
                                                                            : [...prev, tag.name]
                                                                    );
                                                                }}
                                                                className={`w-full text-left px-3 py-2 rounded transition text-sm ${selectedTags.includes(tag.name) ? 'bg-cyan-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300' : 'bg-gray-200 hover:bg-gray-300 text-gray-700'}`}
                                                            >
                                                                {selectedTags.includes(tag.name) && '‚úì '}{tag.name}
                                                            </button>
                                                        ))
                                                    )}
                                                </div>
                                            </details>

                                            <details className="mb-6">
                                                <summary className={`text-xl font-bold mb-4 cursor-pointer ${darkMode ? 'hover:text-blue-400' : 'hover:text-blue-600'} transition pr-6`}>üé≠ Browse by Genres (Multi-select)</summary>
                                                {selectedGenres.length > 0 && (
                                                    <div className="mb-2 flex flex-wrap gap-2">
                                                        {selectedGenres.map(genre => (
                                                            <span key={genre} style={{backgroundColor: 'var(--accent-secondary)'}} className="text-white text-xs px-2 py-1 rounded flex items-center gap-1">
                                                                {genre}
                                                                <button onClick={() => setSelectedGenres(prev => prev.filter(g => g !== genre))} className="hover:text-red-300">‚úï</button>
                                                            </span>
                                                        ))}
                                                        <button onClick={() => setSelectedGenres([])} className="text-xs text-red-500 hover:text-red-700">Clear All</button>
                                                    </div>
                                                )}
                                                <div className="mt-4 space-y-2" style={{ maxHeight: '400px', overflowY: 'auto', paddingRight: '8px' }}>
                                                    {allGenres.length === 0 ? (
                                                        <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'} text-sm`}>Loading genres...</p>
                                                    ) : (
                                                        allGenres.map((genre, idx) => (
                                                            <button
                                                                key={idx}
                                                                onClick={() => {
                                                                    setSelectedGenre(null);
                                                                    setSelectedGenres(prev =>
                                                                        prev.includes(genre.description)
                                                                            ? prev.filter(g => g !== genre.description)
                                                                            : [...prev, genre.description]
                                                                    );
                                                                }}
                                                                className={`w-full text-left px-3 py-2 rounded transition text-sm ${selectedGenres.includes(genre.description) ? 'bg-blue-600 text-white' : darkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300' : 'bg-gray-200 hover:bg-gray-300 text-gray-700'}`}
                                                            >
                                                                {selectedGenres.includes(genre.description) && '‚úì '}{genre.description}
                                                            </button>
                                                        ))
                                                    )}
                                                </div>
                                            </details>

                                            {/* New Games Section */}
                                            {newGamesCount > 0 && (
                                                <div className={`mb-6 p-4 rounded-xl ${darkMode ? 'bg-gradient-to-br from-green-600 to-green-700' : 'bg-gradient-to-br from-green-500 to-green-600'} cursor-pointer hover:opacity-90 transition`}
                                                    onClick={() => {
                                                        setSelectedTag('NEW_GAMES_FILTER');
                                                        setSelectedGenre(null);
                                                        setSelectedTags([]);
                                                        setSelectedGenres([]);
                                                    }}
                                                >
                                                    <div className="flex items-center justify-between mb-2">
                                                        <h3 className="text-xl font-bold text-white flex items-center gap-2">
                                                            ‚ú® New Games
                                                        </h3>
                                                        {selectedTag === 'NEW_GAMES_FILTER' && (
                                                            <span className="text-white text-xs bg-white bg-opacity-20 px-2 py-1 rounded">Active</span>
                                                        )}
                                                    </div>
                                                    <p className="text-white text-sm opacity-90">
                                                        {newGamesCount} new game{newGamesCount > 1 ? 's' : ''} added!
                                                    </p>
                                                    <p className="text-white text-xs opacity-75 mt-1">
                                                        Click to view the latest additions
                                                    </p>
                                                </div>
                                            )}

                                            {/* Sort Options */}
                                            <details className="mb-6">
                                                <summary className={`text-xl font-bold mb-4 cursor-pointer ${darkMode ? 'hover:text-blue-400' : 'hover:text-blue-600'} transition pr-6`}>Sort Options</summary>
                                                <div className="mt-4">
                                                    <label className="block text-sm font-semibold mb-2 flex items-center gap-2">
                                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                                                            <line x1="4" y1="6" x2="16" y2="6"></line>
                                                            <line x1="4" y1="12" x2="13" y2="12"></line>
                                                            <line x1="4" y1="18" x2="10" y2="18"></line>
                                                            <polyline points="18 14 18 20 20 18"></polyline>
                                                            <polyline points="18 14 16 16"></polyline>
                                                        </svg>
                                                        Sort by:
                                                    </label>
                                                    <select 
                                                        value={sortBy}
                                                        onChange={(e) => setSortBy(e.target.value)}
                                                        className={`w-full px-3 py-2 rounded-lg border text-sm font-semibold ${darkMode ? 'bg-gray-700 border-gray-600 hover:bg-gray-600' : 'bg-white border-gray-300 hover:bg-gray-50'} focus:border-blue-500 focus:outline-none cursor-pointer transition`}
                                                    >
                                                        <option value="default">Default</option>
                                                        <option value="name-asc">Name (A ‚Üí Z)</option>
                                                        <option value="name-desc">Name (Z ‚Üí A)</option>
                                                        <option value="rating-high">‚≠ê Rating (High)</option>
                                                        <option value="rating-low">‚≠ê Rating (Low)</option>
                                                        <option value="recent-download">üì• Recent Downloads</option>
                                                        <option value="favorited">‚ù§Ô∏è Favorites First</option>
                                                        <option value="appid-asc">ID (Low ‚Üí High)</option>
                                                        <option value="appid-desc">ID (High ‚Üí Low)</option>
                                                    </select>
                                                </div>
                                            </details>

                                            {/* Useful Apps & Plugins Section */}
                                            <details className="mb-6">
                                                <summary className={`text-xl font-bold mb-4 cursor-pointer ${darkMode ? 'hover:text-purple-400' : 'hover:text-purple-600'} transition pr-6`}>üõ†Ô∏è Useful Apps & Plugins</summary>
                                                <div className="space-y-3">
                                                    {usefulApps.map(app => (
                                                        <div
                                                            key={app.id}
                                                            onClick={() => setSelectedPlugin(app)}
                                                            className={`p-3 rounded-lg cursor-pointer transition ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-white hover:bg-gray-100'} border ${darkMode ? 'border-gray-600' : 'border-gray-300'}`}
                                                        >
                                                            <div className="flex items-center justify-between">
                                                                <div>
                                                                    <div className="font-semibold text-sm">{app.name}</div>
                                                                    <div className="text-xs text-gray-400">{app.type === 'plugin' ? 'üîå Plugin' : 'üíª App'}</div>
                                                                </div>
                                                                <svg className="w-4 h-4 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                                </svg>
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </details>
                                        </div>
                                    )}
                                    
                                    {!rightSidebarOpen && (
                                        <button onClick={() => setRightSidebarOpen(true)} className={`fixed top-4 right-4 z-50 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} p-2 rounded transition`}><ChevronLeft /></button>
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Game Bypasses View */}
                        {currentView === 'bypasses' && !selectedBypassGame && (
                            <div className="p-6">
                                <h1 className="text-4xl font-bold mb-6 flex items-center gap-3">
                                    <svg className="w-10 h-10 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                    </svg>
                                    {t('gameBypasses')}
                                    <span className="text-sm font-normal text-gray-400">
                                        ({bypassGamesLoading ? '...' : bypassGames.length})
                                    </span>
                                </h1>

                                {/* Search Bar */}
                                <div className="mb-6">
                                    <input
                                        type="text"
                                        placeholder={t('search')}
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                        className={`w-full px-4 py-3 rounded-lg ${darkMode ? 'bg-gray-800 text-white' : 'bg-gray-100 text-gray-900'} focus:outline-none focus:ring-2 focus:ring-purple-500`}
                                    />
                                </div>

                                {/* Loading State */}
                                {bypassGamesLoading && (
                                    <div className="flex flex-col items-center justify-center py-12">
                                        <Loader />
                                        <p className="mt-4 text-gray-400">Loading bypasses from GitHub...</p>
                                    </div>
                                )}

                                {/* Bypasses List */}
                                {!bypassGamesLoading && (
                                    <div className="space-y-2">
                                        {bypassGames
                                            .filter(game => game.name.toLowerCase().includes(searchQuery.toLowerCase()))
                                            .map(game => (
                                                <div
                                                    key={game.id}
                                                    onClick={() => setSelectedBypassGame(game)}
                                                    className={`p-4 rounded-lg cursor-pointer transition ${darkMode ? 'bg-gray-800 hover:bg-gray-700' : 'bg-gray-100 hover:bg-gray-200'}`}
                                                    style={{ boxShadow: '0 4px 15px rgba(0, 0, 0, 0.5)' }}
                                                >
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-lg font-semibold">{game.name}</span>
                                                        <svg className="w-5 h-5 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                        </svg>
                                                    </div>
                                                </div>
                                            ))}
                                        {bypassGames.filter(game => game.name.toLowerCase().includes(searchQuery.toLowerCase())).length === 0 && (
                                            <div className="text-center py-12 text-gray-400">
                                                No bypasses found matching "{searchQuery}"
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Bypass Game Detail View */}
                        {currentView === 'bypasses' && selectedBypassGame && (
                            <div className="p-6">
                                <div className={`sticky top-0 ${darkMode ? 'bg-gray-900' : 'bg-white'} z-10 pb-4 mb-4`}>
                                    <button onClick={() => setSelectedBypassGame(null)} className={`px-4 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} rounded transition`}>
                                        ‚Üê Back to Bypasses
                                    </button>
                                </div>

                                <div className="text-center py-12">
                                    <svg className="w-24 h-24 text-purple-500 mx-auto mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                    </svg>
                                    <h1 className="text-5xl font-bold mb-8">{selectedBypassGame.name}</h1>

                                    <button
                                        onClick={() => {
                                            const url = `https://github.com/ShayneVi/Bypasses/releases/download/v1.0/${selectedBypassGame.filename}`;
                                            window.electronAPI.downloadBypass(url, selectedBypassGame.filename);
                                        }}
                                        className="px-8 py-4 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-lg text-xl transition shadow-xl"
                                    >
                                        <svg className="w-6 h-6 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                        Download Bypass
                                    </button>

                                    <p className="mt-6 text-gray-500 text-sm">
                                        The bypass will be downloaded from GitHub releases
                                    </p>
                                </div>
                            </div>
                        )}

                        {/* Plugin/App Detail Modal */}
                        {selectedPlugin && (
                            <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4" onClick={() => setSelectedPlugin(null)}>
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg max-w-2xl w-full p-8 relative`} onClick={(e) => e.stopPropagation()}>
                                    {/* Close Button */}
                                    <button onClick={() => setSelectedPlugin(null)} className={`absolute top-4 right-4 ${darkMode ? 'text-gray-400 hover:text-white' : 'text-gray-600 hover:text-black'} transition`}>
                                        <X />
                                    </button>

                                    {/* Icon */}
                                    <div className="text-center mb-6">
                                        <div className="inline-block p-4 bg-purple-600 rounded-full mb-4">
                                            {selectedPlugin.type === 'plugin' ? (
                                                <svg className="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" />
                                                </svg>
                                            ) : (
                                                <svg className="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                                </svg>
                                            )}
                                        </div>
                                        <h2 className="text-3xl font-bold mb-2">{selectedPlugin.name}</h2>
                                        <div className="text-sm text-gray-400 mb-4">{selectedPlugin.type === 'plugin' ? 'üîå Steam Plugin' : 'üíª Desktop Application'}</div>
                                    </div>

                                    {/* Description */}
                                    <div className={`${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg p-4 mb-6`}>
                                        <p className="text-sm leading-relaxed">{selectedPlugin.description}</p>
                                    </div>

                                    {/* Install Path Info */}
                                    {selectedPlugin.installPath && (
                                        <div className={`${darkMode ? 'bg-gray-700' : 'bg-blue-50'} rounded-lg p-4 mb-6 border ${darkMode ? 'border-gray-600' : 'border-blue-200'}`}>
                                            <div className="flex items-start gap-2">
                                                <svg className="w-5 h-5 text-blue-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                                <div>
                                                    <div className="font-semibold text-sm text-blue-500 mb-1">Auto-Install Location</div>
                                                    <div className="text-xs font-mono">{selectedPlugin.installPath}</div>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* Action Buttons */}
                                    <div className="flex gap-3">
                                        <button
                                            onClick={async () => {
                                                try {
                                                    // Fetch latest release
                                                    const response = await fetch(`https://api.github.com/repos/${selectedPlugin.repo}/releases/latest`);
                                                    const data = await response.json();

                                                    if (data.assets && data.assets.length > 0) {
                                                        const asset = data.assets[0]; // Get first asset (usually the .zip)
                                                        const downloadUrl = asset.browser_download_url;

                                                        if (selectedPlugin.type === 'plugin' && selectedPlugin.installPath) {
                                                            // Auto-extract to Steam plugins folder
                                                            const result = await window.electronAPI.downloadAndExtractFix(
                                                                downloadUrl,
                                                                selectedPlugin.installPath,
                                                                '', // No appID needed
                                                                asset.name
                                                            );

                                                            if (result.success) {
                                                                alert(`‚úÖ ${selectedPlugin.name} installed successfully to ${selectedPlugin.installPath}`);
                                                            } else {
                                                                alert(`‚ùå Installation failed: ${result.error}`);
                                                            }
                                                        } else {
                                                            // Let user choose download location
                                                            const result = await window.electronAPI.downloadBypass(downloadUrl, asset.name);
                                                            if (result.success) {
                                                                alert(`‚úÖ ${selectedPlugin.name} downloaded successfully!`);
                                                            } else {
                                                                alert(`‚ùå Download failed: ${result.error}`);
                                                            }
                                                        }
                                                    }
                                                } catch (error) {
                                                    console.error('Error downloading plugin:', error);
                                                    alert('‚ùå Failed to download. Check console for details.');
                                                }
                                            }}
                                            className="flex-1 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg transition shadow-lg flex items-center justify-center gap-2"
                                        >
                                            <Download />
                                            {selectedPlugin.type === 'plugin' ? 'Install Plugin' : 'Download App'}
                                        </button>

                                        <button
                                            onClick={() => {
                                                window.electronAPI.openExternal(`https://github.com/${selectedPlugin.repo}`);
                                            }}
                                            className={`px-6 py-3 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} font-semibold rounded-lg transition flex items-center gap-2`}
                                        >
                                            <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                                            </svg>
                                            GitHub
                                        </button>

                                        <button
                                            onClick={() => {
                                                window.electronAPI.openExternal(`https://github.com/${selectedPlugin.repo}/releases/latest`);
                                            }}
                                            className={`px-6 py-3 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} font-semibold rounded-lg transition`}
                                        >
                                            Releases
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentView === 'game' && selectedGame && steamData && (
                            <div className="p-6">
                                <div className={`sticky top-0 ${darkMode ? 'bg-gray-900' : 'bg-white'} z-10 pb-4 mb-4`}>
                                    <button onClick={() => { setSelectedGame(null); setCurrentView('store'); }} className={`px-4 py-2 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-200 hover:bg-gray-300'} rounded transition`}>‚Üê {t('backToStore')}</button>
                                </div>

                                <div className="max-w-5xl mx-auto">
                                    <div className={`${darkMode ? 'bg-gray-800' : 'bg-gray-50'} rounded-lg overflow-hidden shadow-xl`}>
                                        {steamData.movies && steamData.movies.length > 0 && !videoPlaying ? (
                                            <div className="relative w-full h-80 bg-black">
                                                <img src={steamData.movies[0].thumbnail} alt="Video thumbnail" loading="lazy" className="w-full h-full object-cover" />
                                                <button onClick={() => setVideoPlaying(true)} className="absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 hover:bg-opacity-60 transition">
                                                    <Play />
                                                </button>
                                            </div>
                                        ) : steamData.movies && steamData.movies.length > 0 && videoPlaying ? (
                                            <div className="relative w-full h-80 bg-black">
                                                <video controls autoPlay className="w-full h-full" src={steamData.movies[0].mp4?.max || steamData.movies[0].webm?.max}>
                                                    Your browser does not support the video tag.
                                                </video>
                                            </div>
                                        ) : (steamData.background || steamData.background_raw || selectedGame.backgroundImage) ? (
                                            <div className="relative w-full h-96 bg-black">
                                                <img src={steamData.background || steamData.background_raw || selectedGame.backgroundImage} alt={steamData.name} loading="lazy" className="w-full h-full object-cover" />
                                                <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
                                            </div>
                                        ) : steamData.header_image ? (
                                            <img src={steamData.header_image} alt={steamData.name} loading="lazy" className="w-full h-80 object-cover" />
                                        ) : null}

                                        <div className="p-8">
                                            <div className="flex items-start justify-between mb-4">
                                                <div className="flex-1">
                                                    <h1 className="text-5xl font-bold mb-2">{steamData.name}</h1>
                                                    <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-2`}>{t('appId')} {selectedGame.appID}</p>

                                                    <div className="flex items-center gap-2 mt-2">
                                                        <span className="text-sm">{t('rateGame')}</span>
                                                        {[1, 2, 3, 4, 5].map(star => (
                                                            <button key={star} onClick={() => setGameRating(selectedGame.appID, star)} className="text-yellow-500 hover:text-yellow-600">
                                                                <Star filled={star <= (ratings[selectedGame.appID] || 0)} />
                                                            </button>
                                                        ))}
                                                        {ratings[selectedGame.appID] && <span className="text-sm ml-2">({ratings[selectedGame.appID]}/5) - {t('clickToRemove')}</span>}
                                                    </div>

                                                    {/* Playing Through Information */}
                                                    {onlineFixData && onlineFixData.playingThrough && (
                                                        <div className="flex items-center gap-2 mt-4">
                                                            <span className={`text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>{t('playingThrough')}</span>
                                                            <span className="px-3 py-1 rounded bg-purple-600 text-white font-bold">
                                                                {translateRussianText(onlineFixData.playingThrough, language)}
                                                            </span>
                                                        </div>
                                                    )}

                                                    {/* Files for the game Section */}
                                                    {onlineFixData && onlineFixData.filesForGame && onlineFixData.filesForGame.length > 0 && (
                                                        <div className="mt-4 p-4 bg-gray-700 rounded-lg">
                                                            <h4 className="text-base font-bold text-orange-400 mb-3">{t('filesForGame')}</h4>
                                                            <ol className="list-decimal list-inside space-y-2">
                                                                {onlineFixData.filesForGame.map((item, index) => (
                                                                    <li key={index} className="text-sm text-gray-300 leading-relaxed">
                                                                        {translateRussianText(item, language)}
                                                                    </li>
                                                                ))}
                                                            </ol>
                                                        </div>
                                                    )}
                                                </div>
                                                <button onClick={() => toggleFavorite(selectedGame.appID)} className="text-pink-500 hover:text-pink-600 ml-4">
                                                    <Heart filled={favorites.includes(selectedGame.appID)} />
                                                </button>
                                            </div>

                                            {steamData.short_description && (
                                                <div className={`mb-6 p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                                    <p className={`${darkMode ? 'text-gray-200' : 'text-gray-800'} text-lg leading-relaxed`}>{steamData.short_description}</p>
                                                </div>
                                            )}

                                            {steamData.screenshots && steamData.screenshots.length > 0 && (
                                                <div className="mb-8">
                                                    <h2 className="text-2xl font-semibold mb-4">{t('screenshots')}</h2>
                                                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                                                        {steamData.screenshots.slice(0, 6).map((ss, idx) => (
                                                            <img key={idx} src={ss.path_thumbnail} alt={`Screenshot ${idx + 1}`} loading="lazy" className="rounded hover:opacity-80 transition cursor-pointer" onClick={() => setLightboxImage(ss.path_full)} />
                                                        ))}
                                                    </div>
                                                </div>
                                            )}

                                            {(steamData.about_the_game || steamData.detailed_description) && (
                                                <div className="mb-8">
                                                    <h2 className={`text-3xl font-bold mb-4 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>{t('aboutGame')}</h2>
                                                    <div className={`${darkMode ? 'text-gray-300' : 'text-gray-700'} leading-relaxed space-y-4`}>
                                                        {stripHtml(steamData.about_the_game || steamData.detailed_description).split('\n\n').map((paragraph, idx) => (
                                                            paragraph.trim() && <p key={idx}>{paragraph}</p>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}

                                            {/* Co-Op Information Section */}
                                            {coopLoading && (
                                                <div className={`mb-8 p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                                    <h2 className="text-2xl font-semibold mb-4 flex items-center gap-2">
                                                        <span>{t('coopFeatures')}</span>
                                                        <div className="animate-spin w-5 h-5"><Loader /></div>
                                                    </h2>
                                                    <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>{t('loadingCoop')}</p>
                                                </div>
                                            )}

                                            {!coopLoading && coopData && (
                                                <div className={`mb-8 p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg`}>
                                                    <h2 className="text-2xl font-semibold mb-4">{t('coopFeatures')}</h2>

                                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        <div>
                                                            <h3 className={`text-lg font-semibold mb-3 ${darkMode ? 'text-green-400' : 'text-green-600'}`}>Core Features</h3>

                                                            <div className="space-y-3">
                                                                <div>
                                                                    <p className="font-semibold mb-1">Local Co-Op</p>
                                                                    <div className="flex items-center gap-2">
                                                                        {coopData.localCoop ? (
                                                                            <>
                                                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" className="text-green-500">
                                                                                    <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                                                                                    <path d="M7 12h10M7 6h10M7 18h10" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                                                                                </svg>
                                                                                <span className="italic">{coopData.localCoopPlayers || 'Supported'}</span>
                                                                            </>
                                                                        ) : (
                                                                            <>
                                                                                <span className="text-red-500">‚úó</span>
                                                                                <span className="italic">Not Supported</span>
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                </div>

                                                                <div>
                                                                    <p className="font-semibold mb-1">Online Co-Op</p>
                                                                    <div className="flex items-center gap-2">
                                                                        {coopData.onlineCoop ? (
                                                                            <>
                                                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" className="text-green-500">
                                                                                    <circle cx="12" cy="12" r="3" stroke="currentColor" strokeWidth="2"/>
                                                                                    <path d="M12 3v2M12 19v2M21 12h-2M5 12H3M18.36 18.36l-1.42-1.42M7.05 7.05L5.64 5.64M18.36 5.64l-1.42 1.42M7.05 16.95l-1.41 1.41" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                                                                                </svg>
                                                                                <span className="italic">{coopData.onlineCoopPlayers || 'Supported'}</span>
                                                                            </>
                                                                        ) : (
                                                                            <>
                                                                                <span className="text-red-500">‚úó</span>
                                                                                <span className="italic">Not Supported</span>
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                </div>

                                                                <div>
                                                                    <p className="font-semibold mb-1">Combo Co-Op (Local + Online)</p>
                                                                    <div className="flex items-center gap-2">
                                                                        {coopData.comboCoop ? (
                                                                            <>
                                                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" className="text-green-500">
                                                                                    <circle cx="9" cy="12" r="2" stroke="currentColor" strokeWidth="2"/>
                                                                                    <circle cx="15" cy="12" r="2" stroke="currentColor" strokeWidth="2"/>
                                                                                </svg>
                                                                                <span className="italic">Supported</span>
                                                                            </>
                                                                        ) : (
                                                                            <>
                                                                                <span className="text-red-500">‚úó</span>
                                                                                <span className="italic">Not Supported</span>
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                </div>

                                                                <div>
                                                                    <p className="font-semibold mb-1">LAN Play or System Link</p>
                                                                    <div className="flex items-center gap-2">
                                                                        {coopData.lanPlay ? (
                                                                            <>
                                                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" className="text-green-500">
                                                                                    <rect x="2" y="3" width="20" height="14" rx="2" stroke="currentColor" strokeWidth="2"/>
                                                                                    <path d="M8 21h8M12 17v4" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                                                                                </svg>
                                                                                <span className="italic">Supported</span>
                                                                            </>
                                                                        ) : (
                                                                            <>
                                                                                <span className="text-red-500">‚úó</span>
                                                                                <span className="italic">Not Supported</span>
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div>
                                                            <h3 className={`text-lg font-semibold mb-3 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>Co-Op Extras</h3>

                                                            <div className="space-y-3">
                                                                <div>
                                                                    <p className="font-semibold mb-1">Co-Op Campaign</p>
                                                                    <div className="flex items-center gap-2">
                                                                        {coopData.coopCampaign ? (
                                                                            <>
                                                                                <span className="text-green-500">‚úì</span>
                                                                                <span className="italic">Available</span>
                                                                            </>
                                                                        ) : (
                                                                            <>
                                                                                <span className="text-red-500">‚úó</span>
                                                                                <span className="italic">Not Available</span>
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                </div>

                                                                {coopData.popularity && (
                                                                    <div>
                                                                        <p className="font-semibold mb-1">Popularity</p>
                                                                        <span className={`px-3 py-1 ${darkMode ? 'bg-purple-600' : 'bg-purple-500'} rounded text-white`}>
                                                                            #{coopData.popularity}
                                                                        </span>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    </div>

                                                    {coopData.source && (
                                                        <div className="mt-4 pt-4 border-t border-gray-600">
                                                            <a href={coopData.source} target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:text-blue-300 text-sm">
                                                                View full details on Co-Optimus ‚Üí
                                                            </a>
                                                        </div>
                                                    )}
                                                </div>
                                            )}

                                            {!coopLoading && !coopData && (
                                                <div className={`mb-8 p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-200'} rounded-lg border-l-4 border-yellow-500`}>
                                                    <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                                        ‚ÑπÔ∏è {t('coopNotAvailable')}
                                                    </p>
                                                </div>
                                            )}

                                            {/* FIX #1: Display user_tags on game details page */}
                                            {steamData.user_tags && steamData.user_tags.length > 0 && (
                                                <div className="mb-6">
                                                    <h2 className="text-xl font-semibold mb-3">Tags</h2>
                                                    <div className="flex flex-wrap gap-2">
                                                        {/* Add player count tag if game has co-op features */}
                                                        {coopData && coopData.maxPlayers && (coopData.localCoop || coopData.onlineCoop) && (
                                                            <span className="px-3 py-1 bg-green-600 rounded-full text-sm text-white font-semibold">
                                                                üéÆ {coopData.maxPlayers} Players
                                                            </span>
                                                        )}
                                                        {steamData.user_tags.slice(0, 15).map((tag, idx) => (
                                                            <span key={idx} className="px-3 py-1 bg-cyan-600 rounded-full text-sm text-white">{tag.name}</span>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}

                                            {steamData.genres && steamData.genres.length > 0 && (
                                                <div className="mb-6">
                                                    <h2 className="text-xl font-semibold mb-3">Genres</h2>
                                                    <div className="flex flex-wrap gap-2">
                                                        {steamData.genres.map((genre, idx) => (
                                                            <span key={idx} className="px-3 py-1 bg-blue-600 rounded-full text-sm text-white">{genre.description}</span>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}

                                            {steamData.developers && steamData.developers.length > 0 && (
                                                <div className="mb-4">
                                                    <h2 className={`text-lg font-semibold mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>Developer</h2>
                                                    <p className={darkMode ? 'text-gray-200' : 'text-gray-800'}>{steamData.developers.join(', ')}</p>
                                                </div>
                                            )}

                                            <div className="mb-6 grid grid-cols-2 gap-4">
                                                <a href={`steam://store/${selectedGame.appID}`} className={`w-full ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-300 hover:bg-gray-400'} text-white font-semibold py-3 px-6 rounded-lg flex items-center justify-center gap-2 transition`}>
                                                    {t('openSteam')}
                                                </a>
                                                <button
                                                    onClick={() => setShowHowToRunModal(true)}
                                                    style={{backgroundColor: 'var(--accent-secondary)'}}
                                                    className="w-full hover:opacity-80 text-white font-semibold py-3 px-6 rounded-lg flex items-center justify-center gap-2 transition"
                                                >
                                                    üìñ {t('howToRun')}
                                                </button>
                                            </div>

                                            <button onClick={() => handleDownload(selectedGame)} className="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg flex items-center justify-center gap-2 transition text-lg">
                                                <Download /> {t('downloadFix')}
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {lightboxImage && (
                            <div className="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4" onClick={() => setLightboxImage(null)}>
                                <button className="absolute top-4 right-4 text-white hover:text-gray-300 transition" onClick={() => setLightboxImage(null)}>
                                    <X />
                                </button>
                                <img src={lightboxImage} alt="Full size screenshot" className="max-w-full max-h-full object-contain rounded-lg shadow-2xl" onClick={(e) => e.stopPropagation()} />
                            </div>
                        )}

                        {/* How to Run Modal */}
                        {showHowToRunModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4" onClick={() => setShowHowToRunModal(false)}>
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-2xl max-w-3xl w-full max-h-[80vh] overflow-y-auto`} onClick={(e) => e.stopPropagation()}>
                                    <div className={`sticky top-0 ${darkMode ? 'bg-gray-800' : 'bg-white'} z-10 p-6 border-b ${darkMode ? 'border-gray-700' : 'border-gray-200'} flex items-center justify-between`}>
                                        <h2 className="text-3xl font-bold">{t('howToRunInstructions')}</h2>
                                        <button onClick={() => setShowHowToRunModal(false)} className="text-gray-500 hover:text-gray-700 transition">
                                            <X />
                                        </button>
                                    </div>
                                    <div className="p-6">
                                        {onlineFixData && onlineFixData.instructions && onlineFixData.instructions.length > 0 ? (
                                            <ol className="space-y-4">
                                                {onlineFixData.instructions.map((instruction, idx) => {
                                                    // Check if this is a section header (–í –∏–≥—Ä–µ:, –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:, –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞:)
                                                    const isSectionHeader = /^(–í –∏–≥—Ä–µ|–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ|–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞|In-game|Connection|Creating server)[:]/i.test(instruction);

                                                    return (
                                                        <li key={idx} className={`flex gap-3 ${darkMode ? 'text-gray-200' : 'text-gray-800'} ${isSectionHeader ? 'mt-4' : ''}`}>
                                                            {!isSectionHeader && (
                                                                <span className="flex-shrink-0 w-8 h-8 rounded-full bg-purple-600 text-white font-bold flex items-center justify-center">
                                                                    {idx + 1}
                                                                </span>
                                                            )}
                                                            <div className={`flex-1 pt-1 ${isSectionHeader ? 'w-full' : ''}`}>
                                                                <p className={`leading-relaxed ${isSectionHeader ? 'font-bold text-orange-400 text-lg' : ''}`}>
                                                                    {translateRussianText(instruction, language)}
                                                                </p>
                                                            </div>
                                                        </li>
                                                    );
                                                })}
                                            </ol>
                                        ) : (
                                            <div className={`p-6 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg text-center`}>
                                                <p className={darkMode ? 'text-gray-300' : 'text-gray-600'}>
                                                    {t('instructionsNotAvailable')}
                                                </p>
                                                {onlineFixData && onlineFixData.gamePageUrl && (
                                                    <button
                                                        onClick={() => {
                                                            if (window.electronAPI) {
                                                                window.electronAPI.openExternal(onlineFixData.gamePageUrl);
                                                            } else {
                                                                window.open(onlineFixData.gamePageUrl, '_blank');
                                                            }
                                                        }}
                                                        className="mt-4 px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition"
                                                    >
                                                        üîó {t('searchOnline')}
                                                    </button>
                                                )}
                                            </div>
                                        )}
                                    </div>
                                    <div className={`sticky bottom-0 ${darkMode ? 'bg-gray-800' : 'bg-white'} p-6 border-t ${darkMode ? 'border-gray-700' : 'border-gray-200'} flex justify-end`}>
                                        <button
                                            onClick={() => setShowHowToRunModal(false)}
                                            className={`px-6 py-3 ${darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-300 hover:bg-gray-400'} rounded-lg transition font-semibold`}
                                        >
                                            {t('close')}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {showStats && (
                            <div className="fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4" onClick={() => setShowStats(false)}>
                                <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto`} onClick={(e) => e.stopPropagation()}>
                                    <div className="flex justify-between items-center mb-6">
                                        <h2 className="text-3xl font-bold">{t('statisticsDashboard')}</h2>
                                        <button onClick={() => setShowStats(false)}><X /></button>
                                    </div>

                                    <div className="grid grid-cols-2 gap-4">
                                        <div className={`p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg`}>
                                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`}>{t('totalGames')}</p>
                                            <p className="text-3xl font-bold text-blue-500">{stats.totalGames}</p>
                                        </div>
                                        <div className={`p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg`}>
                                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`}>{t('totalDownloads')}</p>
                                            <p className="text-3xl font-bold text-green-500">{stats.totalDownloads}</p>
                                        </div>
                                        <div className={`p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg`}>
                                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`}>{t('totalFavorites')}</p>
                                            <p className="text-3xl font-bold text-pink-500">{stats.totalFavorites}</p>
                                        </div>
                                        <div className={`p-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'} rounded-lg`}>
                                            <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`}>{t('averageRating')}</p>
                                            <p className="text-3xl font-bold text-yellow-500">{stats.averageRating || 'N/A'}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                    </div>
                </div>
            );
        };

        ReactDOM.render(<GameFixStore />, document.getElementById('root'));
    </script>
</body>
</html>